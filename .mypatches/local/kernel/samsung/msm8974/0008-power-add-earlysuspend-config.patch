From 4de929997af7c357b1cc29b96bb49f32f47623dc Mon Sep 17 00:00:00 2001
From: nx111 <gd.zhangdz@gmail.com>
Date: Sat, 14 Apr 2018 21:59:28 +0800
Subject: [PATCH 08/12] power: add earlysuspend config.

Change-Id: Ia4b48158bdd999d8a489955e4921a0dc90a4bd02
---
 kernel/power/Kconfig        | 5 +++++
 kernel/power/Makefile       | 1 +
 kernel/power/earlysuspend.c | 4 ++++
 3 files changed, 10 insertions(+)

diff --git a/kernel/power/Kconfig b/kernel/power/Kconfig
index 1051a06c12f..6153986d8b6 100644
--- a/kernel/power/Kconfig
+++ b/kernel/power/Kconfig
@@ -18,6 +18,11 @@ config SUSPEND_FREEZER
 
 	  Turning OFF this setting is NOT recommended! If in doubt, say Y.
 
+config HAS_EARLYSUSPEND
+        bool "Suport early suspend"
+        depends on SUSPEND
+        default n
+
 config CPU_FREQ_LIMIT_USERSPACE
 	bool "User space cpufreq limit interface"
 	depends on CPU_FREQ_LIMIT
diff --git a/kernel/power/Makefile b/kernel/power/Makefile
index 74c713ba61b..4745739123c 100644
--- a/kernel/power/Makefile
+++ b/kernel/power/Makefile
@@ -16,3 +16,4 @@ obj-$(CONFIG_SUSPEND_TIME)	+= suspend_time.o
 obj-$(CONFIG_MAGIC_SYSRQ)	+= poweroff.o
 
 obj-$(CONFIG_SUSPEND)	+= wakeup_reason.o
+obj-$(CONFIG_HAS_EARLYSUSPEND)	+= earlysuspend.o
diff --git a/kernel/power/earlysuspend.c b/kernel/power/earlysuspend.c
index b15f02eba45..6188366a8b7 100644
--- a/kernel/power/earlysuspend.c
+++ b/kernel/power/earlysuspend.c
@@ -23,6 +23,10 @@
 
 #include "power.h"
 
+struct wake_lock main_wake_lock;
+struct workqueue_struct *suspend_work_queue;
+suspend_state_t requested_suspend_state = PM_SUSPEND_MEM;
+
 enum {
 	DEBUG_USER_STATE = 1U << 0,
 	DEBUG_SUSPEND = 1U << 2,
-- 
2.17.0

