From 1b0d4bba9cd07ccd3ae6c70b2d8caa219ea78c6d Mon Sep 17 00:00:00 2001
From: nx111 <gd.zhangdz@gmail.com>
Date: Sat, 23 Jun 2018 09:38:16 +0800
Subject: [PATCH 19/21] email: hard-code SyncSize.

Change-Id: I0f051c60218a91910fa9ae12a57bcb4250ac785a
---
 provider_src/com/android/email/provider/DBHelper.java     | 8 ++++++++
 .../email/activity/setup/AccountSetupOptionsFragment.java | 2 +-
 2 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/provider_src/com/android/email/provider/DBHelper.java b/provider_src/com/android/email/provider/DBHelper.java
index 78b713e72..dca05acb2 100644
--- a/provider_src/com/android/email/provider/DBHelper.java
+++ b/provider_src/com/android/email/provider/DBHelper.java
@@ -1562,12 +1562,20 @@ public final class DBHelper {
 
             if (oldVersion <= 131) {
                 try {
+/* From old email app. We don't have SyncSize so hard-code the defaults
                     db.execSQL("alter table " + Account.TABLE_NAME
                             + " add column " + AccountColumns.SET_SYNC_SIZE_ENABLED + " integer"
                             + " default " + SyncSize.ENABLED_DEFAULT_VALUE + ";");
                     db.execSQL("alter table " + Account.TABLE_NAME
                             + " add column " + AccountColumns.SYNC_SIZE + " integer"
                             + " default " + SyncSize.SYNC_SIZE_DEFAULT_VALUE + ";");
+*/
+                    db.execSQL("alter table " + Account.TABLE_NAME
+                            + " add column " + AccountColumns.SET_SYNC_SIZE_ENABLED + " integer"
+                            + " default " + 1 + ";");
+                    db.execSQL("alter table " + Account.TABLE_NAME
+                            + " add column " + AccountColumns.SYNC_SIZE + " integer"
+                            + " default " + 204800 + ";");
                 } catch (SQLException e) {
                     // Shouldn't be needed unless we're debugging and interrupt the process
                     LogUtils.w(TAG, "Exception upgrading EmailProvider.db from 130 to 131", e);
diff --git a/src/com/android/email/activity/setup/AccountSetupOptionsFragment.java b/src/com/android/email/activity/setup/AccountSetupOptionsFragment.java
index e8466dacf..63007d4a2 100644
--- a/src/com/android/email/activity/setup/AccountSetupOptionsFragment.java
+++ b/src/com/android/email/activity/setup/AccountSetupOptionsFragment.java
@@ -30,7 +30,7 @@ import com.android.email.service.EmailServiceUtils;
 import com.android.emailcommon.provider.Account;
 import com.android.emailcommon.provider.Policy;
 import com.android.emailcommon.service.EmailServiceProxy;
-import com.android.emailcommon.service.SyncSize;
+/*import com.android.emailcommon.service.SyncSize;*/
 import com.android.emailcommon.service.SyncWindow;
 
 import java.util.ArrayList;
-- 
2.17.1

