From 678c536eaa85404325b1c9bc686ae64d04f64a61 Mon Sep 17 00:00:00 2001
From: nx111 <gd.zhangdz@gmail.com>
Date: Thu, 12 Jul 2018 22:53:05 +0800
Subject: [PATCH 22/22] unifiedemail: allow mark contents seen when cursor
 update.

Change-Id: I3713a943b00f174d6c7fbb724f29ec6b576c4872
---
 src/com/android/mail/ui/ConversationListFragment.java | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/com/android/mail/ui/ConversationListFragment.java b/src/com/android/mail/ui/ConversationListFragment.java
index 439f6b597..7ef8eedde 100644
--- a/src/com/android/mail/ui/ConversationListFragment.java
+++ b/src/com/android/mail/ui/ConversationListFragment.java
@@ -28,6 +28,7 @@ import android.net.Uri;
 import android.os.Bundle;
 import android.os.Handler;
 import android.os.Parcelable;
+import android.os.StrictMode;
 import android.support.annotation.IdRes;
 import android.support.v4.widget.SwipeRefreshLayout.OnRefreshListener;
 import android.view.KeyEvent;
@@ -1142,7 +1143,12 @@ public final class ConversationListFragment extends Fragment implements
             final int newCursorCount = newCursor.getCount();
             updateSearchResultHeader(newCursorCount);
             if (newCursorCount > 0) {
+                StrictMode.ThreadPolicy old = StrictMode.getThreadPolicy();
+                StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder(old)
+                            .permitDiskWrites()
+                            .build());
                 newCursor.markContentsSeen();
+                StrictMode.setThreadPolicy(old);
                 restoreLastScrolledPosition();
             }
         }
-- 
2.17.1

