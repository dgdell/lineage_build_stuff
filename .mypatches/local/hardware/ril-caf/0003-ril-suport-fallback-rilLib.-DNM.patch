From 8c0560c77d32df78ef81473b7169268b26b91705 Mon Sep 17 00:00:00 2001
From: nx111 <gd.zhangdz@gmail.com>
Date: Thu, 20 Sep 2018 22:51:00 +0800
Subject: [PATCH 3/3] ril: suport fallback rilLib.[DNM]

Change-Id: Ibac7dda1ba3d9bd08d8499de232f965fd7effcf4
---
 rild/rild.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/rild/rild.c b/rild/rild.c
index 041413d..332ba8c 100644
--- a/rild/rild.c
+++ b/rild/rild.c
@@ -122,6 +122,7 @@ int main(int argc, char **argv) {
     int i;
     // ril/socket id received as -c parameter, otherwise set to 0
     const char *clientId = NULL;
+    const char LibPath_Fallback[] = "/vendor/lib/libreference-ril.so";
 
     RLOGD("**RIL Daemon Started**");
     RLOGD("**RILd param count=%d**", argc);
@@ -165,6 +166,10 @@ int main(int argc, char **argv) {
         }
     }
 
+    if(access(rilLibPath, F_OK) != 0){
+         rilLibPath = LibPath_Fallback;
+    }
+
     dlHandle = dlopen(rilLibPath, RTLD_NOW);
 
     if (dlHandle == NULL) {
-- 
2.17.1

