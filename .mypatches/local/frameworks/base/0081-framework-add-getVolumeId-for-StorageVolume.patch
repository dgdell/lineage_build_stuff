From b576a6ab3cb89813e1b14597b74cd4baa10147f5 Mon Sep 17 00:00:00 2001
From: nx111 <gd.zhangdz@gmail.com>
Date: Sun, 26 Aug 2018 22:21:15 +0800
Subject: [PATCH 81/81] framework: add getVolumeId for StorageVolume.

Change-Id: I2483b6e03dbd9bf380a716982bd11af4e823e6b0
---
 .../android/os/storage/StorageVolume.java     | 23 ++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)

diff --git a/core/java/android/os/storage/StorageVolume.java b/core/java/android/os/storage/StorageVolume.java
index fd5a22a9c55..e03294cf8af 100644
--- a/core/java/android/os/storage/StorageVolume.java
+++ b/core/java/android/os/storage/StorageVolume.java
@@ -248,7 +248,28 @@ public final class StorageVolume implements Parcelable {
         return mFsUuid;
     }
 
-    /**
+     /**
+     * Parse and return volume UUID as volume ID, or return -1 if unable to
+     * parse or UUID is unknown.
+     * @hide
+     */
+    public int getVolumeId() {
+        String id = mFsUuid;
+        if (id == null) {
+            return -1;
+        }
+        id = id.replace("-", "");
+        if (id.length() > 8) {
+            id = id.substring(0, 8);
+        }
+        try {
+            return (int) Long.parseLong(id, 16);
+        } catch (NumberFormatException e) {
+            return -1;
+        }
+    }
+
+   /**
      * Parse and return volume UUID as FAT volume ID, or return -1 if unable to
      * parse or UUID is unknown.
      * @hide
-- 
2.17.1

