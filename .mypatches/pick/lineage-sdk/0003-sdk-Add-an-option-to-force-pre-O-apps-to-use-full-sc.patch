From 5a1796e59656d85d1c7b578acba744b52efa7759 Mon Sep 17 00:00:00 2001
From: Jesse Chan <jc@lineageos.org>
Date: Mon, 30 Apr 2018 23:06:42 -0700
Subject: [PATCH 3/9] sdk: Add an option to force pre-O apps to use full screen
 aspect ratio

When an app target pre-O releases, the default max aspect ratio
is 1.86:1 which leads to ugly black areas on devices that have
screens with higher aspect ratio (for example Galaxy S8/S9).

This change adds an option to allow users to change default
aspect ratio for pre-O apps to 2.1 which would fit recent devices.

Change-Id: I4c243ef06655cf9acc23530e7307c4b0b68b0621
---
 lineage/res/res/values/config.xml                     |  6 ++++++
 lineage/res/res/values/symbols.xml                    |  4 ++++
 sdk/src/java/lineageos/providers/LineageSettings.java | 10 ++++++++++
 3 files changed, 20 insertions(+)

diff --git a/lineage/res/res/values/config.xml b/lineage/res/res/values/config.xml
index 1faefa9..9e961f5 100644
--- a/lineage/res/res/values/config.xml
+++ b/lineage/res/res/values/config.xml
@@ -240,4 +240,10 @@
       <!-- Indicate whether encryption causes significant performances loss.
            This MUST NOT be set to true on devices produced in 2016 or later -->
       <bool name="config_trustLegacyEncryption">false</bool>
+
+    <!-- Whether device has screen with higher aspect ratio -->
+    <bool name="config_haveHigherAspectRatioScreen">false</bool>
+
+    <!-- Aspect ratio of screen -->
+    <item name="config_screenAspectRatio" format="float" type="dimen">2.1</item>
 </resources>
diff --git a/lineage/res/res/values/symbols.xml b/lineage/res/res/values/symbols.xml
index 0e8f624..97cda48 100644
--- a/lineage/res/res/values/symbols.xml
+++ b/lineage/res/res/values/symbols.xml
@@ -179,4 +179,8 @@
     <java-symbol type="string" name="trust_notification_title_onboarding" />
     <java-symbol type="string" name="trust_notification_content_onboarding" />
     <java-symbol type="string" name="trust_notification_action_later" />
+
+    <!-- Full screen aspect ratio -->
+    <java-symbol type="bool" name="config_haveHigherAspectRatioScreen" />
+    <java-symbol type="dimen" name="config_screenAspectRatio" />
 </resources>
diff --git a/sdk/src/java/lineageos/providers/LineageSettings.java b/sdk/src/java/lineageos/providers/LineageSettings.java
index 81dbb73..671c43d 100644
--- a/sdk/src/java/lineageos/providers/LineageSettings.java
+++ b/sdk/src/java/lineageos/providers/LineageSettings.java
@@ -842,6 +842,15 @@ public final class LineageSettings {
         public static final Validator HIGH_TOUCH_SENSITIVITY_ENABLE_VALIDATOR =
                 sBooleanValidator;
 
+        /**
+         * Whether or not to force full screen aspect ratio
+         * 0 = off, 1 = on
+         */
+        public static final String FULL_SCREEN_ASPECT_RATIO = "full_screen_aspect_ratio";
+
+        /** @hide */
+        public static final Validator FULL_SCREEN_ASPECT_RATIO_VALIDATOR = sBooleanValidator;
+
         /**
          * Whether to enable system profiles feature
          * 0 = off, 1 = on
@@ -2175,6 +2184,7 @@ public final class LineageSettings {
             VALIDATORS.put(NOTIFICATION_PLAY_QUEUE, NOTIFICATION_PLAY_QUEUE_VALIDATOR);
             VALIDATORS.put(HIGH_TOUCH_SENSITIVITY_ENABLE,
                     HIGH_TOUCH_SENSITIVITY_ENABLE_VALIDATOR);
+            VALIDATORS.put(FULL_SCREEN_ASPECT_RATIO, FULL_SCREEN_ASPECT_RATIO_VALIDATOR);
             VALIDATORS.put(SYSTEM_PROFILES_ENABLED, SYSTEM_PROFILES_ENABLED_VALIDATOR);
             VALIDATORS.put(STATUS_BAR_CLOCK, STATUS_BAR_CLOCK_VALIDATOR);
             VALIDATORS.put(STATUS_BAR_AM_PM, STATUS_BAR_AM_PM_VALIDATOR);
-- 
2.17.1

