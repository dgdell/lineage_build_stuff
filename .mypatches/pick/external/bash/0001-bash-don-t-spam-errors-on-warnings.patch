From 36110fbf0c500b5c8e7109554d253acfa7dcd8e7 Mon Sep 17 00:00:00 2001
From: Rashed Abdel-Tawab <rashed@linux.com>
Date: Sun, 12 Aug 2018 19:00:16 -0700
Subject: [PATCH] bash: don't spam errors on warnings

Change-Id: I33fcaa34a03edc1cb12e7283238a709cd838dcd3
---
 Android.mk              | 2 ++
 builtins/Android.mk     | 1 +
 lib/glob/Android.mk     | 2 ++
 lib/readline/Android.mk | 4 ++++
 lib/sh/Android.mk       | 2 ++
 lib/tilde/tilde.c       | 2 +-
 6 files changed, 12 insertions(+), 1 deletion(-)

diff --git a/Android.mk b/Android.mk
index 87a1b7a..cda7f49 100644
--- a/Android.mk
+++ b/Android.mk
@@ -36,6 +36,8 @@ LOCAL_STATIC_LIBRARIES += \
 	libtilde \
 	libhistory \
 	libreadline
+LOCAL_CFLAGS += \
+	-Wno-error
 
 LOCAL_MODULE := bash
 LOCAL_MODULE_PATH := $(TARGET_OUT_OPTIONAL_EXECUTABLES)
diff --git a/builtins/Android.mk b/builtins/Android.mk
index b13e9f5..31932c9 100644
--- a/builtins/Android.mk
+++ b/builtins/Android.mk
@@ -65,6 +65,7 @@ LOCAL_CFLAGS += \
 	-DCONF_OSTYPE=\"android-eabi\" \
 	-DCONF_MACHTYPE=\"arm-android-eabi\" \
 	-DCONF_VENDOR=\"unknown\"
+LOCAL_CFLAGS += -Wno-error
 LOCAL_MODULE_TAGS := eng
 LOCAL_MODULE := libbuiltins
 include $(BUILD_STATIC_LIBRARY)
diff --git a/lib/glob/Android.mk b/lib/glob/Android.mk
index b22b8b5..a7e6ba0 100644
--- a/lib/glob/Android.mk
+++ b/lib/glob/Android.mk
@@ -20,6 +20,8 @@ LOCAL_C_INCLUDES += \
 LOCAL_CFLAGS += \
 	-DHAVE_CONFIG_H
 
+LOCAL_CFLAGS += -Wno-error
+
 LOCAL_MODULE_TAGS := eng
 
 LOCAL_MODULE := libglob
diff --git a/lib/readline/Android.mk b/lib/readline/Android.mk
index 0509f98..05bef25 100644
--- a/lib/readline/Android.mk
+++ b/lib/readline/Android.mk
@@ -23,6 +23,8 @@ LOCAL_C_INCLUDES += \
 LOCAL_CFLAGS += \
 	-DHAVE_CONFIG_H
 
+LOCAL_CFLAGS += -Wno-error
+
 LOCAL_MODULE := libhistory
 
 LOCAL_MODULE_TAGS := eng
@@ -78,6 +80,8 @@ LOCAL_C_INCLUDES += \
 LOCAL_CFLAGS += \
 	-DHAVE_CONFIG_H
 
+LOCAL_CFLAGS += -Wno-error -Wno-unused-parameter
+
 LOCAL_MODULE := libreadline
 
 LOCAL_MODULE_TAGS := eng
diff --git a/lib/sh/Android.mk b/lib/sh/Android.mk
index 3e5bedd..9d34fac 100644
--- a/lib/sh/Android.mk
+++ b/lib/sh/Android.mk
@@ -26,6 +26,8 @@ LOCAL_C_INCLUDES += \
 LOCAL_CFLAGS += \
 	-DHAVE_CONFIG_H
 
+LOCAL_CFLAGS += -Wno-error
+
 LOCAL_MODULE := libsh
 
 LOCAL_MODULE_TAGS := eng
diff --git a/lib/tilde/tilde.c b/lib/tilde/tilde.c
index 1c53a45..a93c2b7 100644
--- a/lib/tilde/tilde.c
+++ b/lib/tilde/tilde.c
@@ -196,7 +196,7 @@ tilde_expand (string)
   int result_size, result_index;
 
   result_index = result_size = 0;
-  if (result = strchr (string, '~'))
+  if ((result = strchr (string, '~')))
     result = (char *)xmalloc (result_size = (strlen (string) + 16));
   else
     result = (char *)xmalloc (result_size = (strlen (string) + 1));
-- 
2.17.1

