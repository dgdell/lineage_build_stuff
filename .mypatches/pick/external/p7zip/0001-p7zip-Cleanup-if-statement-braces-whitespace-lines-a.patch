From 93edf23f3b3421efd0693da6633f4b27fc0c163f Mon Sep 17 00:00:00 2001
From: Rashed Abdel-Tawab <rashed@linux.com>
Date: Sun, 12 Aug 2018 19:06:12 -0700
Subject: [PATCH 1/2] p7zip: Cleanup if statement braces, whitespace lines, and
 ifs without paranthesis)

Change-Id: I7edff09a0ef5bd262187f707fa47a97da4d5a33e
---
 CPP/7zip/Archive/7z/7zIn.cpp        |  4 ++--
 CPP/7zip/Archive/ArHandler.cpp      |  6 ++----
 CPP/7zip/Archive/Chm/ChmHandler.cpp | 22 ++++++++++++----------
 CPP/7zip/Archive/ComHandler.cpp     |  4 ++--
 4 files changed, 18 insertions(+), 18 deletions(-)

diff --git a/CPP/7zip/Archive/7z/7zIn.cpp b/CPP/7zip/Archive/7z/7zIn.cpp
index fc527be..eb93a25 100644
--- a/CPP/7zip/Archive/7z/7zIn.cpp
+++ b/CPP/7zip/Archive/7z/7zIn.cpp
@@ -1501,8 +1501,8 @@ HRESULT CInArchive::ReadDatabase2(
     unsigned i;
     for (i = checkSize - 2;; i--)
     {
-      if (buf[i] == NID::kEncodedHeader && buf[i + 1] == NID::kPackInfo ||
-          buf[i] == NID::kHeader && buf[i + 1] == NID::kMainStreamsInfo)
+      if ((buf[i] == NID::kEncodedHeader && buf[i + 1] == NID::kPackInfo) ||
+          (buf[i] == NID::kHeader && buf[i + 1] == NID::kMainStreamsInfo))
         break;
       if (i == 0)
         return S_FALSE;
diff --git a/CPP/7zip/Archive/ArHandler.cpp b/CPP/7zip/Archive/ArHandler.cpp
index 1eec728..bc651cb 100644
--- a/CPP/7zip/Archive/ArHandler.cpp
+++ b/CPP/7zip/Archive/ArHandler.cpp
@@ -616,11 +616,9 @@ STDMETHODIMP CHandler::Open(IInStream *stream,
       _items.DeleteFrontal(1);
       for (unsigned i = 0; i < _items.Size(); i++)
         if (_items[i].Name.IsPrefixedBy("data.tar."))
-          if (_mainSubfile < 0)
+          if (_mainSubfile < 0) {
             _mainSubfile = i;
-          else
-          {
-            _mainSubfile = -1;
+          } else {
             break;
           }
     }
diff --git a/CPP/7zip/Archive/Chm/ChmHandler.cpp b/CPP/7zip/Archive/Chm/ChmHandler.cpp
index 2a72e8e..f4be3aa 100644
--- a/CPP/7zip/Archive/Chm/ChmHandler.cpp
+++ b/CPP/7zip/Archive/Chm/ChmHandler.cpp
@@ -23,6 +23,7 @@
 
 using namespace NWindows;
 using namespace NTime;
+using namespace NArchive::NChm;
 
 namespace NArchive {
 namespace NChm {
@@ -143,29 +144,30 @@ STDMETHODIMP CHandler::GetProperty(UInt32 index, PROPID propID, PROPVARIANT *val
     case kpidIsDir:  prop = item.IsDir(); break;
     case kpidSize:  prop = item.Size; break;
     case kpidMethod:
-    {
-      if (!item.IsDir())
-        if (item.Section == 0)
+      if (!item.IsDir()) {
+        if (item.Section == 0) {
           prop = "Copy";
-        else if (item.Section < m_Database.Sections.Size())
+        } else if (item.Section < m_Database.Sections.Size()) {
           prop = m_Database.Sections[(unsigned)item.Section].GetMethodName();
+        }
+      }
       break;
-    }
     case kpidBlock:
-      if (m_Database.LowLevel)
+      if (m_Database.LowLevel) {
         prop = item.Section;
-      else if (item.Section != 0)
+      } else if (item.Section != 0) {
         prop = m_Database.GetFolder(index);
+      }
       break;
-    
+
     #ifdef _CHM_DETAILS
-    
+
     case kpidSection:  prop = (UInt32)item.Section; break;
     case kpidOffset:  prop = (UInt32)item.Offset; break;
 
     #endif
   }
-  
+
   prop.Detach(value);
   return S_OK;
   COM_TRY_END
diff --git a/CPP/7zip/Archive/ComHandler.cpp b/CPP/7zip/Archive/ComHandler.cpp
index 3a4834c..ad4d54c 100644
--- a/CPP/7zip/Archive/ComHandler.cpp
+++ b/CPP/7zip/Archive/ComHandler.cpp
@@ -580,8 +580,8 @@ HRESULT CDatabase::Open(IInStream *inStream)
     UString msiName = ConvertName(item.Name, isMsiName);
     if (isMsiName)
     {
-      if (msiName.Len() >= 4 && StringsAreEqualNoCase_Ascii(msiName.RightPtr(4), ".cab")
-          || msiName.Len() >= 3 && msiName[0] != k_Msi_SpecChar && StringsAreEqualNoCase_Ascii(msiName.RightPtr(3), "exe"))
+      if ((msiName.Len() >= 4 && StringsAreEqualNoCase_Ascii(msiName.RightPtr(4), ".cab"))
+          || (msiName.Len() >= 3 && msiName[0] != k_Msi_SpecChar && StringsAreEqualNoCase_Ascii(msiName.RightPtr(3), "exe")))
       {
         numCabs++;
         MainSubfile = i;
-- 
2.17.1

