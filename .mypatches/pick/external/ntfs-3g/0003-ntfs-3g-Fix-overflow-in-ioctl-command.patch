From 66525aa29cde734f31c5f548dff33ddf3af59d36 Mon Sep 17 00:00:00 2001
From: Steve Kondik <steve@cyngn.com>
Date: Sun, 28 Aug 2016 01:00:02 -0700
Subject: [PATCH 3/4] ntfs-3g: Fix overflow in ioctl command

Change-Id: I39ac849ff150bd24932123145e9e14389cb664d9
---
 include/ntfs-3g/ioctl.h | 2 +-
 libntfs-3g/ioctl.c      | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/include/ntfs-3g/ioctl.h b/include/ntfs-3g/ioctl.h
index 4ed6c010..3a578a5e 100644
--- a/include/ntfs-3g/ioctl.h
+++ b/include/ntfs-3g/ioctl.h
@@ -24,7 +24,7 @@
 #ifndef IOCTL_H
 #define IOCTL_H
 
-int ntfs_ioctl(ntfs_inode *ni, int cmd, void *arg,
+int ntfs_ioctl(ntfs_inode *ni, unsigned int cmd, void *arg,
                         unsigned int flags, void *data);
 
 #endif /* IOCTL_H */
diff --git a/libntfs-3g/ioctl.c b/libntfs-3g/ioctl.c
index 2eef5a51..c42d1f8b 100644
--- a/libntfs-3g/ioctl.c
+++ b/libntfs-3g/ioctl.c
@@ -359,7 +359,7 @@ free_out:
 
 #endif /* FITRIM && BLKDISCARD */
 
-int ntfs_ioctl(ntfs_inode *ni, int cmd, void *arg __attribute__((unused)),
+int ntfs_ioctl(ntfs_inode *ni, unsigned int cmd, void *arg __attribute__((unused)),
 			unsigned int flags __attribute__((unused)), void *data)
 {
 	int ret = 0;
-- 
2.17.1

