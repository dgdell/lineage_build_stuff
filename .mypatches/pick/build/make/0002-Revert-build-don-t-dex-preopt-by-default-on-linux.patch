From 4d558d674930f5575cf084e3985acbf403370b87 Mon Sep 17 00:00:00 2001
From: Ethan Chen <intervigil@gmail.com>
Date: Sat, 20 Jan 2018 11:25:08 -0800
Subject: [PATCH 2/2] Revert "build: don't dex preopt by default on linux"

This reverts commit b06ae9e02bcbd248ffc75f19501c18fe4ed5baa0.

Change-Id: I4279ab30c15a7f5689dfc7df374642d82028668e
---
 core/dex_preopt.mk | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

diff --git a/core/dex_preopt.mk b/core/dex_preopt.mk
index 692fb08..8e496a7 100644
--- a/core/dex_preopt.mk
+++ b/core/dex_preopt.mk
@@ -28,18 +28,18 @@ install-on-system-other = $(filter-out $(PRODUCT_DEXPREOPT_SPEED_APPS) $(PRODUCT
 
 # The default values for pre-opting: always preopt PIC.
 # Conditional to building on linux, as dex2oat currently does not work on darwin.
-#ifeq ($(HOST_OS),linux)
-#  WITH_DEXPREOPT ?= true
+ifeq ($(HOST_OS),linux)
+  WITH_DEXPREOPT ?= true
 # For an eng build only pre-opt the boot image and system server. This gives reasonable performance
 # and still allows a simple workflow: building in frameworks/base and syncing.
-#  ifeq (eng,$(TARGET_BUILD_VARIANT))
-#    WITH_DEXPREOPT_BOOT_IMG_AND_SYSTEM_SERVER_ONLY ?= true
-#  endif
+  ifeq (eng,$(TARGET_BUILD_VARIANT))
+    WITH_DEXPREOPT_BOOT_IMG_AND_SYSTEM_SERVER_ONLY ?= true
+  endif
 # Add mini-debug-info to the boot classpath unless explicitly asked not to.
-#  ifneq (false,$(WITH_DEXPREOPT_DEBUG_INFO))
-#    PRODUCT_DEX_PREOPT_BOOT_FLAGS += --generate-mini-debug-info
-#  endif
-#endif
+  ifneq (false,$(WITH_DEXPREOPT_DEBUG_INFO))
+    PRODUCT_DEX_PREOPT_BOOT_FLAGS += --generate-mini-debug-info
+  endif
+endif
 
 GLOBAL_DEXPREOPT_FLAGS :=
 
-- 
2.7.4

