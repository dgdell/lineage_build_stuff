From 294d27dd3ed548ee58f0a7b358b2fb5056b2654c Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Tue, 28 Aug 2018 18:22:25 -0600
Subject: [PATCH 18/20] soong_config: Add add_json_str_omitempty function

* This function wraps add_json_str so that it does not add the soong
  variable key:value pair to json structure if the second argument
  (value) is empty/unset, preventing the need for more complex
  conditional logic in the middle the code that builds the struct
* This concept allows us to make use of the omitempty field option
  for purposes like single variables controlling ifdef blocks as well
  as carrying the desired value

Change-Id: I99c8c162069c2aa8ff3d0bab2636b01181e74a9d
---
 build/soong/soong_config.mk | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/build/soong/soong_config.mk b/build/soong/soong_config.mk
index 0f6f4b62..5025c964 100644
--- a/build/soong/soong_config.mk
+++ b/build/soong/soong_config.mk
@@ -1,3 +1,5 @@
+add_json_str_omitempty = $(if $(strip $(2)),$(call add_json_str, $(1), $(2)))
+
 _contents := $(_contents)    "Lineage":{$(newline)
 
 # See build/core/soong_config.mk for the add_json_* functions you can use here.
-- 
2.17.1

