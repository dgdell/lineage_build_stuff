From 281e0e7cf1e2926424c0e8ed2ec3cba51bca9e80 Mon Sep 17 00:00:00 2001
From: Rashed Abdel-Tawab <rashed@linux.com>
Date: Fri, 15 Jun 2018 23:08:59 -0700
Subject: [PATCH 13/28] kernel: Add kernelversion recipe to generate
 MAJOR.MINOR kernel version

Change-Id: Ia1f2828292c1fbce2441e64b943dcc0ebecde941
---
 build/tasks/kernel.mk | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/build/tasks/kernel.mk b/build/tasks/kernel.mk
index cc9cf9f9..78b28bef 100644
--- a/build/tasks/kernel.mk
+++ b/build/tasks/kernel.mk
@@ -412,6 +412,10 @@ alldefconfig:
 	env KCONFIG_NOTIMESTAMP=true \
 		 $(MAKE) -C $(KERNEL_SRC) O=$(KERNEL_OUT) ARCH=$(KERNEL_ARCH) $(KERNEL_CROSS_COMPILE) $(KERNEL_CLANG_TRIPLE) $(KERNEL_CC) alldefconfig
 
+kernelversion:
+	$(hide) mkdir -p $(KERNEL_OUT)
+	$(MAKE) --quiet -C $(KERNEL_SRC) O=$(KERNEL_OUT) kernelversion | cut -f1,2 -d'.' > $(KERNEL_OUT)/.kernelversion
+
 endif # FULL_KERNEL_BUILD
 
 TARGET_PREBUILT_DTBO = $(PRODUCT_OUT)/dtbo/arch/$(KERNEL_ARCH)/boot/dtbo.img
-- 
2.17.1

