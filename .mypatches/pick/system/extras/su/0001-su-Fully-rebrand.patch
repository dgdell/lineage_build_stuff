From b77ac3a0ba5f31f9e9aebe6ed8d2b79c68624404 Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Mon, 27 Aug 2018 18:24:41 +0100
Subject: [PATCH 01/12] su: Fully rebrand

Change-Id: Id45473d61b139b64bbeeb37c09d5a2a57858b695
---
 su.c |  7 ++++---
 su.h | 11 ++++++-----
 2 files changed, 10 insertions(+), 8 deletions(-)

diff --git a/su.c b/su.c
index a28a9d80..bc3466bd 100644
--- a/su.c
+++ b/su.c
@@ -1,6 +1,7 @@
 /*
 ** Copyright 2010, Adam Shanks (@ChainsDD)
 ** Copyright 2008, Zinx Verituse (@zinxv)
+** Copyright 2017-2018, The LineageOS Project
 **
 ** Licensed under the Apache License, Version 2.0 (the "License");
 ** you may not use this file except in compliance with the License.
@@ -282,7 +283,7 @@ static __attribute__ ((noreturn)) void allow(struct su_context *ctx, const char
 }
 
 /*
- * CyanogenMod-specific behavior
+ * Lineage-specific behavior
  *
  * we can't simply use the property service, since we aren't launched from init
  * and can't trust the location of the property workspace.
@@ -328,7 +329,7 @@ int access_disabled(const struct su_initiator *from) {
     /* enforce persist.sys.root_access on non-eng builds for apps */
     if (strcmp("eng", build_type) != 0 &&
             from->uid != AID_SHELL && from->uid != AID_ROOT &&
-            (atoi(enabled) & CM_ROOT_ACCESS_APPS_ONLY) != CM_ROOT_ACCESS_APPS_ONLY ) {
+            (atoi(enabled) & LINEAGE_ROOT_ACCESS_APPS_ONLY) != LINEAGE_ROOT_ACCESS_APPS_ONLY ) {
         ALOGE("Apps root access is disabled by system setting - "
              "enable it under settings -> developer options");
         return 1;
@@ -336,7 +337,7 @@ int access_disabled(const struct su_initiator *from) {
 
     /* disallow su in a shell if appropriate */
     if (from->uid == AID_SHELL &&
-            (atoi(enabled) & CM_ROOT_ACCESS_ADB_ONLY) != CM_ROOT_ACCESS_ADB_ONLY ) {
+            (atoi(enabled) & LINEAGE_ROOT_ACCESS_ADB_ONLY) != LINEAGE_ROOT_ACCESS_ADB_ONLY ) {
         ALOGE("Shell root access is disabled by a system setting - "
              "enable it under settings -> developer options");
         return 1;
diff --git a/su.h b/su.h
index 6c21f519..47b0eb04 100644
--- a/su.h
+++ b/su.h
@@ -1,6 +1,7 @@
 /*
 ** Copyright 2010, Adam Shanks (@ChainsDD)
 ** Copyright 2008, Zinx Verituse (@zinxv)
+** Copyright 2017-2018, The LineageOS Project
 **
 ** Licensed under the Apache License, Version 2.0 (the "License");
 ** you may not use this file except in compliance with the License.
@@ -23,11 +24,11 @@
 #endif
 #define LOG_TAG "su"
 
-// CyanogenMod-specific behavior
-#define CM_ROOT_ACCESS_DISABLED      0
-#define CM_ROOT_ACCESS_APPS_ONLY     1
-#define CM_ROOT_ACCESS_ADB_ONLY      2
-#define CM_ROOT_ACCESS_APPS_AND_ADB  3
+// Lineage-specific behavior
+#define LINEAGE_ROOT_ACCESS_DISABLED      0
+#define LINEAGE_ROOT_ACCESS_APPS_ONLY     1
+#define LINEAGE_ROOT_ACCESS_ADB_ONLY      2
+#define LINEAGE_ROOT_ACCESS_APPS_AND_ADB  3
 
 #define DAEMON_SOCKET_PATH "/dev/socket/su-daemon/"
 
-- 
2.17.1

