From 6ba8b266b121a9e6419b23a10b75fa17e3fdf6f8 Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Wed, 24 Oct 2018 22:51:10 +0200
Subject: [PATCH 11/11] su: Update AppOps API calls

Change-Id: Ic3982c41e6700dd5116ea4423993fd355e920157
---
 binder/appops-wrapper.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/binder/appops-wrapper.cpp b/binder/appops-wrapper.cpp
index f749b4ea..40227692 100644
--- a/binder/appops-wrapper.cpp
+++ b/binder/appops-wrapper.cpp
@@ -12,7 +12,7 @@ int appops_start_op_su(int uid, const char* pkgName) {
     ALOGD("Checking whether app [uid:%d, pkgName: %s] is allowed to be root", uid, pkgName);
 
     AppOpsManager ops;
-    int mode = ops.startOp(AppOpsManager::OP_SU, uid, String16(pkgName));
+    int mode = ops.startOpNoThrow(AppOpsManager::OP_SU, uid, String16(pkgName), false);
     if (mode == AppOpsManager::MODE_ALLOWED) {
         ALOGD("Privilege elevation allowed by appops");
         return 0;
-- 
2.17.1

