From 475529c89cb676ab1d17ad07d3a8245b9403d7de Mon Sep 17 00:00:00 2001
From: Luca Stefani <luca.stefani.ge1@gmail.com>
Date: Sun, 26 Aug 2018 11:30:39 +0200
Subject: [PATCH 02/12] su: strlcpy is always a friend

Change-Id: I5ac13e9443069764f23a81f142a108ee96b16efa
---
 su.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/su.c b/su.c
index bc3466bd..fd609c0f 100644
--- a/su.c
+++ b/su.c
@@ -241,7 +241,7 @@ static __attribute__ ((noreturn)) void allow(struct su_context *ctx, const char
             exit(EXIT_FAILURE);
 
         *p = '-';
-        strcpy(p + 1, arg0);
+        strlcpy(p + 1, arg0, s - 2);
         arg0 = p;
     }
 
-- 
2.17.1

