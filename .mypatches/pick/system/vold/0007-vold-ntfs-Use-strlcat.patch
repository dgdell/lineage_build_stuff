From 3b9625afe5a2e90304e922c924f63e562cb0de58 Mon Sep 17 00:00:00 2001
From: Rashed Abdel-Tawab <rashed@linux.com>
Date: Thu, 26 Oct 2017 22:24:22 -0700
Subject: [PATCH 07/20] vold: ntfs: Use strlcat

Clang now enforces length checking :/

Change-Id: I495b4cb2ee530e72b1084248f0549d63589523b0
---
 fs/Ntfs.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/fs/Ntfs.cpp b/fs/Ntfs.cpp
index eb06aa1..2ae42b4 100644
--- a/fs/Ntfs.cpp
+++ b/fs/Ntfs.cpp
@@ -65,11 +65,11 @@ status_t Mount(const std::string& source, const std::string& target, bool ro,
             ownerUid, ownerGid, permMask, permMask);
 
     if (!executable)
-        strcat(mountData, ",noexec");
+        strlcat(mountData, ",noexec", sizeof(mountData));
     if (ro)
-        strcat(mountData, ",ro");
+        strlcat(mountData, ",ro", sizeof(mountData));
     if (remount)
-        strcat(mountData, ",remount");
+        strlcat(mountData, ",remount", sizeof(mountData));
 
     std::vector<std::string> cmd;
     cmd.push_back(kMountPath);
-- 
2.17.1

