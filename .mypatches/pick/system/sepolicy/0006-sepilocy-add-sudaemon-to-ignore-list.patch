From 45456b66eeef9b2fb35703a1fa637d142ea76dda Mon Sep 17 00:00:00 2001
From: jrior001 <jriordan001@gmail.com>
Date: Mon, 8 Jan 2018 17:52:16 -0500
Subject: [PATCH 6/6] sepilocy: add sudaemon to ignore list

Change-Id: I02c1699d13f88805a5656a45a1b47743f3f07d04
---
 private/compat/26.0/26.0.ignore.cil | 1 +
 public/domain.te                    | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/private/compat/26.0/26.0.ignore.cil b/private/compat/26.0/26.0.ignore.cil
index 814d50c..b37a5c5 100644
--- a/private/compat/26.0/26.0.ignore.cil
+++ b/private/compat/26.0/26.0.ignore.cil
@@ -18,6 +18,7 @@
     netd_stable_secret_prop
     package_native_service
     sdcard_posix
+    sudaemon
     sysfs_fs_ext4_features
     system_net_netd_hwservice
     thermal_service
diff --git a/public/domain.te b/public/domain.te
index 5af5140..858e7c6 100644
--- a/public/domain.te
+++ b/public/domain.te
@@ -807,7 +807,7 @@ neverallow * { file_type fs_type dev_type }:{ lnk_file fifo_file sock_file } mou
 # Nobody should be able to execute su on user builds.
 # On userdebug/eng builds, only dumpstate, shell, and
 # su itself execute su.
-neverallow { domain userdebug_or_eng(`-dumpstate -shell -su -sudaemon -init') } su_exec:file no_x_file_perms;
+neverallow { domain userdebug_or_eng(`-dumpstate -shell -su -sudaemon -domain -init') } su_exec:file no_x_file_perms;
 
 # Do not allow the introduction of new execmod rules. Text relocations
 # and modification of executable pages are unsafe.
-- 
2.7.4

