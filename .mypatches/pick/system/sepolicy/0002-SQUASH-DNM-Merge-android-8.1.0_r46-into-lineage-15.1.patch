From e5380b84caae31f890f5b5826c4079d5481e76dc Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Tue, 4 Sep 2018 21:13:23 -0600
Subject: [PATCH 2/2] [SQUASH][DNM] Merge android-8.1.0_r46 into lineage-15.1

Change-Id: I0c5f9cbc883e950b9221755d6de8c4b4c0d3d471
---
 private/crash_dump.te | 11 +++++++++++
 public/crash_dump.te  |  8 --------
 2 files changed, 11 insertions(+), 8 deletions(-)

diff --git a/private/crash_dump.te b/private/crash_dump.te
index fb73f08a..56693fda 100644
--- a/private/crash_dump.te
+++ b/private/crash_dump.te
@@ -1 +1,12 @@
 typeattribute crash_dump coredomain;
+
+allow crash_dump {
+  domain
+  -crash_dump
+  -init
+  -kernel
+  -keystore
+  -logd
+  -ueventd
+  -vold
+}:process { ptrace signal sigchld sigstop sigkill };
diff --git a/public/crash_dump.te b/public/crash_dump.te
index c101b34d..e81bbd11 100644
--- a/public/crash_dump.te
+++ b/public/crash_dump.te
@@ -1,14 +1,6 @@
 type crash_dump, domain;
 type crash_dump_exec, exec_type, file_type;
 
-allow crash_dump {
-  domain
-  -init
-  -crash_dump
-  -keystore
-  -logd
-}:process { ptrace signal sigchld sigstop sigkill };
-
 # crash_dump might inherit CAP_SYS_PTRACE from a privileged process,
 # which will result in an audit log even when it's allowed to trace.
 dontaudit crash_dump self:capability { sys_ptrace };
-- 
2.17.1

