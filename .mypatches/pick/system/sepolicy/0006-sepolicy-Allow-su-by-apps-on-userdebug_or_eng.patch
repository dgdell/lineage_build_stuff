From 100a95b7551cc7bf8ffa980b6f0b8e11eeb6800a Mon Sep 17 00:00:00 2001
From: Steve Kondik <steve@cyngn.com>
Date: Fri, 26 Aug 2016 04:29:17 -0700
Subject: [PATCH 6/8] sepolicy: Allow su by apps on userdebug_or_eng

 * Our framework deals with access control.

Change-Id: Idc737c545c358752b5c5aea468fa50525e7bdd42
---
 public/domain.te | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/public/domain.te b/public/domain.te
index a9bac3c..01abfd1 100644
--- a/public/domain.te
+++ b/public/domain.te
@@ -805,7 +805,7 @@ neverallow * { file_type fs_type dev_type }:{ lnk_file fifo_file sock_file } mou
 # Nobody should be able to execute su on user builds.
 # On userdebug/eng builds, only dumpstate, shell, and
 # su itself execute su.
-neverallow { domain userdebug_or_eng(`-dumpstate -shell -su') } su_exec:file no_x_file_perms;
+neverallow { domain userdebug_or_eng(`-dumpstate -shell -su -sudaemon') } su_exec:file no_x_file_perms;
 
 # Do not allow the introduction of new execmod rules. Text relocations
 # and modification of executable pages are unsafe.
-- 
2.7.4

