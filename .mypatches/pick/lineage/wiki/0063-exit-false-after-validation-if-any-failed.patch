From 3d25e6510b776edfb42c69b3247689f4e710ac65 Mon Sep 17 00:00:00 2001
From: Michael Cook <code@mdcook.net>
Date: Fri, 5 Jan 2018 23:52:47 -0800
Subject: [PATCH 063/249] exit false after validation if any failed

Change-Id: Ib08283a79ef766a13a3f29e5d1dd74b7d0d85a24
---
 test/validate.rb | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/test/validate.rb b/test/validate.rb
index 68b1b94..78a664d 100755
--- a/test/validate.rb
+++ b/test/validate.rb
@@ -23,6 +23,7 @@ begin
   JSON::Validator.validate!(schema, sample, :validate_schema => true)
 rescue JSON::Schema::ValidationError => e
   puts sample_path + ': ' + e.message
+  at_exit { exit false }
 end
 
 device_dir = File.expand_path('../_data/devices/', __dir__) + '/'
@@ -35,6 +36,7 @@ Dir.entries(device_dir).each do |filename|
       JSON::Validator.validate!(schema, device, :validate_schema => true)
     rescue JSON::Schema::ValidationError => e
       puts device_path + ': ' + e.message
+      at_exit { exit false }
     end
   end
 end
-- 
2.17.1

