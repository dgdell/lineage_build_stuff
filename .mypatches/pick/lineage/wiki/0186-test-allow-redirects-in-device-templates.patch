From e05f033d9f1055980be8f4b89dabd1950a05369f Mon Sep 17 00:00:00 2001
From: Simon Shields <simon@lineageos.org>
Date: Mon, 25 Jun 2018 21:22:07 +1000
Subject: [PATCH 186/249] test: allow redirects in device templates

Change-Id: I06f6886d9b9b6fdf1f4f69bf7486de8b32f4de28
---
 test/validate.rb | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/test/validate.rb b/test/validate.rb
index a27dd81..2cd6db2 100755
--- a/test/validate.rb
+++ b/test/validate.rb
@@ -35,6 +35,8 @@ def validate_template(template, path, codename)
   if File.file?(path)
     template_content = template.gsub('{codename}', codename)
     file_content = File.open(path, 'r') { |file| file.read }
+    # remove redirects from the file, because we want to allow them if necessary
+    file_content.sub!(/^redirect_from:.+?( +- *[a-zA-Z0-9.\/]+$.)+/m, '')
     if not template_content == file_content
       puts to_relative_path(path) + ': Not generated from template'
       at_exit { exit false }
-- 
2.17.1

