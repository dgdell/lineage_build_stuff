From 93f0630d2f3e82a62fb4f1c40a3e05d7ee1e1f2b Mon Sep 17 00:00:00 2001
From: nx111 <gd.zhangdz@gmail.com>
Date: Tue, 17 Apr 2018 02:10:17 +0800
Subject: [PATCH 16/17] cpufreq: fix governor hyper.

Change-Id: I2ddb54cbb20177ae43f23e5a1b6e40710476a7c6
---
 drivers/cpufreq/cpufreq_hyper.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/cpufreq/cpufreq_hyper.c b/drivers/cpufreq/cpufreq_hyper.c
index 252de93594e..0988f8dbfff 100644
--- a/drivers/cpufreq/cpufreq_hyper.c
+++ b/drivers/cpufreq/cpufreq_hyper.c
@@ -194,13 +194,13 @@ static inline u64 get_cpu_idle_time_jiffy(unsigned int cpu, u64 *wall)
 	return jiffies_to_usecs(idle_time);
 }
 
-static inline u64 get_cpu_idle_time(unsigned int cpu, u64 *wall)
+static inline u64 get_cpu_idle_time(unsigned int cpu, u64 *wall, bool io_is_busy)
 {
 	u64 idle_time = get_cpu_idle_time_us(cpu, NULL);
 
 	if (idle_time == -1ULL)
 		return get_cpu_idle_time_jiffy(cpu, wall);
-	else
+	else if (!io_is_busy)
 		idle_time += get_cpu_iowait_time_us(cpu, wall);
 
 	return idle_time;
-- 
2.17.0

