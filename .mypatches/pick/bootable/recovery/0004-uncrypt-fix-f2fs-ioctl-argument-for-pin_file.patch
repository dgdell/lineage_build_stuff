From 935ae30d09b0436d2b220e84310e935dd8c634cf Mon Sep 17 00:00:00 2001
From: Jaegeuk Kim <jaegeuk@google.com>
Date: Mon, 23 Jul 2018 15:38:35 -0700
Subject: [PATCH 4/4] uncrypt: fix f2fs ioctl argument for pin_file

This patch fixes missing f2fs ioctl call.

Change-Id: Id840b76b9d5c580041aaee4501ac8e69fc3fb818
Signed-off-by: Jaegeuk Kim <jaegeuk@google.com>
---
 uncrypt/uncrypt.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/uncrypt/uncrypt.cpp b/uncrypt/uncrypt.cpp
index 16036f9c..95f40c71 100644
--- a/uncrypt/uncrypt.cpp
+++ b/uncrypt/uncrypt.cpp
@@ -332,7 +332,8 @@ static int produce_block_map(const char* path, const char* map_file, const char*
 #define F2FS_IOC_GET_PIN_FILE	_IOW(F2FS_IOCTL_MAGIC, 14, __u32)
 #endif
     if (f2fs_fs) {
-        int error = ioctl(fd, F2FS_IOC_SET_PIN_FILE);
+        __u32 set = 1;
+        int error = ioctl(fd, F2FS_IOC_SET_PIN_FILE, &set);
         // Don't break the old kernels which don't support it.
         if (error && errno != ENOTTY && errno != ENOTSUP) {
             PLOG(ERROR) << "Failed to set pin_file for f2fs: " << path << " on " << blk_dev;
-- 
2.17.1

