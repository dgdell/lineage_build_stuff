From 18817288b98387e15af0bcf3c625c4182f6b491c Mon Sep 17 00:00:00 2001
From: Ethan Chen <intervigil@gmail.com>
Date: Mon, 25 Sep 2017 23:19:30 -0700
Subject: [PATCH 11/13] sepolicy: Allow wcnss_service to set wlan.driver
 properties

Change-Id: I83a6ed71a2281c421aba727dca313dda4eb8bd4f
---
 common/property.te       | 2 ++
 common/property_contexts | 3 +++
 common/wcnss_service.te  | 2 ++
 3 files changed, 7 insertions(+)

diff --git a/common/property.te b/common/property.te
index 21fa1eb..36b245d 100644
--- a/common/property.te
+++ b/common/property.te
@@ -131,3 +131,5 @@ type mmi_prop, property_type;
 
 #imsrcsservice
 type ctl_vendor_imsrcsservice_prop, property_type;
+
+type wcnss_prop, property_type;
diff --git a/common/property_contexts b/common/property_contexts
index 800a883..cfa62a4 100644
--- a/common/property_contexts
+++ b/common/property_contexts
@@ -125,3 +125,6 @@ persist.vendor.crash.detect        u:object_r:crash_prop:s0
 persist.vendor.mmi.        u:object_r:mmi_prop:s0
 
 ctl.vendor.imsrcsservice   u:object_r:ctl_vendor_imsrcsservice_prop:s0
+
+wlan.driver.ath            u:object_r:wcnss_prop:s0
+wlan.driver.config         u:object_r:wcnss_prop:s0
diff --git a/common/wcnss_service.te b/common/wcnss_service.te
index f8b2ee3..240af67 100644
--- a/common/wcnss_service.te
+++ b/common/wcnss_service.te
@@ -74,3 +74,5 @@ hal_client_domain(wcnss_service, hal_perf)
 
 # read persist.vendor.wigig.npt.enable
 get_prop(wcnss_service, wigig_prop);
+
+set_prop(wcnss_service, wcnss_prop)
-- 
2.7.4

