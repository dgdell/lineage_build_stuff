From 8081a6e9ec3e9a0ccb11c0e06bf76a87d11256b0 Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Wed, 28 Feb 2018 09:58:11 +0000
Subject: [PATCH 13/15] legacy: Address perfd denials

Change-Id: If569ce1cb560a19123b1b7bfae5e10e653825f35
---
 legacy-common/perfd.te | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/legacy-common/perfd.te b/legacy-common/perfd.te
index c756c7e..070ca22 100644
--- a/legacy-common/perfd.te
+++ b/legacy-common/perfd.te
@@ -3,6 +3,8 @@ type perfd_exec, exec_type, vendor_file_type, file_type;
 
 init_daemon_domain(perfd)
 
+allow perfd self:capability fsetid;
+
 allow perfd {
     sysfs_devices_system_cpu
     sysfs_cpu_online
@@ -30,6 +32,10 @@ allow perfd sysfs_lib:file w_file_perms;
 r_dir_file(perfd, sysfs_kgsl)
 allow perfd sysfs_kgsl:file write;
 
+# Allow access to thermal sysfs entry
+allow perfd sysfs_thermal:dir search;
+allow perfd sysfs_thermal:file w_file_perms;
+
 # mpctl socket
 allow perfd mpctl_socket:dir rw_dir_perms;
 allow perfd mpctl_socket:sock_file create_file_perms;
-- 
2.7.4

