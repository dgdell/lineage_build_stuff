From 49b5500764a7d6043991b094a48bdf52e275ee31 Mon Sep 17 00:00:00 2001
From: Michael Bestas <mkbestas@lineageos.org>
Date: Thu, 22 Mar 2018 20:00:47 +0200
Subject: [PATCH 06/16] legacy: Address msm8916 perfd denials

Change-Id: I1f5205de9c42f3ae1e2d6c877bc90b6a77dbc74a
---
 legacy-common/hal_audio_default.te  | 1 +
 legacy-common/hal_camera_default.te | 1 +
 legacy-common/perfd.te              | 3 +++
 3 files changed, 5 insertions(+)
 create mode 100644 legacy-common/hal_audio_default.te
 create mode 100644 legacy-common/hal_camera_default.te

diff --git a/legacy-common/hal_audio_default.te b/legacy-common/hal_audio_default.te
new file mode 100644
index 0000000..ecb0204
--- /dev/null
+++ b/legacy-common/hal_audio_default.te
@@ -0,0 +1 @@
+allow hal_audio_default mpctl_socket:dir search;
diff --git a/legacy-common/hal_camera_default.te b/legacy-common/hal_camera_default.te
new file mode 100644
index 0000000..670d8bc
--- /dev/null
+++ b/legacy-common/hal_camera_default.te
@@ -0,0 +1 @@
+allow hal_camera_default mpctl_socket:dir search;
diff --git a/legacy-common/perfd.te b/legacy-common/perfd.te
index 5595fff..c756c7e 100644
--- a/legacy-common/perfd.te
+++ b/legacy-common/perfd.te
@@ -46,3 +46,6 @@ set_prop(perfd, freq_prop)
 
 allow perfd cgroup:file r_file_perms;
 allow perfd sysfs:dir r_dir_perms;
+
+allow perfd hal_power_default:dir search;
+allow perfd hal_power_default:file { open read };
-- 
2.15.1

