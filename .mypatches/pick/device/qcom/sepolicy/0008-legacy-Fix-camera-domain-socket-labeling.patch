From 055baedd49a58cce6f8376d36e90e437a5451f48 Mon Sep 17 00:00:00 2001
From: Ricardo Cerqueira <ricardo@cyngn.com>
Date: Thu, 27 Nov 2014 17:01:35 +0000
Subject: [PATCH 08/13] legacy: Fix camera domain socket labeling

Change-Id: I42094eb1064eca4cf227ee7af559427b160f476e
---
 legacy-common/file_contexts  | 3 +++
 legacy-common/mm-qcamerad.te | 2 ++
 2 files changed, 5 insertions(+)

diff --git a/legacy-common/file_contexts b/legacy-common/file_contexts
index f5429e1..6e692d9 100644
--- a/legacy-common/file_contexts
+++ b/legacy-common/file_contexts
@@ -59,3 +59,6 @@
 
 # Runtime status
 /sys/devices/mdp\.0/power/runtime_status                                      u:object_r:sysfs_runtime_status:s0
+
+# Old camera sockets
+/data/cam_socket[12]                                                          u:object_r:camera_socket:s0
diff --git a/legacy-common/mm-qcamerad.te b/legacy-common/mm-qcamerad.te
index 951dbe2..3e53573 100644
--- a/legacy-common/mm-qcamerad.te
+++ b/legacy-common/mm-qcamerad.te
@@ -1,5 +1,7 @@
 binder_use(mm-qcamerad)
 
+type_transition mm-qcamerad system_data_file:sock_file camera_socket "cam_socket1";
+type_transition mm-qcamerad system_data_file:sock_file camera_socket "cam_socket2";
 allow mm-qcamerad camera_socket:sock_file { create unlink write };
 allow mm-qcamerad camera_data_file:sock_file { create unlink };
 
-- 
2.7.4

