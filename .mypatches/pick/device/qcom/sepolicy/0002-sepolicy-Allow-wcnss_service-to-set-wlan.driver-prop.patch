From d1d075138a416e5b7805c7c60c4f08b6e80913cd Mon Sep 17 00:00:00 2001
From: Ethan Chen <intervigil@gmail.com>
Date: Mon, 25 Sep 2017 23:19:30 -0700
Subject: [PATCH 02/16] sepolicy: Allow wcnss_service to set wlan.driver
 properties

Change-Id: I83a6ed71a2281c421aba727dca313dda4eb8bd4f
---
 vendor/common/property.te       | 2 ++
 vendor/common/property_contexts | 3 +++
 vendor/common/wcnss_service.te  | 2 ++
 3 files changed, 7 insertions(+)

diff --git a/vendor/common/property.te b/vendor/common/property.te
index fbf9e48a..77983884 100644
--- a/vendor/common/property.te
+++ b/vendor/common/property.te
@@ -182,3 +182,5 @@ type ctl_vendor_rmt_storage_prop, property_type;
 type vendor_gpu_prop, property_type;
 
 type vendor_data_ko_prop, property_type;
+
+type wcnss_prop, property_type;
diff --git a/vendor/common/property_contexts b/vendor/common/property_contexts
index 06dcc95a..ac5debb5 100644
--- a/vendor/common/property_contexts
+++ b/vendor/common/property_contexts
@@ -227,3 +227,6 @@ vendor.gpu.available_frequencies u:object_r:vendor_gpu_prop:s0
 
 persist.vendor.data.shs_ko_load u:object_r:vendor_data_ko_prop:s0
 persist.vendor.data.perf_ko_load u:object_r:vendor_data_ko_prop:s0
+
+wlan.driver.ath            u:object_r:wcnss_prop:s0
+wlan.driver.config         u:object_r:wcnss_prop:s0
diff --git a/vendor/common/wcnss_service.te b/vendor/common/wcnss_service.te
index d45d485a..4d3574d1 100644
--- a/vendor/common/wcnss_service.te
+++ b/vendor/common/wcnss_service.te
@@ -70,3 +70,5 @@ get_prop(wcnss_service, wigig_prop);
 
 # allow to read /sys/class/net file
 r_dir_file(wcnss_service, sysfs_net);
+
+set_prop(wcnss_service, wcnss_prop)
-- 
2.17.1

