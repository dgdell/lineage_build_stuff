From 48f3704a11063efc61379e8f91379f88695e0b0d Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Mon, 20 Aug 2018 14:21:08 +0100
Subject: [PATCH 3/3] common: Remove duplicate definition of hostapd data files

 * Already defined now by system policies

Change-Id: I1cbdcc8ebd918bef7c5a4e22a57adbfa75878be0
---
 common/file.te       | 1 -
 common/file_contexts | 1 -
 common/fstman.te     | 4 ++--
 3 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/common/file.te b/common/file.te
index 9a0ecd0..baf075f 100644
--- a/common/file.te
+++ b/common/file.te
@@ -239,7 +239,6 @@ type dynamic_nv_data_file, file_type, data_file_type;
 # Wifi Data file
 type wifi_vendor_data_file, file_type, data_file_type;
 type wifi_vendor_wpa_socket, file_type, data_file_type;
-type wifi_vendor_hostapd_socket, file_type, data_file_type;
 
 # wififtmd socket file
 type wififtmd_socket, file_type;
diff --git a/common/file_contexts b/common/file_contexts
index 3246408..21d3fc6 100644
--- a/common/file_contexts
+++ b/common/file_contexts
@@ -555,7 +555,6 @@
 /data/system/swap(/.*)?                                             u:object_r:swap_data_file:s0
 /data/vendor/wifi(/.*)?                                             u:object_r:wifi_vendor_data_file:s0
 /data/vendor/wifi/sockets(/.*)?                                     u:object_r:wifi_vendor_wpa_socket:s0
-/data/vendor/wifi/hostapd(/.*)?                                     u:object_r:wifi_vendor_hostapd_socket:s0
 /data/misc/wifi/nvbin(/.*)?                                         u:object_r:dynamic_nv_data_file:s0
 /data/vendor/wifi/wigig_sockets(/.*)?                               u:object_r:wpa_socket:s0
 /data/vendor/wifi/wigig_sockets/wpa_ctrl.*                          u:object_r:wifi_vendor_wpa_socket:s0
diff --git a/common/fstman.te b/common/fstman.te
index 2cda090..f596684 100644
--- a/common/fstman.te
+++ b/common/fstman.te
@@ -67,5 +67,5 @@ allow fstman wifi_vendor_wpa_socket:sock_file create_file_perms;
 allow fstman wpa_socket:dir rw_dir_perms;
 allow fstman wpa_socket:sock_file create_file_perms;
 # hostapd global socket
-allow fstman wifi_vendor_hostapd_socket:dir rw_dir_perms;
-allow fstman wifi_vendor_hostapd_socket:sock_file create_file_perms;
+allow fstman hostapd_data_file:dir rw_dir_perms;
+allow fstman hostapd_data_file:sock_file create_file_perms;
-- 
2.17.1

