From a9e11bd4de63ad610e165c8d9d916672dff67ff2 Mon Sep 17 00:00:00 2001
From: micky387 <mickaelsaibi@free.fr>
Date: Sat, 21 Oct 2017 13:31:45 +0200
Subject: [PATCH 2/4] qca1530: use create_socket_perms_no_ioctl to avoid
 neverallows

Change-Id: Ia72ae894014db20cd6ce38e17e93b606ee351049
---
 apq8084/qca1530.te | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/apq8084/qca1530.te b/apq8084/qca1530.te
index adf3a30..f1cd348 100644
--- a/apq8084/qca1530.te
+++ b/apq8084/qca1530.te
@@ -60,7 +60,7 @@ allow qca1530 self:capability {
 };
 
 allow qca1530 self:capability2 syslog;
-allow qca1530 self:{ unix_dgram_socket packet_socket socket } create_socket_perms;
+allow qca1530 self:{ unix_dgram_socket packet_socket socket } create_socket_perms_no_ioctl;
 
 # Execute the shell or system commands.
 allow qca1530 { qca1530_exec shell_exec }:file rx_file_perms;
-- 
2.7.4

