From f4053b378056565192974674c4bb41ce3e93ba3b Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Fri, 22 Dec 2017 16:54:41 +0100
Subject: [PATCH 13/14] sepolicy: Move fingerprint 2.0 service out of private
 sepolicy

Change-Id: Ifb55a009f4ff87b9a3571b24943b5e9c31f9dcd2
---
 common/file_contexts         | 2 ++
 common/private/file_contexts | 3 ---
 common/sepolicy.mk           | 3 +++
 3 files changed, 5 insertions(+), 3 deletions(-)
 create mode 100644 common/file_contexts

diff --git a/common/file_contexts b/common/file_contexts
new file mode 100644
index 0000000..2cb4d75
--- /dev/null
+++ b/common/file_contexts
@@ -0,0 +1,2 @@
+# Fingerprint
+/(vendor|system/vendor)/bin/hw/android\.hardware\.biometrics\.fingerprint@2\.0-service u:object_r:hal_fingerprint_default_exec:s0
diff --git a/common/private/file_contexts b/common/private/file_contexts
index b028f39..8429f15 100644
--- a/common/private/file_contexts
+++ b/common/private/file_contexts
@@ -5,9 +5,6 @@
 /system/bin/mkfs\.f2fs                  u:object_r:mkfs_exec:s0
 /system/bin/mkfs\.ntfs                  u:object_r:mkfs_exec:s0
 
-# Fingerprint
-/(vendor|system/vendor)/bin/hw/android\.hardware\.biometrics\.fingerprint@2\.0-service u:object_r:hal_fingerprint_default_exec:s0
-
 # OTA packages
 /data/lineageos_updates(/.*)?           u:object_r:ota_package_file:s0
 
diff --git a/common/sepolicy.mk b/common/sepolicy.mk
index c440cf3..f43347d 100644
--- a/common/sepolicy.mk
+++ b/common/sepolicy.mk
@@ -3,6 +3,9 @@
 # inherit from Lineage
 #
 
+BOARD_SEPOLICY_DIRS += \
+    device/lineage/sepolicy/common
+
 BOARD_PLAT_PUBLIC_SEPOLICY_DIR += \
     device/lineage/sepolicy/common/public
 
-- 
2.7.4

