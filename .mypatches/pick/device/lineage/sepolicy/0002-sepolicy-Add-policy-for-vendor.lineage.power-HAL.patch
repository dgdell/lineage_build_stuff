From a609351c64ca3c312b60aecee3b94d94e0133474 Mon Sep 17 00:00:00 2001
From: Rashed Abdel-Tawab <rashed@linux.com>
Date: Sun, 21 Jan 2018 17:40:51 -0800
Subject: [PATCH 2/3] sepolicy: Add policy for vendor.lineage.power HAL

Change-Id: I95f1cad2b9b0c4ca4c0c49630bb38304d5b30d36
---
 common/vendor/hal_power_default.te | 1 +
 common/vendor/hwservice.te         | 1 +
 common/vendor/hwservice_contexts   | 1 +
 common/vendor/system_server.te     | 1 +
 4 files changed, 4 insertions(+)
 create mode 100644 common/vendor/hal_power_default.te
 create mode 100644 common/vendor/hwservice.te
 create mode 100644 common/vendor/hwservice_contexts
 create mode 100644 common/vendor/system_server.te

diff --git a/common/vendor/hal_power_default.te b/common/vendor/hal_power_default.te
new file mode 100644
index 0000000..c693a2d
--- /dev/null
+++ b/common/vendor/hal_power_default.te
@@ -0,0 +1 @@
+allow hal_power_default hal_lineage_power_hwservice:hwservice_manager { add find };
diff --git a/common/vendor/hwservice.te b/common/vendor/hwservice.te
new file mode 100644
index 0000000..2ca8189
--- /dev/null
+++ b/common/vendor/hwservice.te
@@ -0,0 +1 @@
+type hal_lineage_power_hwservice, hwservice_manager_type;
diff --git a/common/vendor/hwservice_contexts b/common/vendor/hwservice_contexts
new file mode 100644
index 0000000..3ae7fd7
--- /dev/null
+++ b/common/vendor/hwservice_contexts
@@ -0,0 +1 @@
+vendor.lineage.power::ILineagePower      u:object_r:hal_lineage_power_hwservice:s0
diff --git a/common/vendor/system_server.te b/common/vendor/system_server.te
new file mode 100644
index 0000000..4a889fc
--- /dev/null
+++ b/common/vendor/system_server.te
@@ -0,0 +1 @@
+allow system_server hal_lineage_power_hwservice:hwservice_manager find;
-- 
2.7.4

