From 9d470ed0c4c74cb1fd2c7d0118af1941571a4575 Mon Sep 17 00:00:00 2001
From: terrycrhuang <terrycrhuang@google.com>
Date: Fri, 4 May 2018 13:47:06 +0800
Subject: [PATCH 08/14] msm8974-common: libril:  Change rild initial sequence
 to guarantee non-null function pointer before rild register its hidl service

Test: Build and local test
Bug: 78886552
Change-Id: I1137cc0f4f09f0304662a2227b84c2b5b228d45d
---
 ril/libril/ril_service.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/ril/libril/ril_service.cpp b/ril/libril/ril_service.cpp
index bb22723..22a2f79 100644
--- a/ril/libril/ril_service.cpp
+++ b/ril/libril/ril_service.cpp
@@ -8660,6 +8660,9 @@ void radio::registerService(RIL_RadioFunctions *callbacks, CommandInfo *commands
     simCount = SIM_COUNT;
     #endif
 
+    s_vendorFunctions = callbacks;
+    s_commands = commands;
+
     configureRpcThreadpool(1, true /* callerWillJoin */);
     for (int i = 0; i < simCount; i++) {
         pthread_rwlock_t *radioServiceRwlockPtr = getRadioServiceRwlock(i);
@@ -8681,9 +8684,6 @@ void radio::registerService(RIL_RadioFunctions *callbacks, CommandInfo *commands
         ret = pthread_rwlock_unlock(radioServiceRwlockPtr);
         assert(ret == 0);
     }
-
-    s_vendorFunctions = callbacks;
-    s_commands = commands;
 }
 
 void rilc_thread_pool() {
-- 
2.17.1

