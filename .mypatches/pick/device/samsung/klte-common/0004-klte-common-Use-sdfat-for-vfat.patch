From 937f0205bc38469a53b5067facd1d067862acf4f Mon Sep 17 00:00:00 2001
From: Paul Keith <javelinanddart@gmail.com>
Date: Mon, 19 Feb 2018 19:55:54 +0100
Subject: [PATCH 4/5] klte-common: Use sdfat for vfat

* Shiny

Change-Id: I79c2cd29a087e422aac89a0ff3574e5e02a2bf83
---
 BoardConfigCommon.mk     | 1 +
 rootdir/etc/init.qcom.rc | 4 ++--
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/BoardConfigCommon.mk b/BoardConfigCommon.mk
index d61a75e..20a4f62 100644
--- a/BoardConfigCommon.mk
+++ b/BoardConfigCommon.mk
@@ -39,6 +39,7 @@ USE_DEVICE_SPECIFIC_CAMERA := true
 
 # Extended Filesystem Support
 TARGET_EXFAT_DRIVER := sdfat
+TARGET_VFAT_DRIVER := sdfat
 
 # HIDL
 DEVICE_MANIFEST_FILE += $(COMMON_PATH)/manifest.xml
diff --git a/rootdir/etc/init.qcom.rc b/rootdir/etc/init.qcom.rc
index c0a673a..e0bd7f6 100644
--- a/rootdir/etc/init.qcom.rc
+++ b/rootdir/etc/init.qcom.rc
@@ -60,9 +60,9 @@ on fs
     check_fs /dev/block/platform/msm_sdcc.1/by-name/efs ext4
     mount ext4 /dev/block/platform/msm_sdcc.1/by-name/efs /efs nosuid nodev noatime noauto_da_alloc,journal_async_commit,errors=panic
     wait /dev/block/platform/msm_sdcc.1/by-name/apnhlos
-    mount vfat /dev/block/platform/msm_sdcc.1/by-name/apnhlos /firmware ro shortname=lower,uid=1000,gid=1026,dmask=227,fmask=337,context=u:object_r:firmware_file:s0
+    mount sdfat /dev/block/platform/msm_sdcc.1/by-name/apnhlos /firmware ro uid=1000,gid=1026,dmask=227,fmask=337,context=u:object_r:firmware_file:s0
     wait /dev/block/platform/msm_sdcc.1/by-name/modem
-    mount vfat /dev/block/platform/msm_sdcc.1/by-name/modem /firmware-modem ro shortname=lower,uid=1000,gid=1026,dmask=227,fmask=337,context=u:object_r:firmware_file:s0
+    mount sdfat /dev/block/platform/msm_sdcc.1/by-name/modem /firmware-modem ro uid=1000,gid=1026,dmask=227,fmask=337,context=u:object_r:firmware_file:s0
 
     restorecon_recursive /efs
 
-- 
2.7.4

