From db703bc8183df7d07352aeacdff2c965aeb72cbe Mon Sep 17 00:00:00 2001
From: Paul Keith <javelinanddart@gmail.com>
Date: Fri, 19 Jan 2018 03:14:59 +0100
Subject: [PATCH 13/18] klte-common: Cleanup symlink code

* Remove compat symlink migration
* Fix comment about symlinking

Change-Id: Id92408bdcbdbe7f8331563750ba645445138ff80
---
 rootdir/etc/init.qcom.rc | 13 ++-----------
 1 file changed, 2 insertions(+), 11 deletions(-)

diff --git a/rootdir/etc/init.qcom.rc b/rootdir/etc/init.qcom.rc
index 9d2631e..a9b9934 100644
--- a/rootdir/etc/init.qcom.rc
+++ b/rootdir/etc/init.qcom.rc
@@ -240,21 +240,12 @@ on post-fs-data
     # Create directories for perfd
     mkdir /data/misc/perfd 2755 root system
     mkdir /data/system/perfd 2770 root system
-
+ 
     # Remove symlinks to avoid issues with migrate after nandroid restores
     # Will be recreated at end of boot
-    # Normal path
     rm /data/data/com.android.providers.telephony/databases
     rm /data/data/com.android.providers.telephony/shared_prefs
 
-    # COMPAT: Handle upgrade from previous implementation of this idea. If the
-    # above could not be unlinked then we have the old symlinked files
-    # scenario. Clean that up.
-    rm /data/data/com.android.providers.telephony/databases/telephony.db
-    rm /data/data/com.android.providers.telephony/shared_prefs/preferred-apn.xml
-    rmdir /data/data/com.android.providers.telephony/databases
-    rmdir /data/data/com.android.providers.telephony/shared_prefs
-
     setprop vold.post_fs_data_done 1
 
 on early-boot
@@ -1017,7 +1008,7 @@ on property:sys.boot_completed=1
     rm /data/system/perfd/default_values
     start mpdecision
 
-    # Symlink directories to access telephony.db and preferred-apn.xml required by cbd
+    # Symlink directories to access telephony.db and preferred-apn.xml required by libsec-ril
     symlink /data/user_de/0/com.android.providers.telephony/databases /data/data/com.android.providers.telephony/databases
     symlink /data/user_de/0/com.android.providers.telephony/shared_prefs /data/data/com.android.providers.telephony/shared_prefs
 
-- 
2.7.4

