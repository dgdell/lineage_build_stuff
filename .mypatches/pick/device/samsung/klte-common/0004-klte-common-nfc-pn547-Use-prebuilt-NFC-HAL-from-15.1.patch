From abf746f8e819bef14872b36c227f00c4ab59f0cd Mon Sep 17 00:00:00 2001
From: jrior001 <jriordan001@gmail.com>
Date: Fri, 31 Aug 2018 20:49:48 -0400
Subject: [PATCH 4/7] klte-common: nfc: pn547: Use prebuilt NFC HAL from 15.1

Change-Id: I03a252ff820d5bd8dde8faac5fa293242aaef1f2
---
 common-proprietary-files-pn547.txt | 1 +
 extract-files.sh                   | 1 +
 nfc/pn547/board.mk                 | 4 ----
 nfc/pn547/product.mk               | 6 ++++--
 4 files changed, 6 insertions(+), 6 deletions(-)
 create mode 100644 common-proprietary-files-pn547.txt

diff --git a/common-proprietary-files-pn547.txt b/common-proprietary-files-pn547.txt
new file mode 100644
index 0000000..eb15a80
--- /dev/null
+++ b/common-proprietary-files-pn547.txt
@@ -0,0 +1 @@
+vendor/lib/hw/nfc_nci.msm8974.so|7dcb79a385dd1155cb9b6310a3e7b85b7dc8db13
diff --git a/extract-files.sh b/extract-files.sh
index e78298e..eec6e6c 100755
--- a/extract-files.sh
+++ b/extract-files.sh
@@ -51,6 +51,7 @@ fi
 setup_vendor "$DEVICE_COMMON" "$VENDOR" "$CM_ROOT" true
 
 extract "$MY_DIR"/common-proprietary-files.txt "$SRC"
+extract "$MY_DIR"/common-proprietary-files-pn547.txt "$SRC"
 
 COMMON_BLOB_ROOT="$CM_ROOT"/vendor/"$VENDOR"/"$DEVICE_COMMON"/proprietary
 
diff --git a/nfc/pn547/board.mk b/nfc/pn547/board.mk
index e52b1ab..4c8a742 100644
--- a/nfc/pn547/board.mk
+++ b/nfc/pn547/board.mk
@@ -16,7 +16,3 @@
 
 # NFC
 include $(COMMON_PATH)/nfc/board.mk
-
-# PN547 specific flags
-BOARD_NFC_CHIPSET := pn547
-BOARD_NFC_HAL_SUFFIX := msm8974
diff --git a/nfc/pn547/product.mk b/nfc/pn547/product.mk
index fa341c9..ec98f16 100644
--- a/nfc/pn547/product.mk
+++ b/nfc/pn547/product.mk
@@ -19,9 +19,11 @@ $(call inherit-product, device/samsung/klte-common/nfc/product.mk)
 
 PRODUCT_PACKAGES += \
     android.hardware.nfc@1.0-impl \
-    libpn547_fw \
-    nfc_nci.msm8974
+    libpn547_fw
 
 PRODUCT_COPY_FILES += \
     device/samsung/klte-common/nfc/pn547/libnfc-nci.conf:$(TARGET_COPY_OUT_VENDOR)/etc/libnfc-nci.conf \
     device/samsung/klte-common/nfc/pn547/libnfc-nxp.conf:$(TARGET_COPY_OUT_VENDOR)/etc/libnfc-nxp.conf
+
+PRODUCT_COPY_FILES += \
+    vendor/samsung/klte-common/proprietary/vendor/lib/hw/nfc_nci.msm8974.so:$(TARGET_COPY_OUT_VENDOR)/lib/hw/nfc_nci.msm8974.so
-- 
2.17.1

