From 708485b92a577f3c610d2897b14e1696b63bd69a Mon Sep 17 00:00:00 2001
From: Alexander Martinz <amartinz@shiftphones.com>
Date: Wed, 4 Jul 2018 19:10:24 +0200
Subject: [PATCH 2/9] IconsHandler: prevent resource not found exception when
 getting xml

JavaDoc of Resources#getIdentifier(...):
  Returns - The associated resource identifier. Returns 0 if no such
            resource was found. (0 is not a valid resource ID.)

Change-Id: Ia9f4ea9efb56bb54d94729f70a3afcec5bce7999
Signed-off-by: Alexander Martinz <amartinz@shiftphones.com>
---
 src/com/android/launcher3/icons/IconsHandler.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/com/android/launcher3/icons/IconsHandler.java b/src/com/android/launcher3/icons/IconsHandler.java
index 04c2dccc4..5cb9dc703 100644
--- a/src/com/android/launcher3/icons/IconsHandler.java
+++ b/src/com/android/launcher3/icons/IconsHandler.java
@@ -215,8 +215,8 @@ public class IconsHandler {
             Resources res = mPackageManager.getResourcesForApplication(packageName);
             mCurrentIconPackRes = res;
             int resource = res.getIdentifier("drawable", "xml", packageName);
-            if (resource < 0) {
-                return;
+            if (resource <= 0) {
+                throw new NameNotFoundException("Could not get identifier for drawable.xml");
             }
             xpp = res.getXml(resource);
             int eventType = xpp.getEventType();
@@ -234,7 +234,7 @@ public class IconsHandler {
             }
         } catch (NameNotFoundException | XmlPullParserException | IOException e) {
             Log.i(TAG, "Error parsing drawable.xml for package " + packageName +
-                    " trying appfilter now");
+                    ", trying appfilter now");
             // fallback onto appfilter if drawable xml fails
             loadIconPack(packageName, true);
         }
-- 
2.17.1

