From 4b1de03565d97e4a3be1414a8f6ebf7c92783c22 Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Mon, 15 Oct 2018 01:51:51 +0200
Subject: [PATCH 2/3] Jelly: Set proper mime type when downloading files

Change-Id: I3f814e0540b99c189af2d16e8e5d1955e1f9213f
---
 app/src/main/java/org/lineageos/jelly/MainActivity.java | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/app/src/main/java/org/lineageos/jelly/MainActivity.java b/app/src/main/java/org/lineageos/jelly/MainActivity.java
index 079f52b..27e4e84 100644
--- a/app/src/main/java/org/lineageos/jelly/MainActivity.java
+++ b/app/src/main/java/org/lineageos/jelly/MainActivity.java
@@ -74,6 +74,7 @@ import android.widget.FrameLayout;
 import android.widget.ImageButton;
 import android.widget.ImageView;
 import android.widget.LinearLayout;
+import android.webkit.MimeTypeMap;
 import android.widget.ProgressBar;
 import android.widget.RelativeLayout;
 import android.widget.TextView;
@@ -522,6 +523,8 @@ public class MainActivity extends WebViewExtActivity implements
         request.setNotificationVisibility(
                 DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
         request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, fileName);
+        request.setMimeType(MimeTypeMap.getSingleton().getMimeTypeFromExtension(
+                MimeTypeMap.getFileExtensionFromUrl(url)));
         getSystemService(DownloadManager.class).enqueue(request);
     }
 
-- 
2.17.1

