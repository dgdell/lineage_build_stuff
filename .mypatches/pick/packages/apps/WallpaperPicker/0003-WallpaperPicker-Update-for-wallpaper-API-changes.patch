From 6e55329b322b295cb7f9bbea753d342982564aa6 Mon Sep 17 00:00:00 2001
From: Arne Coucheron <arco68@gmail.com>
Date: Fri, 30 Jun 2017 07:33:01 +0200
Subject: [PATCH 3/7] WallpaperPicker: Update for wallpaper API changes

Change-Id: I34472ca790e5d6da941f4a16da24b1d5973b34a8
---
 .../android/wallpaperpicker/common/DialogUtils.java   | 11 ++++++-----
 .../common/WallpaperManagerCompat.java                |  3 ---
 .../tileinfo/DefaultWallpaperInfo.java                |  6 +++---
 3 files changed, 9 insertions(+), 11 deletions(-)

diff --git a/src/com/android/wallpaperpicker/common/DialogUtils.java b/src/com/android/wallpaperpicker/common/DialogUtils.java
index 8313535..9cd162c 100644
--- a/src/com/android/wallpaperpicker/common/DialogUtils.java
+++ b/src/com/android/wallpaperpicker/common/DialogUtils.java
@@ -1,6 +1,7 @@
 package com.android.wallpaperpicker.common;
 
 import android.app.AlertDialog;
+import android.app.WallpaperManager;
 import android.content.Context;
 import android.content.DialogInterface;
 import android.os.AsyncTask;
@@ -28,12 +29,12 @@ public class DialogUtils {
                     public void onClick(DialogInterface dialog, int selectedItemIndex) {
                         int whichWallpaper;
                         if (selectedItemIndex == 0) {
-                            whichWallpaper = WallpaperManagerCompat.FLAG_SET_SYSTEM;
+                            whichWallpaper = WallpaperManager.FLAG_SYSTEM;
                         } else if (selectedItemIndex == 1) {
-                            whichWallpaper = WallpaperManagerCompat.FLAG_SET_LOCK;
+                            whichWallpaper = WallpaperManager.FLAG_LOCK;
                         } else {
-                            whichWallpaper = WallpaperManagerCompat.FLAG_SET_SYSTEM
-                                    | WallpaperManagerCompat.FLAG_SET_LOCK;
+                            whichWallpaper = WallpaperManager.FLAG_SYSTEM
+                                    | WallpaperManager.FLAG_LOCK;
                         }
                         cropTask.execute(whichWallpaper);
                     }
@@ -41,7 +42,7 @@ public class DialogUtils {
                 .setOnCancelListener(onCancelListener)
                 .show();
         } else {
-            cropTask.execute(WallpaperManagerCompat.FLAG_SET_SYSTEM);
+            cropTask.execute(WallpaperManager.FLAG_SYSTEM);
         }
     }
 }
diff --git a/src/com/android/wallpaperpicker/common/WallpaperManagerCompat.java b/src/com/android/wallpaperpicker/common/WallpaperManagerCompat.java
index 96df749..272d14c 100644
--- a/src/com/android/wallpaperpicker/common/WallpaperManagerCompat.java
+++ b/src/com/android/wallpaperpicker/common/WallpaperManagerCompat.java
@@ -7,9 +7,6 @@ import java.io.IOException;
 import java.io.InputStream;
 
 public abstract class WallpaperManagerCompat {
-    public static final int FLAG_SET_SYSTEM = 1 << 0; // TODO: use WallpaperManager.FLAG_SET_SYSTEM
-    public static final int FLAG_SET_LOCK = 1 << 1; // TODO: use WallpaperManager.FLAG_SET_LOCK
-
     private static WallpaperManagerCompat sInstance;
     private static final Object sInstanceLock = new Object();
 
diff --git a/src/com/android/wallpaperpicker/tileinfo/DefaultWallpaperInfo.java b/src/com/android/wallpaperpicker/tileinfo/DefaultWallpaperInfo.java
index 68a0e68..9ffb1a4 100644
--- a/src/com/android/wallpaperpicker/tileinfo/DefaultWallpaperInfo.java
+++ b/src/com/android/wallpaperpicker/tileinfo/DefaultWallpaperInfo.java
@@ -71,7 +71,7 @@ public class DefaultWallpaperInfo extends DrawableThumbWallpaperInfo {
             protected Boolean doInBackground(Integer... params) {
                 int whichWallpaper = params[0];
                 boolean succeeded;
-                if (whichWallpaper == WallpaperManagerCompat.FLAG_SET_LOCK) {
+                if (whichWallpaper == WallpaperManager.FLAG_LOCK) {
                     succeeded = setDefaultOnLock(a);
                 } else {
                     succeeded = clearWallpaper(a, whichWallpaper);
@@ -94,7 +94,7 @@ public class DefaultWallpaperInfo extends DrawableThumbWallpaperInfo {
                 byte[] outByteArray = tmpOut.toByteArray();
                 WallpaperManagerCompat.getInstance(a.getApplicationContext())
                         .setStream(new ByteArrayInputStream(outByteArray), null,
-                                true, WallpaperManagerCompat.FLAG_SET_LOCK);
+                                true, WallpaperManager.FLAG_LOCK);
             }
         } catch (IOException e) {
             Log.w(TAG, "Setting wallpaper to default threw exception", e);
@@ -222,4 +222,4 @@ public class DefaultWallpaperInfo extends DrawableThumbWallpaperInfo {
             return false;
         }
     }
-}
\ No newline at end of file
+}
-- 
2.17.1

