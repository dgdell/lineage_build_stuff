From 6cf9def579dbe9d9f85abd21df87c35ed5c12d5e Mon Sep 17 00:00:00 2001
From: Luca Stefani <luca.stefani.ge1@gmail.com>
Date: Wed, 24 Jan 2018 18:43:33 +0100
Subject: [PATCH 5/7] WallpaperPicker: Add icon near dialog items

Change-Id: I130f84cfda103e616c3fff6061c3afa423a36157
---
 res/drawable/ic_home_screen.xml               | 10 +++
 .../ic_home_screen_and_lock_screen.xml        | 10 +++
 res/drawable/ic_lock_screen.xml               | 10 +++
 res/layout/dialog_set_wallpaper_row.xml       | 26 ++++++
 .../android/wallpaperpicker/NoWallpaper.java  |  2 +-
 .../WallpaperListBaseAdapter.java             | 86 +++++++++++++++++++
 .../wallpaperpicker/common/DialogUtils.java   |  4 +-
 7 files changed, 146 insertions(+), 2 deletions(-)
 create mode 100644 res/drawable/ic_home_screen.xml
 create mode 100644 res/drawable/ic_home_screen_and_lock_screen.xml
 create mode 100644 res/drawable/ic_lock_screen.xml
 create mode 100644 res/layout/dialog_set_wallpaper_row.xml
 create mode 100644 src/com/android/wallpaperpicker/WallpaperListBaseAdapter.java

diff --git a/res/drawable/ic_home_screen.xml b/res/drawable/ic_home_screen.xml
new file mode 100644
index 0000000..83ce733
--- /dev/null
+++ b/res/drawable/ic_home_screen.xml
@@ -0,0 +1,10 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:height="24dp"
+    android:width="24dp"
+    android:viewportWidth="24"
+    android:viewportHeight="24">
+
+    <path
+        android:fillColor="#FFFFFF"
+        android:pathData="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" />
+</vector>
diff --git a/res/drawable/ic_home_screen_and_lock_screen.xml b/res/drawable/ic_home_screen_and_lock_screen.xml
new file mode 100644
index 0000000..152b820
--- /dev/null
+++ b/res/drawable/ic_home_screen_and_lock_screen.xml
@@ -0,0 +1,10 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:height="24dp"
+    android:width="24dp"
+    android:viewportWidth="24"
+    android:viewportHeight="24">
+
+    <path
+        android:fillColor="#FFFFFF"
+        android:pathData="M17,19H7V5H17M17,1H7C5.89,1 5,1.89 5,3V21A2,2 0 0,0 7,23H17A2,2 0 0,0 19,21V3C19,1.89 18.1,1 17,1Z" />
+</vector>
diff --git a/res/drawable/ic_lock_screen.xml b/res/drawable/ic_lock_screen.xml
new file mode 100644
index 0000000..e8e1dcd
--- /dev/null
+++ b/res/drawable/ic_lock_screen.xml
@@ -0,0 +1,10 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:height="24dp"
+    android:width="24dp"
+    android:viewportWidth="24"
+    android:viewportHeight="24">
+
+    <path
+        android:fillColor="#FFFFFF"
+        android:pathData="M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10A2,2 0 0,1 6,8H15V6A3,3 0 0,0 12,3A3,3 0 0,0 9,6H7A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,17A2,2 0 0,0 14,15A2,2 0 0,0 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17Z" />
+</vector>
diff --git a/res/layout/dialog_set_wallpaper_row.xml b/res/layout/dialog_set_wallpaper_row.xml
new file mode 100644
index 0000000..d1a737b
--- /dev/null
+++ b/res/layout/dialog_set_wallpaper_row.xml
@@ -0,0 +1,26 @@
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/item_accent_layout"
+    android:layout_width="match_parent"
+    android:layout_height="48dp"
+    android:focusable="false"
+    android:focusableInTouchMode="false"
+    android:gravity="center_vertical"
+    android:orientation="horizontal"
+    android:paddingHorizontal="16dp"
+    android:paddingVertical="8dp">
+
+    <ImageView
+        android:id="@+id/icon"
+        android:layout_width="32dp"
+        android:layout_height="32dp"
+        android:layout_marginEnd="16dp" />
+
+    <TextView
+        android:id="@+id/destination"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:ellipsize="end"
+        android:maxLines="1"
+        android:textColor="?android:textColorPrimary"
+        android:textSize="18sp" />
+</LinearLayout>
\ No newline at end of file
diff --git a/src/com/android/wallpaperpicker/NoWallpaper.java b/src/com/android/wallpaperpicker/NoWallpaper.java
index bfff899..7971b7f 100644
--- a/src/com/android/wallpaperpicker/NoWallpaper.java
+++ b/src/com/android/wallpaperpicker/NoWallpaper.java
@@ -38,7 +38,7 @@ public class NoWallpaper extends Activity {
         WallpaperManager wm = WallpaperManager.getInstance(this);
         new AlertDialog.Builder(this)
             .setTitle(R.string.wallpaper_instructions)
-            .setItems(R.array.which_wallpaper_options, new DialogInterface.OnClickListener() {
+            .setAdapter(new WallpaperListBaseAdapter(this), new DialogInterface.OnClickListener() {
             @Override
             public void onClick(DialogInterface dialog, int selectedItemIndex) {
                 int whichWallpaper;
diff --git a/src/com/android/wallpaperpicker/WallpaperListBaseAdapter.java b/src/com/android/wallpaperpicker/WallpaperListBaseAdapter.java
new file mode 100644
index 0000000..2a6b53b
--- /dev/null
+++ b/src/com/android/wallpaperpicker/WallpaperListBaseAdapter.java
@@ -0,0 +1,86 @@
+/*
+ * Copyright (C) 2018 The LineageOS Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.wallpaperpicker;
+
+import android.content.Context;
+import android.util.Pair;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.BaseAdapter;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public class WallpaperListBaseAdapter extends BaseAdapter {
+
+    private final Context context;
+
+    private static Pair<Integer, Integer>[] DIALOG_ENTRIES = new Pair[] {
+        new Pair(R.drawable.ic_home_screen, R.string.which_wallpaper_option_home_screen),
+        new Pair(R.drawable.ic_lock_screen, R.string.which_wallpaper_option_lock_screen),
+        new Pair(R.drawable.ic_home_screen_and_lock_screen,
+                R.string.which_wallpaper_option_home_screen_and_lock_screen)
+    };
+
+    private class ViewHolder {
+        private ImageView icon;
+        private TextView destination;
+    }
+
+    public WallpaperListBaseAdapter(Context context) {
+        this.context = context;
+    }
+
+    @Override
+    public View getView(int position, View convertView, ViewGroup parent) {
+        View view = null;
+
+        if (convertView == null) {
+            LayoutInflater inflator = LayoutInflater.from(context);
+            view = inflator.inflate(R.layout.dialog_set_wallpaper_row, null);
+            final ViewHolder viewHolder = new ViewHolder();
+            viewHolder.icon = view.findViewById(R.id.icon);
+            viewHolder.destination = view.findViewById(R.id.destination);
+            view.setTag(viewHolder);
+        } else {
+            view = convertView;
+        }
+
+        ViewHolder holder = (ViewHolder) view.getTag();
+        holder.icon.setImageDrawable(context.getDrawable(DIALOG_ENTRIES[position].first));
+        holder.destination.setText(DIALOG_ENTRIES[position].second);
+        return view;
+    }
+
+    @Override
+    public int getCount() {
+        return DIALOG_ENTRIES.length;
+    }
+
+    @Override
+    public Object getItem(int position) {
+        return null;
+    }
+
+    @Override
+    public long getItemId(int position) {
+        return position;
+    }
+}
diff --git a/src/com/android/wallpaperpicker/common/DialogUtils.java b/src/com/android/wallpaperpicker/common/DialogUtils.java
index 9cd162c..3c39b76 100644
--- a/src/com/android/wallpaperpicker/common/DialogUtils.java
+++ b/src/com/android/wallpaperpicker/common/DialogUtils.java
@@ -7,6 +7,7 @@ import android.content.DialogInterface;
 import android.os.AsyncTask;
 
 import com.android.wallpaperpicker.R;
+import com.android.wallpaperpicker.WallpaperListBaseAdapter;
 
 /**
  * Utility class used to show dialogs for things like picking which wallpaper to set.
@@ -24,7 +25,8 @@ public class DialogUtils {
         if (Utilities.isAtLeastN()) {
             new AlertDialog.Builder(context)
                     .setTitle(R.string.wallpaper_instructions)
-                    .setItems(R.array.which_wallpaper_options, new DialogInterface.OnClickListener() {
+                    .setAdapter(new WallpaperListBaseAdapter(context),
+                            new DialogInterface.OnClickListener() {
                     @Override
                     public void onClick(DialogInterface dialog, int selectedItemIndex) {
                         int whichWallpaper;
-- 
2.17.1

