From 3a818099d6061fc43964bec8463a3124c0f467f5 Mon Sep 17 00:00:00 2001
From: Santhosh Kumar Thimmanna Bhattar <sthim@codeaurora.org>
Date: Tue, 8 May 2018 10:59:13 +0530
Subject: [PATCH 3/4] SnapdragonCamera: Fix compilation issues for AOSP upgrade

Fixed compilation issues for AOSP upgrade.

Change-Id: I10db85d552a6aa45798e3f4b98ff8516c5d8b0ab
---
 jni/Android.mk                       | 6 +++---
 jni/feature_mos/src/mosaic/Blend.cpp | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/jni/Android.mk b/jni/Android.mk
index 2aa572aab..3e19221ef 100644
--- a/jni/Android.mk
+++ b/jni/Android.mk
@@ -9,7 +9,7 @@ LOCAL_C_INCLUDES := \
         $(LOCAL_PATH)/feature_mos/src \
         $(LOCAL_PATH)/feature_mos/src/mosaic
 
-LOCAL_CFLAGS := -O3 -DNDEBUG -fstrict-aliasing -Wno-unused-parameter
+LOCAL_CFLAGS := -O3 -DNDEBUG -fstrict-aliasing -Wno-unused-variable -Wno-unused-parameter -Wno-unused-private-field -Wno-unused-function -Wno-self-assign
 
 LOCAL_SRC_FILES := \
         feature_mos_jni.cpp \
@@ -58,7 +58,7 @@ LOCAL_SDK_VERSION := 9
 LOCAL_MODULE    := libjni_snaptinyplanet
 LOCAL_SRC_FILES := tinyplanet.cc
 
-LOCAL_CFLAGS := -ffast-math -O3 -funroll-loops -Wno-unused-parameter
+LOCAL_CFLAGS    += -ffast-math -O3 -funroll-loops -Wno-unused-variable -Wno-unused-parameter
 LOCAL_ARM_MODE := arm
 
 include $(BUILD_SHARED_LIBRARY)
@@ -70,6 +70,6 @@ LOCAL_SDK_VERSION := 9
 LOCAL_MODULE    := libjni_snapimageutil
 LOCAL_MODULE_TAGS := optional
 LOCAL_SRC_FILES := image_util_jni.cpp
-LOCAL_CFLAGS    += -ffast-math -O3 -funroll-loops -Wno-unused-parameter
+LOCAL_CFLAGS    += -ffast-math -O3 -funroll-loops -Wno-unused-variable -Wno-unused-parameter
 include $(BUILD_SHARED_LIBRARY)
 
diff --git a/jni/feature_mos/src/mosaic/Blend.cpp b/jni/feature_mos/src/mosaic/Blend.cpp
index 9ee194ab2..ebbd4f623 100644
--- a/jni/feature_mos/src/mosaic/Blend.cpp
+++ b/jni/feature_mos/src/mosaic/Blend.cpp
@@ -1329,7 +1329,7 @@ void Blend::ComputeBlendParameters(MosaicFrame **frames, int frames_size, int is
         double dy = prevY - firstY;
 
         // If the mosaic was captured by sweeping horizontally
-        if (abs(lxpos - fxpos) > abs(lypos - fypos))
+        if (fabs(lxpos - fxpos) > fabs(lypos - fypos))
         {
             m_wb.horizontal = 1;
             // Calculate radius position to make ends exactly the same Y offset
-- 
2.17.1

