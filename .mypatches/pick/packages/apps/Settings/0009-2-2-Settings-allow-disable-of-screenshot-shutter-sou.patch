From e80cb183c6a652597a1c5f8690421f58517926ce Mon Sep 17 00:00:00 2001
From: maxwen <max.weninger@gmail.com>
Date: Sun, 29 Mar 2015 18:38:36 +0200
Subject: [PATCH 09/12] [2/2] Settings: allow disable of screenshot shutter
 sound

Change-Id: Ie69f44a3b7db3bf3c9a5c098bca43568e1099283
---
 res/values/cm_strings.xml                     |  3 ++
 res/xml/sound_settings.xml                    |  5 +++
 .../ScreenshotSoundPreferenceController.java  | 38 +++++++++++++++++++
 .../settings/notification/SoundSettings.java  |  1 +
 4 files changed, 47 insertions(+)
 create mode 100644 src/com/android/settings/notification/ScreenshotSoundPreferenceController.java

diff --git a/res/values/cm_strings.xml b/res/values/cm_strings.xml
index 7d14568e18..cdd13b9818 100644
--- a/res/values/cm_strings.xml
+++ b/res/values/cm_strings.xml
@@ -380,4 +380,7 @@
     <string name="phone_number_hint">Set phone number</string>
     <string name="set_phone_number_failed">Setting phone number failed</string>
     <string name="msisdn_alpha_tag" translatable="false">Voice Line 1</string>
+
+    <!-- Screenshot shutter sound -->
+    <string name="screenshot_shutter_sound_title">Screenshot shutter sound</string>
 </resources>
diff --git a/res/xml/sound_settings.xml b/res/xml/sound_settings.xml
index dc9a15c51a..6570db7e92 100644
--- a/res/xml/sound_settings.xml
+++ b/res/xml/sound_settings.xml
@@ -170,6 +170,11 @@
           android:key="emergency_tone"
           android:title="@string/emergency_tone_title"
           android:summary="%s" />
+
+        <!-- Screenshot sound -->
+        <SwitchPreference
+            android:key="screenshot_shutter_sound"
+            android:title="@string/screenshot_shutter_sound_title" />
     </PreferenceCategory>
 
     <com.android.settingslib.RestrictedPreference
diff --git a/src/com/android/settings/notification/ScreenshotSoundPreferenceController.java b/src/com/android/settings/notification/ScreenshotSoundPreferenceController.java
new file mode 100644
index 0000000000..0df38bc422
--- /dev/null
+++ b/src/com/android/settings/notification/ScreenshotSoundPreferenceController.java
@@ -0,0 +1,38 @@
+/*
+ * Copyright (C) 2017 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.settings.notification;
+
+import static com.android.settings.notification.SettingPref.TYPE_SYSTEM;
+
+import android.content.Context;
+
+import android.provider.Settings.System;
+import com.android.settings.SettingsPreferenceFragment;
+import com.android.settingslib.core.lifecycle.Lifecycle;
+
+public class ScreenshotSoundPreferenceController extends SettingPrefController {
+
+    private static final String KEY_SCREENSHOT_SOUNDS = "screenshot_shutter_sound";
+
+    public ScreenshotSoundPreferenceController(Context context, SettingsPreferenceFragment parent,
+            Lifecycle lifecycle) {
+        super(context, parent, lifecycle);
+        mPreference = new SettingPref(
+            TYPE_SYSTEM, KEY_SCREENSHOT_SOUNDS, System.SCREENSHOT_SHUTTER_SOUND, DEFAULT_ON);
+    }
+
+}
diff --git a/src/com/android/settings/notification/SoundSettings.java b/src/com/android/settings/notification/SoundSettings.java
index 5e5223d3a8..e4c7e4cac3 100644
--- a/src/com/android/settings/notification/SoundSettings.java
+++ b/src/com/android/settings/notification/SoundSettings.java
@@ -248,6 +248,7 @@ public class SoundSettings extends DashboardFragment {
         controllers.add(new DockAudioMediaPreferenceController(context, fragment, lifecycle));
         controllers.add(new BootSoundPreferenceController(context));
         controllers.add(new EmergencyTonePreferenceController(context, fragment, lifecycle));
+        controllers.add(new ScreenshotSoundPreferenceController(context, fragment, lifecycle));
 
         return controllers;
     }
-- 
2.17.1

