From bd0c74caab940877b2d2df70b7de637602ba73a6 Mon Sep 17 00:00:00 2001
From: Joey <joey@lineageos.org>
Date: Thu, 12 Apr 2018 14:10:07 +0200
Subject: [PATCH 07/19] Settings: show Trust brading in confirm_lock_password
 UI

Change-Id: Ia6920991c37e7bfc20561cf24b3cb8224961b687
Signed-off-by: Joey <joey@lineageos.org>
---
 res/drawable/ic_trust.xml                     | 27 +++++++++++++++++++
 res/layout/confirm_lock_password_base.xml     | 27 ++++++++++++++-----
 res/layout/confirm_lock_password_normal.xml   | 21 ++++++++++++---
 .../password/ConfirmLockPassword.java         |  5 ++++
 4 files changed, 69 insertions(+), 11 deletions(-)
 create mode 100644 res/drawable/ic_trust.xml

diff --git a/res/drawable/ic_trust.xml b/res/drawable/ic_trust.xml
new file mode 100644
index 0000000000..3cd77af629
--- /dev/null
+++ b/res/drawable/ic_trust.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2018 The LineageOS Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="24"
+    android:viewportHeight="24"
+    android:tint="?android:attr/colorControlNormal">
+
+    <path
+        android:fillColor="@android:color/white"
+        android:pathData="M5,3L19,3C20.105,3 21,3.895 21,5L21,12C21,16.971 16.971,21 12,21C7.029,21 3,16.971 3,12L3,5C3,3.895 3.895,3 5,3ZM18.902,13.168C18.994,12.624 18.627,12.108 18.082,12.016C17.538,11.925 17.022,12.292 16.93,12.837C16.528,15.225 14.45,17 12,17C9.55,17 7.472,15.226 7.069,12.838C6.978,12.294 6.462,11.927 5.917,12.018C5.373,12.11 5.005,12.626 5.097,13.171C5.661,16.517 8.57,19 12,19C15.43,19 18.339,16.516 18.902,13.168ZM11.046,5.698L9.127,11.297C9.045,11.516 9,11.753 9,12C9,13.104 9.895,14 11,14C11.01,14 11.019,14 11.029,14L13,14C13.55,14 14.05,13.78 14.41,13.41C14.78,13.05 15,12.55 15,12L12.6,12L11,11.999L11.438,10.724L11.646,10.116L12.938,6.346C12.978,6.238 13,6.121 13,6C13,5.448 12.552,5 12,5C11.553,5 11.174,5.293 11.046,5.698Z" />
+</vector>
\ No newline at end of file
diff --git a/res/layout/confirm_lock_password_base.xml b/res/layout/confirm_lock_password_base.xml
index 05e90d223d..e0c589dd0a 100644
--- a/res/layout/confirm_lock_password_base.xml
+++ b/res/layout/confirm_lock_password_base.xml
@@ -30,15 +30,28 @@
         android:layout_gravity="top|center_horizontal"
         android:paddingTop="@dimen/confirm_credentials_top_padding">
 
-        <TextView
-            style="@android:style/TextAppearance.Material.Headline"
-            android:id="@+id/headerText"
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="horizontal"
             android:layout_marginStart="?attr/confirmDeviceCredentialsSideMargin"
             android:layout_marginEnd="?attr/confirmDeviceCredentialsSideMargin"
-            android:layout_marginTop="?attr/confirmDeviceCredentialsTopMargin"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
-            android:textColor="?android:attr/colorAccent"/>
+            android:layout_marginTop="?attr/confirmDeviceCredentialsTopMargin">
+
+            <ImageView
+                android:id="@+id/confirm_lock_trust"
+                android:src="@drawable/ic_trust"
+                android:layout_marginEnd="16dp"
+                android:layout_width="48dp"
+                android:layout_height="48dp" />
+
+            <TextView
+                style="@android:style/TextAppearance.Material.Headline"
+                android:id="@+id/headerText"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:textColor="?android:attr/colorAccent"/>
+        </LinearLayout>
 
         <TextView
             style="@android:style/TextAppearance.Material.Body1"
diff --git a/res/layout/confirm_lock_password_normal.xml b/res/layout/confirm_lock_password_normal.xml
index 05bd4a059c..2bebce410e 100644
--- a/res/layout/confirm_lock_password_normal.xml
+++ b/res/layout/confirm_lock_password_normal.xml
@@ -27,13 +27,26 @@
         android:layout_width="match_parent"
         android:layout_height="match_parent">
 
-        <TextView
-            android:id="@+id/detailsText"
-            style="@style/SuwDescription.Glif"
+        <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
+            android:orientation="horizontal"
             android:layout_marginStart="?attr/suwMarginSides"
-            android:layout_marginEnd="?attr/suwMarginSides" />
+            android:layout_marginEnd="?attr/suwMarginSides">
+
+            <ImageView
+                android:id="@+id/confirm_lock_trust"
+                android:src="@drawable/ic_trust"
+                android:layout_marginEnd="16dp"
+                android:layout_width="48dp"
+                android:layout_height="48dp" />
+
+            <TextView
+                android:id="@+id/detailsText"
+                style="@style/SuwDescription.Glif"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content" />
+        </LinearLayout>
 
         <Space
             android:layout_width="match_parent"
diff --git a/src/com/android/settings/password/ConfirmLockPassword.java b/src/com/android/settings/password/ConfirmLockPassword.java
index a7059da9ea..46308d9345 100644
--- a/src/com/android/settings/password/ConfirmLockPassword.java
+++ b/src/com/android/settings/password/ConfirmLockPassword.java
@@ -37,6 +37,7 @@ import android.view.ViewGroup;
 import android.view.animation.AnimationUtils;
 import android.view.inputmethod.EditorInfo;
 import android.view.inputmethod.InputMethodManager;
+import android.widget.ImageView;
 import android.widget.TextView;
 import android.widget.TextView.OnEditorActionListener;
 
@@ -99,6 +100,7 @@ public class ConfirmLockPassword extends ConfirmDeviceCredentialBaseActivity {
         private AsyncTask<?, ?, ?> mPendingLockCheck;
         private CredentialCheckResultTracker mCredentialCheckResultTracker;
         private boolean mDisappearing = false;
+        private ImageView mTrustIconView;
         private TextView mHeaderTextView;
         private TextView mDetailsTextView;
         private CountDownTimer mCountdownTimer;
@@ -137,6 +139,7 @@ public class ConfirmLockPassword extends ConfirmDeviceCredentialBaseActivity {
             if (mHeaderTextView == null) {
                 mHeaderTextView = view.findViewById(R.id.suw_layout_title);
             }
+            mTrustIconView = view.findViewById(R.id.confirm_lock_trust);
             mDetailsTextView = (TextView) view.findViewById(R.id.detailsText);
             mErrorTextView = (TextView) view.findViewById(R.id.errorText);
             mIsAlpha = DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC == storedQuality
@@ -238,6 +241,7 @@ public class ConfirmLockPassword extends ConfirmDeviceCredentialBaseActivity {
         public void prepareEnterAnimation() {
             super.prepareEnterAnimation();
             mHeaderTextView.setAlpha(0f);
+            mTrustIconView.setAlpha(0f);
             mDetailsTextView.setAlpha(0f);
             mCancelButton.setAlpha(0f);
             mPasswordEntry.setAlpha(0f);
@@ -248,6 +252,7 @@ public class ConfirmLockPassword extends ConfirmDeviceCredentialBaseActivity {
         private View[] getActiveViews() {
             ArrayList<View> result = new ArrayList<>();
             result.add(mHeaderTextView);
+            result.add(mTrustIconView);
             result.add(mDetailsTextView);
             if (mCancelButton.getVisibility() == View.VISIBLE) {
                 result.add(mCancelButton);
-- 
2.17.1

