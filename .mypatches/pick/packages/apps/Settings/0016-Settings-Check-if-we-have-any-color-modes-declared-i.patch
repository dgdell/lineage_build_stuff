From c5a8372adb0d5a11f2a892d7e777de82ce1d01f9 Mon Sep 17 00:00:00 2001
From: Luca Stefani <luca.stefani.ge1@gmail.com>
Date: Fri, 12 Oct 2018 21:49:35 +0200
Subject: [PATCH 16/19] Settings: Check if we have any color modes declared in
 overlay

* Checking for wide gamut support isn't always enough

Change-Id: Ic7257e37f2eca97450eaf0ca1e330de7596352be
---
 .../settings/display/ColorModePreferenceController.java        | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/com/android/settings/display/ColorModePreferenceController.java b/src/com/android/settings/display/ColorModePreferenceController.java
index ebb4370098..34bfae0b37 100644
--- a/src/com/android/settings/display/ColorModePreferenceController.java
+++ b/src/com/android/settings/display/ColorModePreferenceController.java
@@ -41,7 +41,10 @@ public class ColorModePreferenceController extends BasePreferenceController {
 
     @Override
     public int getAvailabilityStatus() {
+        final int[] availableColorModes = mContext.getResources().getIntArray(
+                com.android.internal.R.array.config_availableColorModes);
         return mConfigWrapper.isScreenWideColorGamut()
+                && availableColorModes.length > 0
                 && !getColorDisplayController().getAccessibilityTransformActivated() ?
                 AVAILABLE : DISABLED_FOR_USER;
     }
-- 
2.17.1

