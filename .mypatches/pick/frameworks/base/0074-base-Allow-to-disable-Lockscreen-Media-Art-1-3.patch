From f9293afcc21594fefcc0ea791ff87ad990ef6858 Mon Sep 17 00:00:00 2001
From: beanstown106 <nbenis106@gmail.com>
Date: Fri, 23 Oct 2015 21:07:35 -0400
Subject: [PATCH 74/80] base: Allow to disable Lockscreen Media Art [1/3]

Change-Id: Id93e115649df5d6dc680101a8c852644b217c28a
---
 .../com/android/systemui/statusbar/phone/StatusBar.java   | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/packages/SystemUI/src/com/android/systemui/statusbar/phone/StatusBar.java b/packages/SystemUI/src/com/android/systemui/statusbar/phone/StatusBar.java
index 0b0480b572e..f3a4dbed41c 100644
--- a/packages/SystemUI/src/com/android/systemui/statusbar/phone/StatusBar.java
+++ b/packages/SystemUI/src/com/android/systemui/statusbar/phone/StatusBar.java
@@ -287,6 +287,8 @@ public class StatusBar extends SystemUI implements DemoMode, Tunable,
             "system:" + Settings.System.SCREEN_BRIGHTNESS_MODE;
     private static final String STATUS_BAR_BRIGHTNESS_CONTROL =
             "lineagesystem:" + LineageSettings.System.STATUS_BAR_BRIGHTNESS_CONTROL;
+    private static final String LOCKSCREEN_MEDIA_METADATA =
+            "lineagesecure:" + LineageSettings.Secure.LOCKSCREEN_MEDIA_METADATA;
 
     private static final String BANNER_ACTION_CANCEL =
             "com.android.systemui.statusbar.banner_action_cancel";
@@ -603,6 +605,7 @@ public class StatusBar extends SystemUI implements DemoMode, Tunable,
     private VisualizerView mVisualizerView;
     private boolean mScreenOn;
     private boolean mKeyguardShowingMedia;
+    private boolean mShowMediaMetadata;
 
     private BroadcastReceiver mWallpaperChangedReceiver = new BroadcastReceiver() {
         @Override
@@ -751,6 +754,7 @@ public class StatusBar extends SystemUI implements DemoMode, Tunable,
         final TunerService tunerService = Dependency.get(TunerService.class);
         tunerService.addTunable(this, SCREEN_BRIGHTNESS_MODE);
         tunerService.addTunable(this, STATUS_BAR_BRIGHTNESS_CONTROL);
+        tunerService.addTunable(this, LOCKSCREEN_MEDIA_METADATA);
 
         mDisplayManager = mContext.getSystemService(DisplayManager.class);
 
@@ -1748,7 +1752,7 @@ public class StatusBar extends SystemUI implements DemoMode, Tunable,
         }
 
         Drawable artworkDrawable = null;
-        if (mediaMetadata != null) {
+        if (mediaMetadata != null && mShowMediaMetadata) {
             Bitmap artworkBitmap = mediaMetadata.getBitmap(MediaMetadata.METADATA_KEY_ART);
             if (artworkBitmap == null) {
                 artworkBitmap = mediaMetadata.getBitmap(MediaMetadata.METADATA_KEY_ALBUM_ART);
@@ -5893,6 +5897,8 @@ public class StatusBar extends SystemUI implements DemoMode, Tunable,
                     == Settings.System.SCREEN_BRIGHTNESS_MODE_AUTOMATIC;
         } else if (STATUS_BAR_BRIGHTNESS_CONTROL.equals(key)) {
             mBrightnessControl = newValue != null && Integer.parseInt(newValue) == 1;
+        } else if (LOCKSCREEN_MEDIA_METADATA.equals(key)) {
+            mShowMediaMetadata = newValue == null || Integer.parseInt(newValue) == 1;
         }
     }
     // End Extra BaseStatusBarMethods.
-- 
2.17.1

