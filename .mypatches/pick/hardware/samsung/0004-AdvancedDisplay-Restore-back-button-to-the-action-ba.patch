From e940dc6fdcf747aff84532d1e9adcf678354c6b4 Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Thu, 28 Dec 2017 02:24:44 +0100
Subject: [PATCH 4/4] AdvancedDisplay: Restore back button to the action bar

Change-Id: I7ae2d1ccbb0a55fc28c31d4791aaae1169b8221f
---
 .../lineageos/settings/device/AdvancedDisplayFragment.java | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/AdvancedDisplay/src/org/lineageos/settings/device/AdvancedDisplayFragment.java b/AdvancedDisplay/src/org/lineageos/settings/device/AdvancedDisplayFragment.java
index 6d4c534..7046e30 100644
--- a/AdvancedDisplay/src/org/lineageos/settings/device/AdvancedDisplayFragment.java
+++ b/AdvancedDisplay/src/org/lineageos/settings/device/AdvancedDisplayFragment.java
@@ -16,9 +16,11 @@
 
 package org.lineageos.settings.device;
 
+import android.app.ActionBar;
 import android.content.res.Resources;
 import android.os.Bundle;
 import android.support.v14.preference.PreferenceFragment;
+import android.view.MenuItem;
 
 import org.lineageos.settings.device.R;
 
@@ -33,6 +35,9 @@ public class AdvancedDisplayFragment extends PreferenceFragment {
         addPreferencesFromResource(R.xml.screen_preferences);
         Resources res = getResources();
 
+        final ActionBar actionBar = getActivity().getActionBar();
+        actionBar.setDisplayHomeAsUpEnabled(true);
+
         /* mDNIe */
         mmDNIeScenario = (mDNIeScenario) findPreference(Constants.KEY_MDNIE_SCENARIO);
         mmDNIeScenario.setEnabled(
@@ -42,4 +47,13 @@ public class AdvancedDisplayFragment extends PreferenceFragment {
         mmDNIeNegative.setEnabled(
                 FileUtils.isFileWritable(res.getString(R.string.mdnie_negative_sysfs_file)));
     }
+
+    @Override
+    public boolean onOptionsItemSelected(MenuItem item) {
+        if (item.getItemId() == android.R.id.home) {
+            getActivity().onBackPressed();
+            return true;
+        }
+        return false;
+    }
 }
-- 
2.7.4

