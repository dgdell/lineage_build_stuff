From d8d04fd4972165e2d9de0c2f0549dbb1d722cbe7 Mon Sep 17 00:00:00 2001
From: "Christopher N. Hesse" <raymanfx@gmail.com>
Date: Sun, 28 Jan 2018 00:07:47 +0100
Subject: [PATCH 02/35] audio: Support new and old mixer paths locations

Change-Id: Ifa2a55cbfe45ab9d53cd23098012443f9b32ca31
---
 audio/audio_hw.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/audio/audio_hw.c b/audio/audio_hw.c
index bd15634..54ae924 100644
--- a/audio/audio_hw.c
+++ b/audio/audio_hw.c
@@ -539,10 +539,15 @@ static int mixer_init(struct audio_device *adev)
                 }
             } while (mixer == NULL);
 
-            sprintf(mixer_path, "/system/etc/mixer_paths_%d.xml", card);
+            sprintf(mixer_path, "/vendor/etc/mixer_paths_%d.xml", card);
             if (access(mixer_path, F_OK) == -1) {
-                ALOGE("%s: Failed to load mixer paths from %s, your system is going to crash",
+                ALOGW("%s: Failed to open mixer paths from %s, retrying with legacy location",
                       __func__, mixer_path);
+                sprintf(mixer_path, "/system/etc/mixer_paths_%d.xml", card);
+                if (access(mixer_path, F_OK) == -1) {
+                    ALOGE("%s: Failed to load a mixer paths configuration, your system will crash",
+                          __func__);
+                }
             }
 
             audio_route = audio_route_init(card, mixer_path);
-- 
2.17.1

