From c2e306912a4356a5c50494e9ec3a5d3953058b33 Mon Sep 17 00:00:00 2001
From: Pierre Couillaud <pierre@broadcom.com>
Date: Fri, 16 Feb 2018 04:44:23 -0800
Subject: [PATCH] wlan:bcmdhd: fixup build errors when building the library
 under vndk.

Bug: 73344227
Change-Id: Icd91d00c32f77e430b612efdea4d2cbd74a84d09
Signed-off-by: Pierre Couillaud <pierre@broadcom.com>
---
 bcmdhd/wifi_hal/Android.mk             | 2 ++
 bcmdhd/wifi_hal/common.h               | 2 +-
 bcmdhd/wifi_hal/gscan.cpp              | 2 +-
 bcmdhd/wifi_hal/link_layer_stats.cpp   | 2 +-
 bcmdhd/wifi_hal/rtt.cpp                | 2 +-
 bcmdhd/wifi_hal/wifi_hal.cpp           | 2 +-
 bcmdhd/wpa_supplicant_8_lib/Android.mk | 1 +
 7 files changed, 8 insertions(+), 5 deletions(-)

diff --git a/bcmdhd/wifi_hal/Android.mk b/bcmdhd/wifi_hal/Android.mk
index 9e4ed08..2398462 100644
--- a/bcmdhd/wifi_hal/Android.mk
+++ b/bcmdhd/wifi_hal/Android.mk
@@ -25,6 +25,8 @@ LOCAL_C_INCLUDES += \
 	$(call include-path-for, libhardware_legacy)/hardware_legacy \
 	external/wpa_supplicant_8/src/drivers
 
+LOCAL_HEADER_LIBRARIES := libutils_headers liblog_headers
+
 LOCAL_SRC_FILES := \
 	wifi_hal.cpp \
 	rtt.cpp \
diff --git a/bcmdhd/wifi_hal/common.h b/bcmdhd/wifi_hal/common.h
index 2967c97..4451cb6 100644
--- a/bcmdhd/wifi_hal/common.h
+++ b/bcmdhd/wifi_hal/common.h
@@ -6,7 +6,7 @@
 
 #define LOG_TAG  "WifiHAL"
 
-#include <utils/Log.h>
+#include <log/log.h>
 #include "nl80211_copy.h"
 #include "sync.h"
 
diff --git a/bcmdhd/wifi_hal/gscan.cpp b/bcmdhd/wifi_hal/gscan.cpp
index d3dc0e7..82bc2f7 100644
--- a/bcmdhd/wifi_hal/gscan.cpp
+++ b/bcmdhd/wifi_hal/gscan.cpp
@@ -21,7 +21,7 @@
 #define LOG_TAG  "WifiHAL"
 //#define LOG_NDEBUG 0         //uncomment to enable verbose logging
 
-#include <utils/Log.h>
+#include <log/log.h>
 
 #include "wifi_hal.h"
 #include "common.h"
diff --git a/bcmdhd/wifi_hal/link_layer_stats.cpp b/bcmdhd/wifi_hal/link_layer_stats.cpp
index f6d6ab5..e205df9 100644
--- a/bcmdhd/wifi_hal/link_layer_stats.cpp
+++ b/bcmdhd/wifi_hal/link_layer_stats.cpp
@@ -20,7 +20,7 @@
 
 #define LOG_TAG  "WifiHAL"
 
-#include <utils/Log.h>
+#include <log/log.h>
 
 #include "wifi_hal.h"
 #include "common.h"
diff --git a/bcmdhd/wifi_hal/rtt.cpp b/bcmdhd/wifi_hal/rtt.cpp
index cc46a8d..253f9d7 100644
--- a/bcmdhd/wifi_hal/rtt.cpp
+++ b/bcmdhd/wifi_hal/rtt.cpp
@@ -22,7 +22,7 @@
 
 #define LOG_TAG  "WifiHAL"
 
-#include <utils/Log.h>
+#include <log/log.h>
 #include <utils/String8.h>
 
 #include "wifi_hal.h"
diff --git a/bcmdhd/wifi_hal/wifi_hal.cpp b/bcmdhd/wifi_hal/wifi_hal.cpp
index db6f87c..2a4bf23 100644
--- a/bcmdhd/wifi_hal/wifi_hal.cpp
+++ b/bcmdhd/wifi_hal/wifi_hal.cpp
@@ -25,7 +25,7 @@
 
 #define LOG_TAG  "WifiHAL"
 
-#include <utils/Log.h>
+#include <log/log.h>
 
 #include "wifi_hal.h"
 #include "common.h"
diff --git a/bcmdhd/wpa_supplicant_8_lib/Android.mk b/bcmdhd/wpa_supplicant_8_lib/Android.mk
index c1d3c34..5dc4c9f 100644
--- a/bcmdhd/wpa_supplicant_8_lib/Android.mk
+++ b/bcmdhd/wpa_supplicant_8_lib/Android.mk
@@ -68,6 +68,7 @@ LOCAL_SHARED_LIBRARIES := libc libcutils
 LOCAL_CFLAGS := $(L_CFLAGS)
 LOCAL_SRC_FILES := $(WPA_SRC_FILE)
 LOCAL_C_INCLUDES := $(WPA_SUPPL_DIR_INCLUDE)
+LOCAL_VENDOR_MODULE := true
 include $(BUILD_STATIC_LIBRARY)
 
 ########################
-- 
2.17.0

