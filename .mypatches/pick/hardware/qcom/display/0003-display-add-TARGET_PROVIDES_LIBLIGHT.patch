From 0916ebcc941aabc43a26515370f82a6212c924ad Mon Sep 17 00:00:00 2001
From: Giulio Cervera <giulio.cervera@cyanogenmod.org>
Date: Tue, 21 Jan 2014 23:06:45 +0100
Subject: [PATCH 3/8] display: add TARGET_PROVIDES_LIBLIGHT

Change-Id: I9388f3582d74b4b569e2807e4ec6177dc50f38d0
---
 msm8084/Android.mk | 6 +++++-
 msm8226/Android.mk | 6 +++++-
 msm8909/Android.mk | 6 +++++-
 msm8960/Android.mk | 6 +++++-
 msm8974/Android.mk | 6 +++++-
 msm8994/Android.mk | 5 ++++-
 msm8996/Android.mk | 5 ++++-
 msm8998/Android.mk | 5 ++++-
 8 files changed, 37 insertions(+), 8 deletions(-)

diff --git a/msm8084/Android.mk b/msm8084/Android.mk
index 59a97517a..e846895a3 100644
--- a/msm8084/Android.mk
+++ b/msm8084/Android.mk
@@ -1,6 +1,10 @@
-display-hals := libgralloc libcopybit liblight libvirtual
+display-hals := libgralloc libcopybit libvirtual
 display-hals += libhwcomposer liboverlay libqdutils libexternal libqservice
 display-hals += libmemtrack
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
+
 ifeq ($(call is-vendor-board-platform,QCOM),true)
     include $(call all-named-subdir-makefiles,$(display-hals))
 else
diff --git a/msm8226/Android.mk b/msm8226/Android.mk
index 59a97517a..e846895a3 100644
--- a/msm8226/Android.mk
+++ b/msm8226/Android.mk
@@ -1,6 +1,10 @@
-display-hals := libgralloc libcopybit liblight libvirtual
+display-hals := libgralloc libcopybit libvirtual
 display-hals += libhwcomposer liboverlay libqdutils libexternal libqservice
 display-hals += libmemtrack
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
+
 ifeq ($(call is-vendor-board-platform,QCOM),true)
     include $(call all-named-subdir-makefiles,$(display-hals))
 else
diff --git a/msm8909/Android.mk b/msm8909/Android.mk
index f354caf59..b374fa631 100644
--- a/msm8909/Android.mk
+++ b/msm8909/Android.mk
@@ -2,12 +2,16 @@ sdm-libs := sdm/libs
 display-hals := include $(sdm-libs)/utils $(sdm-libs)/core
 
 ifneq ($(TARGET_IS_HEADLESS), true)
-    display-hals += libcopybit liblight libmemtrack hdmi_cec \
+    display-hals += libcopybit libmemtrack hdmi_cec \
                     $(sdm-libs)/hwc $(sdm-libs)/hwc2 gpu_tonemapper libdrmutils libdisplayconfig
 endif
 
 display-hals += gralloc
 
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
+
 ifeq ($(call is-vendor-board-platform,QCOM),true)
     include $(call all-named-subdir-makefiles,$(display-hals))
 else
diff --git a/msm8960/Android.mk b/msm8960/Android.mk
index 13a00545a..a50650ec8 100644
--- a/msm8960/Android.mk
+++ b/msm8960/Android.mk
@@ -1,6 +1,10 @@
-display-hals := libgralloc libgenlock libcopybit liblight
+display-hals := libgralloc libgenlock libcopybit
 display-hals += libhwcomposer liboverlay libqdutils libexternal libqservice
 display-hals += libmemtrack
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
+
 ifeq ($(call is-vendor-board-platform,QCOM),true)
     include $(call all-named-subdir-makefiles,$(display-hals))
 else
diff --git a/msm8974/Android.mk b/msm8974/Android.mk
index 9deff2970..16bd690f1 100644
--- a/msm8974/Android.mk
+++ b/msm8974/Android.mk
@@ -1,6 +1,10 @@
-display-hals := libgralloc libgenlock libcopybit liblight
+display-hals := libgralloc libgenlock libcopybit
 display-hals += libhwcomposer liboverlay libqdutils libexternal libqservice
 display-hals += libmemtrack
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
+
 ifeq ($(call is-vendor-board-platform,QCOM),true)
     include $(call all-named-subdir-makefiles,$(display-hals))
 else
diff --git a/msm8994/Android.mk b/msm8994/Android.mk
index a0644d7b1..e14cc6327 100644
--- a/msm8994/Android.mk
+++ b/msm8994/Android.mk
@@ -1,5 +1,8 @@
-display-hals := libgralloc libcopybit liblight libmemtrack libqservice
+display-hals := libgralloc libcopybit libmemtrack libqservice
 display-hals += libhwcomposer liboverlay libqdutils libhdmi
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
 
 ifeq ($(call is-vendor-board-platform,QCOM),true)
     include $(call all-named-subdir-makefiles,$(display-hals))
diff --git a/msm8996/Android.mk b/msm8996/Android.mk
index b5961ad0c..aedfc5cfa 100644
--- a/msm8996/Android.mk
+++ b/msm8996/Android.mk
@@ -1,9 +1,12 @@
-display-hals := libcopybit liblight libmemtrack libqservice libqdutils
+display-hals := libcopybit libmemtrack libqservice libqdutils
 ifneq ($(TARGET_USES_GRALLOC1), true)
     display-hals += libgralloc
 else
     display-hals += libgralloc1
 endif
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
 
 display-hals += hdmi_cec
 sdm-libs := sdm/libs
diff --git a/msm8998/Android.mk b/msm8998/Android.mk
index 30ab70fc7..85048c14d 100644
--- a/msm8998/Android.mk
+++ b/msm8998/Android.mk
@@ -2,8 +2,11 @@ sdm-libs := sdm/libs
 display-hals := include libqservice libqdutils $(sdm-libs)/utils $(sdm-libs)/core
 
 ifneq ($(TARGET_IS_HEADLESS), true)
-    display-hals += libcopybit liblight libmemtrack hdmi_cec \
+    display-hals += libcopybit libmemtrack hdmi_cec \
                     $(sdm-libs)/hwc2 gpu_tonemapper libdrmutils
+ifneq ($(TARGET_PROVIDES_LIBLIGHT),true)
+    display-hals += liblight
+endif
 endif
 
 display-hals += libgralloc1
-- 
2.17.1

