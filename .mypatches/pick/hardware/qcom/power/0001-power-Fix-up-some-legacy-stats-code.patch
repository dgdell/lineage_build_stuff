From 3ee201a674ae89cc6900a7480ab4c1ba364bc4c9 Mon Sep 17 00:00:00 2001
From: Rashed Abdel-Tawab <rashed@linux.com>
Date: Tue, 9 Jan 2018 20:31:32 -0500
Subject: [PATCH] power: Fix up some legacy stats code

Change-Id: I199193b9418238b98246230a2d08f1011eb27192
---
 power-helper.c | 13 ++++++++++---
 power-helper.h | 10 ++++++++++
 2 files changed, 20 insertions(+), 3 deletions(-)

diff --git a/power-helper.c b/power-helper.c
index 61ed2ab..c7aaf79 100644
--- a/power-helper.c
+++ b/power-helper.c
@@ -103,8 +103,15 @@ static const char *rpm_master_param_names[] = {
     "xo_accumulated_duration",
     "xo_count"
 };
+
+static const char *wlan_param_names[] = {
+    "cumulative_sleep_time_ms",
+    "cumulative_total_on_time_ms",
+    "deep_sleep_enter_counter",
+    "last_deep_sleep_enter_tstamp_ms"
+};
 #else
-/* Use these stats on nougat and forward */
+/* Use these stats on nougat kernels and forward */
 const char *rpm_stat_params[MAX_RPM_PARAMS] = {
     "count",
     "actual last sleep(msec)",
@@ -660,9 +667,9 @@ int extract_platform_stats(uint64_t *list) {
 #ifndef V1_0_HAL
 int extract_wlan_stats(uint64_t *list) {
     int ret;
-    ret = extract_stats(list, WLAN_POWER_STAT, wlan_param_names, WLAN_PARAM_COUNT, false);
+    ret = extract_stats(list, WLAN_POWER_STAT, wlan_param_names, WLAN_POWER_PARAMS_COUNT, false);
     if (ret) {
-        for (size_t i=0; i < WLAN_PARAM_COUNT; i++)
+        for (size_t i=0; i < WLAN_POWER_PARAMS_COUNT; i++)
             list[i] = 0;
     }
     return 0;
diff --git a/power-helper.h b/power-helper.h
index 3d22353..3902a8d 100644
--- a/power-helper.h
+++ b/power-helper.h
@@ -106,6 +106,16 @@ enum wlan_power_params {
 };
 #endif
 
+enum voter_id {
+    APSS,
+    MPSS,
+    ADSP,
+    SLPI,
+
+    //Don't add any lines after that line
+    VOTER_COUNT
+};
+
 #define PLATFORM_SLEEP_MODES_COUNT RPM_MODE_MAX
 
 #define MAX_RPM_PARAMS 2
-- 
2.7.4

