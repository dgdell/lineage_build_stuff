From 1074282688a25dd2ac8c9c6b86c5dec2791178c9 Mon Sep 17 00:00:00 2001
From: Georg Veichtlbauer <georg.veichtlbauer@gmail.com>
Date: Wed, 4 Feb 2015 18:17:31 +0100
Subject: [PATCH 10/14] sepolicy: allow userinit to set its property

Change-Id: I9d8270d889566d169077a1b1fdaee43059d11ee1
---
 common/private/file_contexts     | 3 +++
 common/private/property.te       | 1 +
 common/private/property_contexts | 1 +
 common/private/userinit.te       | 3 +++
 4 files changed, 8 insertions(+)
 create mode 100644 common/private/property.te
 create mode 100644 common/private/property_contexts
 create mode 100644 common/private/userinit.te

diff --git a/common/private/file_contexts b/common/private/file_contexts
index f541a64..69bdbfd 100644
--- a/common/private/file_contexts
+++ b/common/private/file_contexts
@@ -13,3 +13,6 @@
 
 # Sysinit
 /system/bin/sysinit                     u:object_r:sysinit_exec:s0
+
+# Userinit
+/system/etc/init\.d/90userinit          u:object_r:userinit_exec:s0
diff --git a/common/private/property.te b/common/private/property.te
new file mode 100644
index 0000000..3dfaa75
--- /dev/null
+++ b/common/private/property.te
@@ -0,0 +1 @@
+type userinit_prop, property_type;
diff --git a/common/private/property_contexts b/common/private/property_contexts
new file mode 100644
index 0000000..0320986
--- /dev/null
+++ b/common/private/property_contexts
@@ -0,0 +1 @@
+lineage.userinit.active       u:object_r:userinit_prop:s0
diff --git a/common/private/userinit.te b/common/private/userinit.te
new file mode 100644
index 0000000..b12167d
--- /dev/null
+++ b/common/private/userinit.te
@@ -0,0 +1,3 @@
+type userinit_exec, exec_type, file_type;
+
+set_prop(userinit_exec, userinit_prop)
-- 
2.7.4

