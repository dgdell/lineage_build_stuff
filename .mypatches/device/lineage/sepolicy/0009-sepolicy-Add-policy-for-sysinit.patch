From 4d3ed9c9d27027ffb42d79acb87cd3a9fa0e8b15 Mon Sep 17 00:00:00 2001
From: myfluxi <linflux@arcor.de>
Date: Sat, 22 Nov 2014 19:33:26 +0100
Subject: [PATCH 09/14] sepolicy: Add policy for sysinit

Change-Id: I41d4c25d9d6246cd2ca0a8ff3b5a4e114e3bc4d4
---
 common/private/file_contexts |  3 +++
 common/private/sysinit.te    | 10 ++++++++++
 2 files changed, 13 insertions(+)
 create mode 100644 common/private/sysinit.te

diff --git a/common/private/file_contexts b/common/private/file_contexts
index 62d1979..f541a64 100644
--- a/common/private/file_contexts
+++ b/common/private/file_contexts
@@ -10,3 +10,6 @@
 
 # OTA packages
 /data/lineageos_updates(/.*)?           u:object_r:ota_package_file:s0
+
+# Sysinit
+/system/bin/sysinit                     u:object_r:sysinit_exec:s0
diff --git a/common/private/sysinit.te b/common/private/sysinit.te
new file mode 100644
index 0000000..1bfa703
--- /dev/null
+++ b/common/private/sysinit.te
@@ -0,0 +1,10 @@
+type sysinit, domain;
+type sysinit_exec, exec_type, file_type;
+
+# Allow for transition from init domain to sysinit
+init_daemon_domain(sysinit)
+
+allow sysinit devpts:chr_file rw_file_perms;
+allow sysinit self:process setcurrent;
+allow sysinit shell_exec:file rx_file_perms;
+allow sysinit system_file:file rx_file_perms;
-- 
2.7.4

