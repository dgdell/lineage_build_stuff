From 8c681bb78ca06d081c0d6c0c501052d0615965ed Mon Sep 17 00:00:00 2001
From: Steve Kondik <steve@cyngn.com>
Date: Wed, 26 Oct 2016 16:40:38 -0700
Subject: [PATCH 1/3] settings: Kill night mode if we have LiveDisplay

 * Ours looks and works better and doesn't require HWC2.

Change-Id: I76b1cf28b90010c2a7f6f2086340cc5e2244042a
---
 res/xml/display_settings.xml                                 | 3 ++-
 src/com/android/settings/display/NightDisplayPreference.java | 5 +++--
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/res/xml/display_settings.xml b/res/xml/display_settings.xml
index ed432cf..fa63170 100644
--- a/res/xml/display_settings.xml
+++ b/res/xml/display_settings.xml
@@ -33,7 +33,8 @@
         android:title="@string/night_display_title"
         android:fragment="com.android.settings.display.NightDisplaySettings"
         settings:widgetLayout="@null"
-        settings:keywords="@string/keywords_display_night_display" />
+        settings:keywords="@string/keywords_display_night_display"
+        lineage:requiresFeature="!org.lineageos.livedisplay" />
 
     <SwitchPreference
         android:key="auto_brightness"
diff --git a/src/com/android/settings/display/NightDisplayPreference.java b/src/com/android/settings/display/NightDisplayPreference.java
index 38b57a2..2998a21 100644
--- a/src/com/android/settings/display/NightDisplayPreference.java
+++ b/src/com/android/settings/display/NightDisplayPreference.java
@@ -15,7 +15,6 @@
 package com.android.settings.display;
 
 import android.content.Context;
-import android.support.v14.preference.SwitchPreference;
 import android.util.AttributeSet;
 
 import com.android.internal.app.NightDisplayController;
@@ -25,7 +24,9 @@ import java.text.DateFormat;
 import java.util.Calendar;
 import java.util.TimeZone;
 
-public class NightDisplayPreference extends SwitchPreference
+import lineageos.preference.SelfRemovingSwitchPreference;
+
+public class NightDisplayPreference extends SelfRemovingSwitchPreference
         implements NightDisplayController.Callback {
 
     private NightDisplayController mController;
-- 
2.7.4

