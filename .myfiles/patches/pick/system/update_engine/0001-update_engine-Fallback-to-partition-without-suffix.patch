From 0d0413e4894e41e365a622a37009c8c51c3ff9e1 Mon Sep 17 00:00:00 2001
From: Luca Stefani <luca.stefani.ge1@gmail.com>
Date: Sat, 17 Nov 2018 15:02:29 +0100
Subject: [PATCH 1/2] update_engine: Fallback to partition without suffix

Change-Id: I663f8a2ae64709155cb24f289a81fcbbda0521df
---
 boot_control_android.cc | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/boot_control_android.cc b/boot_control_android.cc
index 8c1603b..2b60596 100644
--- a/boot_control_android.cc
+++ b/boot_control_android.cc
@@ -121,7 +121,12 @@ bool BootControlAndroid::GetPartitionDevice(const string& partition_name,
   base::FilePath path = misc_device.DirName().Append(partition_name + suffix);
   if (!base::PathExists(path)) {
     LOG(ERROR) << "Device file " << path.value() << " does not exist.";
-    return false;
+    // Try without slot suffix
+    path = misc_device.DirName().Append(partition_name);
+    if (!base::PathExists(path)) {
+        LOG(ERROR) << "Device file " << path.value() << " does not exist.";
+        return false;
+    }
   }
 
   *device = path.value();
-- 
2.17.1

