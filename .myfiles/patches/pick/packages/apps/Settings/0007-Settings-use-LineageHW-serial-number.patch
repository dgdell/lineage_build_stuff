From c48835586a559ea12b140e20d99272fd4eb0191b Mon Sep 17 00:00:00 2001
From: Pawit Pornkitprasan <p.pawit@gmail.com>
Date: Wed, 8 Jan 2014 22:42:38 +0700
Subject: [PATCH 07/12] Settings: use LineageHW serial number

See https://review.lineageos.org/70954

[mikeioannina]: Rewrite for oreo
[arco]: Adapt for pie

Change-Id: If328ca7b487435b88246d1f8c47b04770183f09e
---
 .../settings/deviceinfo/HardwareInfoDialogFragment.java  | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/src/com/android/settings/deviceinfo/HardwareInfoDialogFragment.java b/src/com/android/settings/deviceinfo/HardwareInfoDialogFragment.java
index 6169b44fe5..dd52d52472 100644
--- a/src/com/android/settings/deviceinfo/HardwareInfoDialogFragment.java
+++ b/src/com/android/settings/deviceinfo/HardwareInfoDialogFragment.java
@@ -31,6 +31,8 @@ import com.android.internal.logging.nano.MetricsProto;
 import com.android.settings.R;
 import com.android.settings.core.instrumentation.InstrumentedDialogFragment;
 
+import lineageos.hardware.LineageHardwareManager;
+
 public class HardwareInfoDialogFragment extends InstrumentedDialogFragment {
 
     public static final String TAG = "HardwareInfo";
@@ -85,6 +87,11 @@ public class HardwareInfoDialogFragment extends InstrumentedDialogFragment {
 
     @VisibleForTesting
     String getSerialNumber() {
-        return Build.getSerial();
+        LineageHardwareManager hardware = LineageHardwareManager.getInstance(getActivity());
+        if (hardware.isSupported(LineageHardwareManager.FEATURE_SERIAL_NUMBER)) {
+            return hardware.getSerialNumber();
+        } else {
+            return Build.getSerial();
+        }
     }
 }
-- 
2.17.1

