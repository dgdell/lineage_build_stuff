From 680edaf6cda354c24c052797ec05b4e28bb57733 Mon Sep 17 00:00:00 2001
From: Joey Rizzoli <joey@lineageos.org>
Date: Sat, 2 Dec 2017 17:31:32 +0100
Subject: [PATCH 23/32] Trebuchet: update icon shape configurations

Change-Id: I76a571ce2b53214ef197a5164f584cb4dc2d3ecf
Signed-off-by: Joey Rizzoli <joey@lineageos.org>
---
 res/values/lineage_adaptive_icons.xml         | 50 +++++++++++++++++++
 res/values/lineage_strings.xml                |  6 +++
 res/xml/launcher_preferences.xml              |  6 +--
 .../launcher3/graphics/IconShapeOverride.java |  7 +--
 4 files changed, 63 insertions(+), 6 deletions(-)
 create mode 100644 res/values/lineage_adaptive_icons.xml

diff --git a/res/values/lineage_adaptive_icons.xml b/res/values/lineage_adaptive_icons.xml
new file mode 100644
index 000000000..8857034c5
--- /dev/null
+++ b/res/values/lineage_adaptive_icons.xml
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2017 The LineageOS Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<resources>
+
+    <!-- Default icon pack package name. Override to set a default icon pack, use "Default" to use system icons -->
+    <string name="icon_pack_default" translatable="false">Default</string>
+
+    <string name="icon_shape_default" translatable="false">@string/mask_path_circle</string>
+
+    <!-- Masks names -->
+    <string-array name="icon_shape_entries" translatable="false">
+        <item>@string/icon_shape_circle_name</item>
+        <item>@string/icon_shape_square_name</item>
+        <item>@string/icon_shape_squircle_name</item>
+        <item>@string/icon_shape_teardrop_name</item>
+    </string-array>
+
+    <!-- Mask paths references -->
+    <string-array name="icon_shape_paths" translatable="false">
+        <item>@string/mask_path_circle</item>
+        <item>@string/mask_path_square</item>
+        <item>@string/mask_path_squircle</item>
+        <item>@string/mask_path_teardrop</item>
+    </string-array>
+
+    <!-- Circle: default -->
+    <string name="mask_path_circle" translatable="false">"M50 0A50 50,0,1,1,50 100A50 50,0,1,1,50 0"</string>
+    <!-- Rounded square -->
+    <string name="mask_path_square" translatable="false">"M 50 0 L 50 0 L 19.2 0 C 12.4794 0 9.11905 0 6.55211 1.30792 C 4.29417 2.4584 2.4584 4.29417 1.30792 6.55211 C 0 9.11905 0 12.4794 0 19.2 L 0 80.8C 0 87.5206 0 90.8809 1.30792 93.4479 C 2.4584 95.7058 4.29417 97.5416 6.55211 98.6921 C 9.11905 100 12.4794 100 19.2 100 L 80.8 100 C 87.5206 100 90.8809 100 93.4479 98.6921 C 95.7058 97.5416 97.5416 95.7058 98.6921 93.4479 C 100 90.8809 100 87.5206 100 80.8 L 100 19.2 C 100 12.4794 100 9.11905 98.6921 6.55211 C 97.5416 4.29417 95.7058 2.4584 93.4479 1.30792 C 90.8809 0 87.5206 0 80.8 0Z"</string>
+    <!-- Straight square: disabled -->
+    <string name="mask_path_straight_square" translatable="false">"M50,0L100,0 100,100 0,100 0,0z"</string>
+    <!-- Squircle -->
+    <string name="mask_path_squircle" translatable="false">"M50,0 C10,0 0,10 0,50 0,90 10,100 50,100 90,100 100,90 100,50 100,10 90,0 50,0 Z"</string>
+    <!-- Teardrop -->
+    <string name="mask_path_teardrop" translatable="false">"M50,0A50,50,0,0 1 100,50 L100,85 A15,15,0,0 1 85,100 L50,100 A50,50,0,0 1 50,0z"</string>
+</resources>
\ No newline at end of file
diff --git a/res/values/lineage_strings.xml b/res/values/lineage_strings.xml
index d0a0c9418..d2526e8ae 100644
--- a/res/values/lineage_strings.xml
+++ b/res/values/lineage_strings.xml
@@ -25,4 +25,10 @@
     <string name="msg_minus_one_on_left">When you swipe right from main home screen</string>
     <!-- Settings message explaining when the -1 screen is available on an RTL device. [CHAR LIMIT=100] -->
     <string name="msg_minus_one_on_right">When you swipe left from main home screen</string>
+
+    <!-- Icon shapes -->
+    <string name="icon_shape_square_name">Square</string>
+    <string name="icon_shape_circle_name">Circle</string>
+    <string name="icon_shape_squircle_name">Squircle</string>
+    <string name="icon_shape_teardrop_name">Teardrop</string>
 </resources>
\ No newline at end of file
diff --git a/res/xml/launcher_preferences.xml b/res/xml/launcher_preferences.xml
index 63923053f..9bec06c4d 100644
--- a/res/xml/launcher_preferences.xml
+++ b/res/xml/launcher_preferences.xml
@@ -53,9 +53,9 @@
         android:key="pref_override_icon_shape"
         android:title="@string/icon_shape_override_label"
         android:summary="%s"
-        android:entries="@array/icon_shape_override_paths_names"
-        android:entryValues="@array/icon_shape_override_paths_values"
-        android:defaultValue=""
+        android:entries="@array/icon_shape_entries"
+        android:entryValues="@array/icon_shape_paths"
+        android:defaultValue="@string/icon_shape_default"
         android:persistent="false" />
 
 </PreferenceScreen>
diff --git a/src/com/android/launcher3/graphics/IconShapeOverride.java b/src/com/android/launcher3/graphics/IconShapeOverride.java
index 40f8a5d92..781fc2527 100644
--- a/src/com/android/launcher3/graphics/IconShapeOverride.java
+++ b/src/com/android/launcher3/graphics/IconShapeOverride.java
@@ -15,8 +15,6 @@
  */
 package com.android.launcher3.graphics;
 
-import static com.android.launcher3.Utilities.getDevicePrefs;
-
 import android.annotation.TargetApi;
 import android.app.AlarmManager;
 import android.app.PendingIntent;
@@ -44,6 +42,8 @@ import com.android.launcher3.util.LooperExecutor;
 
 import java.lang.reflect.Field;
 
+import static com.android.launcher3.Utilities.getDevicePrefs;
+
 /**
  * Utility class to override shape of {@link android.graphics.drawable.AdaptiveIconDrawable}.
  */
@@ -120,7 +120,8 @@ public class IconShapeOverride {
     }
 
     private static String getAppliedValue(Context context) {
-        return getDevicePrefs(context).getString(KEY_PREFERENCE, "");
+        return getDevicePrefs(context).getString(KEY_PREFERENCE,
+                context.getString(R.string.icon_shape_default));
     }
 
     public static void handlePreferenceUi(ListPreference preference) {
-- 
2.17.1

