From e6f83471045d8f33d8609cb92e4a7618d1e99e8e Mon Sep 17 00:00:00 2001
From: Anas Karbila <anaskarbila@aospa.co>
Date: Wed, 7 Dec 2016 18:05:39 +0100
Subject: [PATCH 156/211] VideoModule: don't set negative HFR value

Change-Id: Ic5e429c16792af7f3af0155f50c162487ffa4ef7
(cherry picked from commit 460c0f207ad453473a1d2d5f0f94651578f5eccb)
Signed-off-by: Alex Naidis <alex.naidis@linux.com>
---
 src/com/android/camera/VideoModule.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/com/android/camera/VideoModule.java b/src/com/android/camera/VideoModule.java
index d9f34ed44..9ee3c5c39 100644
--- a/src/com/android/camera/VideoModule.java
+++ b/src/com/android/camera/VideoModule.java
@@ -1794,7 +1794,11 @@ public class VideoModule implements CameraModule,
             // In case framerate is different, scale the bitrate
             int scaledBitrate = getHighSpeedVideoEncoderBitRate(mProfile, targetFrameRate);
             Log.i(TAG, "Scaled Video bitrate : " + scaledBitrate);
-            mMediaRecorder.setVideoEncodingBitRate(scaledBitrate);
+            if (scaledBitrate > 0) {
+                mMediaRecorder.setVideoEncodingBitRate(scaledBitrate);
+            } else {
+                Log.e(TAG, "Cannot set Video bitrate because its negative");
+            }
         }
 
         setRecordLocation();
-- 
2.17.1

