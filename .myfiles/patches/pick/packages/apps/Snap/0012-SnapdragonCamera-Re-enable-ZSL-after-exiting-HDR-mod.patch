From 803519fdc0658ac0c8d0de55da6ca6aab394baa7 Mon Sep 17 00:00:00 2001
From: Sultanxda <sultanxda@gmail.com>
Date: Sun, 2 Aug 2015 20:16:09 -0700
Subject: [PATCH 012/211] SnapdragonCamera: Re-enable ZSL after exiting HDR
 mode

* Make sure to check that HDR was changed before forcing ZSL back on.

Change-Id: Ifb76263c3a50b919762fd2a313d6013295c0619f
---
 src/com/android/camera/PhotoModule.java | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/com/android/camera/PhotoModule.java b/src/com/android/camera/PhotoModule.java
index cd78384f1..1005a6457 100644
--- a/src/com/android/camera/PhotoModule.java
+++ b/src/com/android/camera/PhotoModule.java
@@ -4772,6 +4772,7 @@ public class PhotoModule
 
         //filter off unsupported settings
         final String settingOff = mActivity.getString(R.string.setting_off_value);
+        final String settingOn = mActivity.getString(R.string.setting_on_value);
         if (!CameraSettings.isZSLHDRSupported(mParameters)) {
             //HDR internally uses AE-bracketing. Disable both if not supported.
             if (notSame(pref, CameraSettings.KEY_CAMERA_HDR, settingOff) ||
@@ -4780,6 +4781,9 @@ public class PhotoModule
             } else if (notSame(pref,CameraSettings.KEY_ZSL,settingOff)) {
                 mUI.setPreference(CameraSettings.KEY_CAMERA_HDR, settingOff);
                 mUI.setPreference(CameraSettings.KEY_AE_BRACKET_HDR, settingOff);
+            } else if (notSame(pref, CameraSettings.KEY_CAMERA_HDR, settingOn) ||
+                notSame(pref, CameraSettings.KEY_AE_BRACKET_HDR, settingOn)) {
+                mUI.setPreference(CameraSettings.KEY_ZSL,settingOn);
             }
         }
 
-- 
2.17.1

