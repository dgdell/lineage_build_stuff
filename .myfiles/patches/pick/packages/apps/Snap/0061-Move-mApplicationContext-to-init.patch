From aa6a59de6ea92dbaf9f50ea5b6a6232294a838fd Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Mon, 11 Jan 2016 17:40:58 +0100
Subject: [PATCH 061/211] Move mApplicationContext to init()

Fixes following NPE:
01-11 17:36:42.607  4329  4391 E AndroidRuntime: FATAL EXCEPTION: Thread-235
01-11 17:36:42.607  4329  4391 E AndroidRuntime: Process: org.cyanogenmod.snap, PID: 4329
01-11 17:36:42.607  4329  4391 E AndroidRuntime: java.lang.NullPointerException: Attempt to invoke virtual method 'android.content.res.Resources android.content.Context.getResources()' on a null object reference
01-11 17:36:42.607  4329  4391 E AndroidRuntime: 	at com.android.camera.PhotoModule.updateCameraParametersPreference(PhotoModule.java:3492)
01-11 17:36:42.607  4329  4391 E AndroidRuntime: 	at com.android.camera.PhotoModule.setCameraParameters(PhotoModule.java:3714)
01-11 17:36:42.607  4329  4391 E AndroidRuntime: 	at com.android.camera.PhotoModule.startPreview(PhotoModule.java:2715)
01-11 17:36:42.607  4329  4391 E AndroidRuntime: 	at com.android.camera.PhotoModule.-wrap14(PhotoModule.java)
01-11 17:36:42.607  4329  4391 E AndroidRuntime: 	at com.android.camera.PhotoModule$OpenCameraThread.run(PhotoModule.java:265)

Change-Id: I6ca0dfe402cab46dd7b6f102921062f3c7ec8d43
---
 src/com/android/camera/PhotoModule.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/src/com/android/camera/PhotoModule.java b/src/com/android/camera/PhotoModule.java
index 1dc0eaace..25519e982 100644
--- a/src/com/android/camera/PhotoModule.java
+++ b/src/com/android/camera/PhotoModule.java
@@ -573,6 +573,7 @@ public class PhotoModule
         mCameraId = getPreferredCameraId(mPreferences);
 
         mContentResolver = mActivity.getContentResolver();
+        mApplicationContext = CameraApp.getContext();
 
         // Surface texture is from camera screen nail and startPreview needs it.
         // This must be done before startPreview.
@@ -916,8 +917,6 @@ public class PhotoModule
             return;
         }
 
-        mApplicationContext = CameraApp.getContext();
-
         // Initialize location service.
         boolean recordLocation = RecordLocationPreference.get(mPreferences,
                 CameraSettings.KEY_RECORD_LOCATION);
-- 
2.17.1

