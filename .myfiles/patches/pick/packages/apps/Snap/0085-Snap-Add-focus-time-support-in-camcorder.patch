From ad0c4ac4ae2cd164f2cf1731fe0e821403f917ca Mon Sep 17 00:00:00 2001
From: Michael Bestas <mikeioannina@cyanogenmod.org>
Date: Wed, 13 Jan 2016 18:25:29 +0200
Subject: [PATCH 085/172] Snap: Add focus time support in camcorder

Change-Id: I5432554a40d7375ed7893c38cb2741a12cc8cc80
---
 res/xml/video_preferences.xml              | 6 ++++++
 src/com/android/camera/CameraSettings.java | 1 +
 src/com/android/camera/VideoMenu.java      | 2 ++
 src/com/android/camera/VideoModule.java    | 5 +++++
 4 files changed, 14 insertions(+)

diff --git a/res/xml/video_preferences.xml b/res/xml/video_preferences.xml
index a699d26c3..56bcfcbc7 100644
--- a/res/xml/video_preferences.xml
+++ b/res/xml/video_preferences.xml
@@ -189,6 +189,12 @@
             camera:singleIcon="@drawable/ic_settings_focus"
             camera:entries="@array/pref_video_focusmode_entries"
             camera:entryValues="@array/pref_video_focusmode_entryvalues" />
+    <ListPreference
+            camera:key="pref_camera_video_focustime_key"
+            camera:defaultValue="@string/pref_camera_focustime_default"
+            camera:title="@string/pref_camera_focustime_title"
+            camera:entries="@array/pref_camera_focustime_duration_entries"
+            camera:entryValues="@array/pref_camera_focustime_duration_values" />
     <ListPreference
             camera:key="pref_camera_antibanding_key"
             camera:defaultValue="@string/pref_camera_antibanding_default"
diff --git a/src/com/android/camera/CameraSettings.java b/src/com/android/camera/CameraSettings.java
index b01d94097..f932262cd 100755
--- a/src/com/android/camera/CameraSettings.java
+++ b/src/com/android/camera/CameraSettings.java
@@ -70,6 +70,7 @@ public class CameraSettings {
     public static final String KEY_FOCUS_MODE = "pref_camera_focusmode_key";
     public static final String KEY_VIDEOCAMERA_FOCUS_MODE = "pref_camera_video_focusmode_key";
     public static final String KEY_FOCUS_TIME = "pref_camera_focustime_key";
+    public static final String KEY_VIDEOCAMERA_FOCUS_TIME = "pref_camera_video_focustime_key";
     public static final String KEY_FLASH_MODE = "pref_camera_flashmode_key";
     public static final String KEY_VIDEOCAMERA_FLASH_MODE = "pref_camera_video_flashmode_key";
     public static final String KEY_WHITE_BALANCE = "pref_camera_whitebalance_key";
diff --git a/src/com/android/camera/VideoMenu.java b/src/com/android/camera/VideoMenu.java
index 70e394e2e..0bf6a140f 100644
--- a/src/com/android/camera/VideoMenu.java
+++ b/src/com/android/camera/VideoMenu.java
@@ -116,6 +116,7 @@ public class VideoMenu extends MenuController
                 CameraSettings.KEY_VIDEOCAMERA_FLASH_MODE,
                 CameraSettings.KEY_VIDEO_QUALITY,
                 CameraSettings.KEY_VIDEOCAMERA_FOCUS_MODE,
+                CameraSettings.KEY_VIDEOCAMERA_FOCUS_TIME,
                 CameraSettings.KEY_RECORD_LOCATION,
                 CameraSettings.KEY_CAMERA_SAVEPATH,
                 CameraSettings.KEY_EXPOSURE,
@@ -130,6 +131,7 @@ public class VideoMenu extends MenuController
                 CameraSettings.KEY_VIDEO_QUALITY,
                 CameraSettings.KEY_VIDEO_SNAPSHOT_SIZE,
                 CameraSettings.KEY_VIDEOCAMERA_FOCUS_MODE,
+                CameraSettings.KEY_VIDEOCAMERA_FOCUS_TIME,
                 CameraSettings.KEY_RECORD_LOCATION,
                 CameraSettings.KEY_CAMERA_SAVEPATH,
                 CameraSettings.KEY_EXPOSURE,
diff --git a/src/com/android/camera/VideoModule.java b/src/com/android/camera/VideoModule.java
index 1754b48ec..10492cc94 100644
--- a/src/com/android/camera/VideoModule.java
+++ b/src/com/android/camera/VideoModule.java
@@ -2838,6 +2838,11 @@ public class VideoModule implements CameraModule,
         // Set focus mode
         mParameters.setFocusMode(mFocusManager.getFocusMode(true));
 
+        // Set focus time.
+        mFocusManager.setFocusTime(Integer.valueOf(
+                mPreferences.getString(CameraSettings.KEY_VIDEOCAMERA_FOCUS_TIME,
+                mActivity.getString(R.string.pref_camera_focustime_default))));
+
         // Set face detetction parameter.
         String faceDetection = mPreferences.getString(
             CameraSettings.KEY_FACE_DETECTION,
-- 
2.17.1

