From ecfd54eff2e6ed30d62942c970b158e13cc3e22e Mon Sep 17 00:00:00 2001
From: Steve Kondik <shade@chemlab.org>
Date: Mon, 23 Dec 2013 13:33:21 -0800
Subject: [PATCH 019/211] camera: Check if video sizes are available

 * Some drivers don't report video sizes and we should avoid using fine
   resolution lookup, otherwise a crash results.

Change-Id: I8010e66d1a3a5e6f8a505ff3b50146cd24fc2b9c
---
 src/com/android/camera/CameraSettings.java | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/com/android/camera/CameraSettings.java b/src/com/android/camera/CameraSettings.java
index f82d53d80..98ae523c2 100755
--- a/src/com/android/camera/CameraSettings.java
+++ b/src/com/android/camera/CameraSettings.java
@@ -1405,8 +1405,9 @@ public class CameraSettings {
     private static ArrayList<String> getSupportedVideoQuality(int cameraId,Parameters parameters) {
         ArrayList<String> supported = new ArrayList<String>();
         // Check for supported quality
-        if (ApiHelper.HAS_FINE_RESOLUTION_QUALITY_LEVELS) {
-        getFineResolutionQuality(supported,cameraId,parameters);
+        if (ApiHelper.HAS_FINE_RESOLUTION_QUALITY_LEVELS &&
+                parameters.getSupportedVideoSizes() != null) {
+            getFineResolutionQuality(supported,cameraId,parameters);
         } else {
             supported.add(Integer.toString(CamcorderProfile.QUALITY_HIGH));
             CamcorderProfile high = CamcorderProfile.get(
-- 
2.17.1

