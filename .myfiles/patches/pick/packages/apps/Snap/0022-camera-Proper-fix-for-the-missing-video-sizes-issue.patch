From 7edf23ff62c171ec97958cdb9d533bda9b2662b5 Mon Sep 17 00:00:00 2001
From: Steve Kondik <shade@chemlab.org>
Date: Mon, 23 Dec 2013 22:58:07 -0800
Subject: [PATCH 022/206] camera: Proper fix for the missing video-sizes issue

 * Just honor the defined camcorder profiles.

Change-Id: I83e8fe2ca9bb489332f37767906bc7c56389f949
---
 src/com/android/camera/CameraSettings.java | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/com/android/camera/CameraSettings.java b/src/com/android/camera/CameraSettings.java
index 7256be238..879c87dab 100755
--- a/src/com/android/camera/CameraSettings.java
+++ b/src/com/android/camera/CameraSettings.java
@@ -1341,6 +1341,10 @@ public class CameraSettings {
     }
     private static boolean checkSupportedVideoQuality(Parameters parameters,int width, int height){
         List <Size> supported = parameters.getSupportedVideoSizes();
+        if (supported == null) {
+            // video-size not specified in parameter list. just go along with the profile.
+            return true;
+        }
         int flag = 0;
         for (Size size : supported){
             //since we are having two profiles with same height, we are checking with height
@@ -1364,8 +1368,7 @@ public class CameraSettings {
     private static ArrayList<String> getSupportedVideoQuality(int cameraId,Parameters parameters) {
         ArrayList<String> supported = new ArrayList<String>();
         // Check for supported quality
-        if (ApiHelper.HAS_FINE_RESOLUTION_QUALITY_LEVELS &&
-                parameters.getSupportedVideoSizes() != null) {
+        if (ApiHelper.HAS_FINE_RESOLUTION_QUALITY_LEVELS) {
             getFineResolutionQuality(supported,cameraId,parameters);
         } else {
             supported.add(Integer.toString(CamcorderProfile.QUALITY_HIGH));
-- 
2.17.1

