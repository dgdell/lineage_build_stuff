From fa770891a757566d92a38f7bc7683f52d837b8fa Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Sun, 19 Mar 2017 10:43:33 +0100
Subject: [PATCH 151/206] Add overlay for restarting camera preview for
 additional cameras

Change-Id: I95eb7237b101b73d66fe231a11d0c8d5156bfe47
---
 res/values/config.xml                   | 3 +++
 src/com/android/camera/PhotoModule.java | 7 ++++++-
 2 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/res/values/config.xml b/res/values/config.xml
index 422fb21b0..da52d90e1 100644
--- a/res/values/config.xml
+++ b/res/values/config.xml
@@ -43,6 +43,9 @@
     <!-- Restart preview for front camera onPictureTaken -->
     <bool name="front_camera_restart_preview_onPictureTaken">false</bool>
 
+    <!-- Restart preview for additional camera onPictureTaken -->
+    <bool name="additional_camera_restart_preview_onPictureTaken">false</bool>
+
     <!-- Set's manufacturer specific parameters on startup.
          Example: lge-camera=1;cam-mode=0 -->
     <string name="manufacturer_key_values"></string>
diff --git a/src/com/android/camera/PhotoModule.java b/src/com/android/camera/PhotoModule.java
index a393467e3..fd905c065 100644
--- a/src/com/android/camera/PhotoModule.java
+++ b/src/com/android/camera/PhotoModule.java
@@ -1482,18 +1482,23 @@ public class PhotoModule
 
             boolean backCameraRestartPreviewOnPictureTaken = false;
             boolean frontCameraRestartPreviewOnPictureTaken = false;
+            boolean additionalCameraRestartPreviewOnPictureTaken = false;
             if (mApplicationContext != null) {
                 backCameraRestartPreviewOnPictureTaken =
                     mApplicationContext.getResources().getBoolean(R.bool.back_camera_restart_preview_onPictureTaken);
                 frontCameraRestartPreviewOnPictureTaken =
                     mApplicationContext.getResources().getBoolean(R.bool.front_camera_restart_preview_onPictureTaken);
+                additionalCameraRestartPreviewOnPictureTaken =
+                    mApplicationContext.getResources().getBoolean(R.bool.additional_camera_restart_preview_onPictureTaken);
             }
 
             CameraHolder.CameraInfo info = CameraHolder.instance().getCameraInfo()[mCameraId];
             if ((info.facing == CameraHolder.CameraInfo.CAMERA_FACING_BACK
                     && backCameraRestartPreviewOnPictureTaken && (mCameraState != LONGSHOT))
                     || (info.facing == CameraHolder.CameraInfo.CAMERA_FACING_FRONT
-                    && frontCameraRestartPreviewOnPictureTaken && (mCameraState != LONGSHOT))) {
+                    && frontCameraRestartPreviewOnPictureTaken && (mCameraState != LONGSHOT))
+                    || (info.facing > CameraHolder.CameraInfo.CAMERA_FACING_FRONT
+                    && additionalCameraRestartPreviewOnPictureTaken && (mCameraState != LONGSHOT))) {
                 needRestartPreview = true;
             }
 
-- 
2.17.1

