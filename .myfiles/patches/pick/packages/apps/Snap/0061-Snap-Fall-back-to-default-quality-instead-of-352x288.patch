From e89d3f305320380be5efead00e3cc1594cd9db95 Mon Sep 17 00:00:00 2001
From: Michael Bestas <mikeioannina@cyanogenmod.org>
Date: Mon, 11 Jan 2016 01:36:39 +0200
Subject: [PATCH 061/206] Snap: Fall back to default quality instead of 352x288

* Not all devices support this resolution

Change-Id: I42d2037b4e32c7f5c88a60b5da1895dcb761d176
---
 src/com/android/camera/VideoModule.java | 11 ++---------
 1 file changed, 2 insertions(+), 9 deletions(-)

diff --git a/src/com/android/camera/VideoModule.java b/src/com/android/camera/VideoModule.java
index 4c5e3b978..83673ca6c 100755
--- a/src/com/android/camera/VideoModule.java
+++ b/src/com/android/camera/VideoModule.java
@@ -873,9 +873,8 @@ public class VideoModule implements CameraModule,
     private void readVideoPreferences() {
         // The preference stores values from ListPreference and is thus string type for all values.
         // We need to convert it to int manually.
-        String videoQuality = mPreferences.getString(CameraSettings.KEY_VIDEO_QUALITY,
-                        null);
-        if (videoQuality == null) {
+        String videoQuality = mPreferences.getString(CameraSettings.KEY_VIDEO_QUALITY, null);
+        if (videoQuality == null || (videoQuality.length() < 3 && !videoQuality.contains("x"))) {
             mParameters = mCameraDevice.getParameters();
             String defaultQuality = mActivity.getResources().getString(
                     R.string.pref_video_quality_default);
@@ -892,12 +891,6 @@ public class VideoModule implements CameraModule,
             mPreferences.edit().putString(CameraSettings.KEY_VIDEO_QUALITY, videoQuality).apply();
         }
 
-        // videoQuality must be at least 3 chars long (1x1) and contain the letter "x"
-        if (videoQuality.length() < 3 && !videoQuality.contains("x")) {
-            Log.e(TAG, "Invalid video quality " + videoQuality + ". Fallback to 352x288.");
-            videoQuality = "352x288";
-        }
-
         int quality = CameraSettings.VIDEO_QUALITY_TABLE.get(videoQuality);
 
         // Set video quality.
-- 
2.17.1

