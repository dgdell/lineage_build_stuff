From 3699640fc4b15f54787cd6d9d3b317fd240a22f2 Mon Sep 17 00:00:00 2001
From: Ethan Chen <intervigil@gmail.com>
Date: Thu, 10 Mar 2016 17:10:13 -0800
Subject: [PATCH 087/206] Snap: Fall back to REVIEW intent before VIEW intent

Change-Id: Ie8f1dac602957cb871d0f8c7043ac0f434f4bfac
---
 src/com/android/camera/CameraActivity.java | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)

diff --git a/src/com/android/camera/CameraActivity.java b/src/com/android/camera/CameraActivity.java
index 10b284a1f..22f4ac74b 100755
--- a/src/com/android/camera/CameraActivity.java
+++ b/src/com/android/camera/CameraActivity.java
@@ -615,8 +615,22 @@ public class CameraActivity extends Activity
             intent.putExtra(KEY_TOTAL_NUMBER, (adapter.getTotalNumber() -1));
             startActivity(intent);
         } catch (ActivityNotFoundException ex) {
-            gotoViewPhoto(uri);
+            gotoReviewPhoto(uri);
         } catch (IllegalArgumentException ex) {
+            gotoReviewPhoto(uri);
+        }
+    }
+
+    private void gotoReviewPhoto(Uri uri) {
+        try {
+            Log.w(TAG, "Gallery not found");
+            Intent intent = new Intent(CameraUtil.REVIEW_ACTION, uri);
+            startActivity(intent);
+            intent.putExtra(KEY_FROM_SNAPCAM, true);
+            intent.putExtra(KEY_TOTAL_NUMBER, getDataAdapter().getTotalNumber() - 1);
+        } catch (ActivityNotFoundException e) {
+            gotoViewPhoto(uri);
+        } catch (IllegalArgumentException e) {
             gotoViewPhoto(uri);
         }
     }
-- 
2.17.1

