From 40155842e78c705bd2d20128ff89af4a671bbb77 Mon Sep 17 00:00:00 2001
From: Nikita <nikich340@gmail.com>
Date: Tue, 23 Feb 2016 15:19:23 +1000
Subject: [PATCH 064/172] Snap: Fix incorrect preview layout surface size in
 landscape mode

If height is smaller than width it means that orientation sets to horizontal
and we should decrease width instead height to get normal preview size.
Change-Id: Ifa211ad2604fb730fb85b01ae1d7c93c9b7aa2ce
---
 src/com/android/camera/PhotoUI.java | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/src/com/android/camera/PhotoUI.java b/src/com/android/camera/PhotoUI.java
index 61ea9f93b..5daab2f91 100755
--- a/src/com/android/camera/PhotoUI.java
+++ b/src/com/android/camera/PhotoUI.java
@@ -395,8 +395,13 @@ public class PhotoUI implements PieListener,
         } else {
             float width = mMaxPreviewWidth, height = mMaxPreviewHeight;
             if (width == 0 || height == 0) return;
-            if(mScreenRatio == CameraUtil.RATIO_4_3)
-                height -=  (mTopMargin + mBottomMargin);
+            if (mScreenRatio == CameraUtil.RATIO_4_3) {
+                if (height > width) {
+                    height -= (mTopMargin + mBottomMargin);
+                } else {
+                    width -= (mTopMargin + mBottomMargin);
+                }
+            }
             if (mOrientationResize) {
                 scaledTextureWidth = height * mAspectRatio;
                 if (scaledTextureWidth > width) {
-- 
2.17.1

