From 0accf240747cc116cd76195aa9e579d164141f51 Mon Sep 17 00:00:00 2001
From: Dave Daynard <nardholio@gmail.com>
Date: Tue, 2 Sep 2014 19:14:08 -0400
Subject: [PATCH 029/172] Camera2: Headset shutter mode

Use play button on headset to take a picture/video/panorama
Use media next/previous for zoom

Change-Id: I25c22646b041e5e0941fbe361eccfe77a2a1e42f
---
 src/com/android/camera/PhotoModule.java             | 5 +++++
 src/com/android/camera/VideoModule.java             | 6 ++++++
 src/com/android/camera/WideAnglePanoramaModule.java | 5 +++++
 3 files changed, 16 insertions(+)

diff --git a/src/com/android/camera/PhotoModule.java b/src/com/android/camera/PhotoModule.java
index bd189142c..34c0a5efa 100644
--- a/src/com/android/camera/PhotoModule.java
+++ b/src/com/android/camera/PhotoModule.java
@@ -2809,6 +2809,7 @@ public class PhotoModule
         }
         switch (keyCode) {
             case KeyEvent.KEYCODE_VOLUME_UP:
+            case KeyEvent.KEYCODE_MEDIA_NEXT:
                 if (mFirstTimeInitialized && (mUI.mMenuInitialized)) {
                     if (!CameraActivity.mPowerShutter && !CameraUtil.hasCameraKey()) {
                         onShutterButtonFocus(true);
@@ -2818,6 +2819,7 @@ public class PhotoModule
                 }
                 return true;
             case KeyEvent.KEYCODE_VOLUME_DOWN:
+            case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
                 if (mFirstTimeInitialized && (mUI.mMenuInitialized)) {
                     if (!CameraActivity.mPowerShutter && !CameraUtil.hasCameraKey()) {
                         onShutterButtonFocus(true);
@@ -2835,6 +2837,7 @@ public class PhotoModule
                 }
                 return false;
             case KeyEvent.KEYCODE_CAMERA:
+            case KeyEvent.KEYCODE_HEADSETHOOK:
                 if (mFirstTimeInitialized && event.getRepeatCount() == 0) {
                     onShutterButtonClick();
                 }
@@ -2865,6 +2868,8 @@ public class PhotoModule
         switch (keyCode) {
             case KeyEvent.KEYCODE_VOLUME_UP:
             case KeyEvent.KEYCODE_VOLUME_DOWN:
+            case KeyEvent.KEYCODE_MEDIA_NEXT:
+            case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
                 if (!CameraActivity.mPowerShutter && !CameraUtil.hasCameraKey()
                         && mFirstTimeInitialized) {
                     onShutterButtonClick();
diff --git a/src/com/android/camera/VideoModule.java b/src/com/android/camera/VideoModule.java
index e713c72dc..c2758468c 100644
--- a/src/com/android/camera/VideoModule.java
+++ b/src/com/android/camera/VideoModule.java
@@ -1385,6 +1385,7 @@ public class VideoModule implements CameraModule,
 
         switch (keyCode) {
             case KeyEvent.KEYCODE_VOLUME_UP:
+            case KeyEvent.KEYCODE_MEDIA_NEXT:
                 if (event.getRepeatCount() == 0 && !CameraActivity.mPowerShutter &&
                         !CameraUtil.hasCameraKey()) {
                     mUI.clickShutter();
@@ -1393,6 +1394,7 @@ public class VideoModule implements CameraModule,
                 }
                 return true;
             case KeyEvent.KEYCODE_VOLUME_DOWN:
+            case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
                 if (event.getRepeatCount() == 0 && !CameraActivity.mPowerShutter &&
                         !CameraUtil.hasCameraKey()) {
                     mUI.clickShutter();
@@ -1401,6 +1403,7 @@ public class VideoModule implements CameraModule,
                 }
                 return true;
             case KeyEvent.KEYCODE_CAMERA:
+            case KeyEvent.KEYCODE_HEADSETHOOK:
                 if (event.getRepeatCount() == 0) {
                     mUI.clickShutter();
                 }
@@ -1429,16 +1432,19 @@ public class VideoModule implements CameraModule,
     public boolean onKeyUp(int keyCode, KeyEvent event) {
         switch (keyCode) {
             case KeyEvent.KEYCODE_VOLUME_UP:
+            case KeyEvent.KEYCODE_MEDIA_NEXT:
                 if (!CameraActivity.mPowerShutter && !CameraUtil.hasCameraKey()) {
                     mUI.pressShutter(false);
                 }
                 return true;
             case KeyEvent.KEYCODE_VOLUME_DOWN:
+            case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
                 if (!CameraActivity.mPowerShutter && !CameraUtil.hasCameraKey()) {
                     mUI.pressShutter(false);
                 }
                 return true;
             case KeyEvent.KEYCODE_CAMERA:
+            case KeyEvent.KEYCODE_HEADSETHOOK:
                 mUI.pressShutter(false);
                 return true;
             case KeyEvent.KEYCODE_POWER:
diff --git a/src/com/android/camera/WideAnglePanoramaModule.java b/src/com/android/camera/WideAnglePanoramaModule.java
index d3c4ff163..4e0da9fbe 100644
--- a/src/com/android/camera/WideAnglePanoramaModule.java
+++ b/src/com/android/camera/WideAnglePanoramaModule.java
@@ -1255,8 +1255,11 @@ public class WideAnglePanoramaModule
         switch (keyCode) {
             case KeyEvent.KEYCODE_VOLUME_UP:
             case KeyEvent.KEYCODE_VOLUME_DOWN:
+            case KeyEvent.KEYCODE_MEDIA_NEXT:
+            case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
                 return true;
             case KeyEvent.KEYCODE_CAMERA:
+            case KeyEvent.KEYCODE_HEADSETHOOK:
                 if (event.getRepeatCount() == 0) {
                     onShutterButtonClick();
                 }
@@ -1272,6 +1275,8 @@ public class WideAnglePanoramaModule
         switch (keyCode) {
             case KeyEvent.KEYCODE_VOLUME_UP:
             case KeyEvent.KEYCODE_VOLUME_DOWN:
+            case KeyEvent.KEYCODE_MEDIA_NEXT:
+            case KeyEvent.KEYCODE_MEDIA_PREVIOUS:
                 if (!CameraActivity.mPowerShutter && !CameraUtil.hasCameraKey()) {
                     onShutterButtonClick();
                 }
-- 
2.17.1

