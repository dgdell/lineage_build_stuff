From bde4e5218c21a80671fa375cfdd4adbe881eb1a2 Mon Sep 17 00:00:00 2001
From: Joey <joey@lineageos.org>
Date: Mon, 7 Jan 2019 12:35:20 +0100
Subject: [PATCH 1/2] Refactor to androidx libraries

Change-Id: I0245c566c734719bb66eb1f20fdae5369e95dd67
Signed-off-by: Joey <joey@lineageos.org>
---
 app/build.gradle                              | 12 +++++------
 app/src/main/Android.mk                       | 15 +++++++-------
 app/src/main/AndroidManifest.xml              |  2 +-
 .../lineageos/recorder/DialogActivity.java    |  8 ++++----
 .../lineageos/recorder/RecorderActivity.java  | 20 +++++++++----------
 .../recorder/screen/OverlayService.java       |  2 +-
 .../recorder/screen/ScreencastService.java    |  2 +-
 .../recorder/sounds/SoundRecorderService.java |  5 ++---
 .../recorder/ui/SoundVisualizer.java          |  2 +-
 .../recorder/utils/LastRecordHelper.java      |  4 ++--
 .../recorder/utils/OnBoardingHelper.java      |  2 +-
 .../main/res/layout/activty_constraint.xml    |  8 ++++----
 .../main/res/layout/constraint_default.xml    |  4 ++--
 app/src/main/res/layout/constraint_screen.xml |  4 ++--
 app/src/main/res/layout/constraint_sound.xml  |  4 ++--
 app/src/main/res/layout/dialog_base.xml       |  4 ++--
 build.gradle                                  |  2 +-
 gradle.properties                             |  2 ++
 gradle/wrapper/gradle-wrapper.properties      |  4 ++--
 19 files changed, 53 insertions(+), 53 deletions(-)

diff --git a/app/build.gradle b/app/build.gradle
index 19840a1..509179f 100644
--- a/app/build.gradle
+++ b/app/build.gradle
@@ -1,8 +1,8 @@
 apply plugin: 'com.android.application'
 
 android {
-    compileSdkVersion 27
-    buildToolsVersion "27.0.3"
+    compileSdkVersion 28
+    buildToolsVersion '28.0.3'
     defaultConfig {
         applicationId "org.lineageos.recorder"
         minSdkVersion 24
@@ -25,8 +25,8 @@ android {
 }
 
 dependencies {
-    implementation 'com.android.support:appcompat-v7:27.1.1'
-    implementation 'com.android.support:design:27.1.1'
-    implementation 'com.android.support:cardview-v7:27.1.1'
-    implementation 'com.android.support.constraint:constraint-layout:1.1.0'
+    implementation 'androidx.appcompat:appcompat:1.1.0-alpha01'
+    implementation 'com.google.android.material:material:1.1.0-alpha02'
+    implementation 'androidx.cardview:cardview:1.0.0'
+    implementation 'androidx.constraintlayout:constraintlayout:2.0.0-alpha3'
 }
diff --git a/app/src/main/Android.mk b/app/src/main/Android.mk
index 3ac88f4..265b22c 100644
--- a/app/src/main/Android.mk
+++ b/app/src/main/Android.mk
@@ -26,14 +26,13 @@ LOCAL_SRC_FILES := \
 LOCAL_USE_AAPT2 := true
 
 LOCAL_STATIC_ANDROID_LIBRARIES += \
-    android-support-annotations \
-    android-support-constraint-layout \
-    android-support-constraint-layout-solver \
-    android-support-design \
-    android-support-v4 \
-    android-support-v7-appcompat \
-    android-support-v7-cardview \
-    android-support-v7-recyclerview
+    androidx.annotation_annotation \
+    androidx-constraintlayout_constraintlayout \
+    androidx-constraintlayout_constraintlayout-solver \
+    androidx.appcompat_appcompat \
+    androidx.cardview_cardview \
+    androidx.recyclerview_recyclerview \
+    com.google.android.material_material \
 
 LOCAL_PACKAGE_NAME := Recorder
 LOCAL_CERTIFICATE := platform
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
index 67c97a3..0ae0bdf 100644
--- a/app/src/main/AndroidManifest.xml
+++ b/app/src/main/AndroidManifest.xml
@@ -87,7 +87,7 @@
 
         <!-- File provider -->
         <provider
-            android:name="android.support.v4.content.FileProvider"
+            android:name="androidx.core.content.FileProvider"
             android:authorities="org.lineageos.recorder.fileprovider"
             android:exported="false"
             android:grantUriPermissions="true">
diff --git a/app/src/main/java/org/lineageos/recorder/DialogActivity.java b/app/src/main/java/org/lineageos/recorder/DialogActivity.java
index d94798e..ecc2427 100644
--- a/app/src/main/java/org/lineageos/recorder/DialogActivity.java
+++ b/app/src/main/java/org/lineageos/recorder/DialogActivity.java
@@ -20,10 +20,10 @@ import android.content.Intent;
 import android.content.SharedPreferences;
 import android.content.pm.PackageManager;
 import android.os.Bundle;
-import android.support.annotation.LayoutRes;
-import android.support.annotation.NonNull;
-import android.support.v7.app.AlertDialog;
-import android.support.v7.app.AppCompatActivity;
+import androidx.annotation.LayoutRes;
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AlertDialog;
+import androidx.appcompat.app.AppCompatActivity;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
diff --git a/app/src/main/java/org/lineageos/recorder/RecorderActivity.java b/app/src/main/java/org/lineageos/recorder/RecorderActivity.java
index a177c8e..4ef7fa9 100644
--- a/app/src/main/java/org/lineageos/recorder/RecorderActivity.java
+++ b/app/src/main/java/org/lineageos/recorder/RecorderActivity.java
@@ -29,16 +29,16 @@ import android.os.Bundle;
 import android.os.Handler;
 import android.os.IBinder;
 import android.provider.Settings;
-import android.support.annotation.NonNull;
-import android.support.constraint.ConstraintLayout;
-import android.support.constraint.ConstraintSet;
-import android.support.design.widget.FloatingActionButton;
-import android.support.transition.TransitionManager;
-import android.support.v4.app.ActivityCompat;
-import android.support.v4.app.ActivityOptionsCompat;
-import android.support.v4.content.ContextCompat;
-import android.support.v7.app.AlertDialog;
-import android.support.v7.app.AppCompatActivity;
+import androidx.annotation.NonNull;
+import androidx.constraintlayout.widget.ConstraintLayout;
+import androidx.constraintlayout.widget.ConstraintSet;
+import com.google.android.material.floatingactionbutton.FloatingActionButton;
+import androidx.transition.TransitionManager;
+import androidx.core.app.ActivityCompat;
+import androidx.core.app.ActivityOptionsCompat;
+import androidx.core.content.ContextCompat;
+import androidx.appcompat.app.AlertDialog;
+import androidx.appcompat.app.AppCompatActivity;
 import android.telephony.TelephonyManager;
 import android.view.View;
 import android.widget.ImageView;
diff --git a/app/src/main/java/org/lineageos/recorder/screen/OverlayService.java b/app/src/main/java/org/lineageos/recorder/screen/OverlayService.java
index 0455321..7743c47 100644
--- a/app/src/main/java/org/lineageos/recorder/screen/OverlayService.java
+++ b/app/src/main/java/org/lineageos/recorder/screen/OverlayService.java
@@ -23,7 +23,7 @@ import android.app.Service;
 import android.content.Intent;
 import android.os.Build;
 import android.os.IBinder;
-import android.support.v4.app.NotificationCompat;
+import androidx.core.app.NotificationCompat;
 
 import org.lineageos.recorder.R;
 import org.lineageos.recorder.RecorderActivity;
diff --git a/app/src/main/java/org/lineageos/recorder/screen/ScreencastService.java b/app/src/main/java/org/lineageos/recorder/screen/ScreencastService.java
index 0fb6111..2085973 100644
--- a/app/src/main/java/org/lineageos/recorder/screen/ScreencastService.java
+++ b/app/src/main/java/org/lineageos/recorder/screen/ScreencastService.java
@@ -32,7 +32,7 @@ import android.os.Environment;
 import android.os.IBinder;
 import android.os.StatFs;
 import android.os.SystemClock;
-import android.support.v4.app.NotificationCompat;
+import androidx.core.app.NotificationCompat;
 import android.text.format.DateUtils;
 import android.util.Log;
 import android.view.Display;
diff --git a/app/src/main/java/org/lineageos/recorder/sounds/SoundRecorderService.java b/app/src/main/java/org/lineageos/recorder/sounds/SoundRecorderService.java
index 003bb97..ff617de 100644
--- a/app/src/main/java/org/lineageos/recorder/sounds/SoundRecorderService.java
+++ b/app/src/main/java/org/lineageos/recorder/sounds/SoundRecorderService.java
@@ -30,8 +30,8 @@ import android.media.MediaRecorder;
 import android.os.Build;
 import android.os.Environment;
 import android.os.IBinder;
-import android.support.v4.app.NotificationCompat;
-import android.support.v4.content.ContextCompat;
+import androidx.core.app.NotificationCompat;
+import androidx.core.content.ContextCompat;
 import android.text.format.DateUtils;
 import android.util.Log;
 
@@ -182,7 +182,6 @@ public class SoundRecorderService extends Service {
         }
 
         if (mRecord != null) {
-            mStatus = RecorderStatus.STOPPED;
             mStatus = RecorderStatus.STOPPED;
             mRecord.stop();
             mRecord.release();
diff --git a/app/src/main/java/org/lineageos/recorder/ui/SoundVisualizer.java b/app/src/main/java/org/lineageos/recorder/ui/SoundVisualizer.java
index a9781f5..bfae43d 100644
--- a/app/src/main/java/org/lineageos/recorder/ui/SoundVisualizer.java
+++ b/app/src/main/java/org/lineageos/recorder/ui/SoundVisualizer.java
@@ -18,7 +18,7 @@ package org.lineageos.recorder.ui;
 import android.app.Activity;
 import android.content.Context;
 import android.graphics.drawable.GradientDrawable;
-import android.support.v4.content.ContextCompat;
+import androidx.core.content.ContextCompat;
 import android.util.AttributeSet;
 import android.view.Gravity;
 import android.view.View;
diff --git a/app/src/main/java/org/lineageos/recorder/utils/LastRecordHelper.java b/app/src/main/java/org/lineageos/recorder/utils/LastRecordHelper.java
index 2ac7b16..19f0ef6 100644
--- a/app/src/main/java/org/lineageos/recorder/utils/LastRecordHelper.java
+++ b/app/src/main/java/org/lineageos/recorder/utils/LastRecordHelper.java
@@ -20,8 +20,8 @@ import android.content.Context;
 import android.content.Intent;
 import android.content.SharedPreferences;
 import android.net.Uri;
-import android.support.v4.content.FileProvider;
-import android.support.v7.app.AlertDialog;
+import androidx.core.content.FileProvider;
+import androidx.appcompat.app.AlertDialog;
 
 import org.lineageos.recorder.DialogActivity;
 import org.lineageos.recorder.R;
diff --git a/app/src/main/java/org/lineageos/recorder/utils/OnBoardingHelper.java b/app/src/main/java/org/lineageos/recorder/utils/OnBoardingHelper.java
index 6056cc2..4aa123c 100644
--- a/app/src/main/java/org/lineageos/recorder/utils/OnBoardingHelper.java
+++ b/app/src/main/java/org/lineageos/recorder/utils/OnBoardingHelper.java
@@ -18,7 +18,7 @@ package org.lineageos.recorder.utils;
 import android.content.Context;
 import android.content.SharedPreferences;
 import android.os.Handler;
-import android.support.annotation.NonNull;
+import androidx.annotation.NonNull;
 import android.view.View;
 import android.view.animation.Animation;
 import android.view.animation.AnimationUtils;
diff --git a/app/src/main/res/layout/activty_constraint.xml b/app/src/main/res/layout/activty_constraint.xml
index 947fa10..2464900 100644
--- a/app/src/main/res/layout/activty_constraint.xml
+++ b/app/src/main/res/layout/activty_constraint.xml
@@ -13,7 +13,7 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/main_root"
     android:layout_width="match_parent"
@@ -62,7 +62,7 @@
         app:layout_constraintLeft_toLeftOf="parent"
         app:layout_constraintRight_toRightOf="parent">
 
-        <android.support.design.widget.FloatingActionButton
+        <com.google.android.material.floatingactionbutton.FloatingActionButton
             android:id="@+id/sound_fab"
             style="@style/AppTheme.RecordFab"
             android:src="@drawable/ic_action_sound_record" />
@@ -93,7 +93,7 @@
         app:layout_constraintRight_toRightOf="parent"
         app:layout_constraintTop_toTopOf="parent">
 
-        <android.support.design.widget.FloatingActionButton
+        <com.google.android.material.floatingactionbutton.FloatingActionButton
             android:id="@+id/screen_fab"
             style="@style/AppTheme.RecordFab"
             android:src="@drawable/ic_action_screen_record" />
@@ -124,4 +124,4 @@
                 android:src="@drawable/ic_settings" />
         </LinearLayout>
     </RelativeLayout>
-</android.support.constraint.ConstraintLayout>
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/app/src/main/res/layout/constraint_default.xml b/app/src/main/res/layout/constraint_default.xml
index 43720c5..8f1c181 100644
--- a/app/src/main/res/layout/constraint_default.xml
+++ b/app/src/main/res/layout/constraint_default.xml
@@ -13,7 +13,7 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:layout_width="match_parent"
     android:layout_height="match_parent">
@@ -50,4 +50,4 @@
         app:layout_constraintLeft_toLeftOf="parent"
         app:layout_constraintRight_toRightOf="parent"
         app:layout_constraintTop_toTopOf="parent" />
-</android.support.constraint.ConstraintLayout>
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/app/src/main/res/layout/constraint_screen.xml b/app/src/main/res/layout/constraint_screen.xml
index a9f88ad..b31feb1 100644
--- a/app/src/main/res/layout/constraint_screen.xml
+++ b/app/src/main/res/layout/constraint_screen.xml
@@ -13,7 +13,7 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/main_root"
     android:layout_width="match_parent"
@@ -49,4 +49,4 @@
         app:layout_constraintHeight_percent="0.5"
         app:layout_constraintLeft_toLeftOf="parent"
         app:layout_constraintRight_toRightOf="parent" />
-</android.support.constraint.ConstraintLayout>
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/app/src/main/res/layout/constraint_sound.xml b/app/src/main/res/layout/constraint_sound.xml
index 17d759d..51ee678 100644
--- a/app/src/main/res/layout/constraint_sound.xml
+++ b/app/src/main/res/layout/constraint_sound.xml
@@ -13,7 +13,7 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/main_root"
     android:layout_width="match_parent"
@@ -50,4 +50,4 @@
         app:layout_constraintLeft_toLeftOf="parent"
         app:layout_constraintRight_toRightOf="parent"/>
 
-</android.support.constraint.ConstraintLayout>
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/app/src/main/res/layout/dialog_base.xml b/app/src/main/res/layout/dialog_base.xml
index 6c91a71..2e0a2d4 100644
--- a/app/src/main/res/layout/dialog_base.xml
+++ b/app/src/main/res/layout/dialog_base.xml
@@ -13,7 +13,7 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<android.support.v7.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
+<androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="wrap_content"
     android:layout_marginEnd="16dp"
@@ -45,4 +45,4 @@
             android:minHeight="48dp"
             android:paddingTop="16dp" />
     </LinearLayout>
-</android.support.v7.widget.CardView>
+</androidx.cardview.widget.CardView>
diff --git a/build.gradle b/build.gradle
index 26d3904..3b527b1 100644
--- a/build.gradle
+++ b/build.gradle
@@ -6,7 +6,7 @@ buildscript {
         google()
     }
     dependencies {
-        classpath 'com.android.tools.build:gradle:3.1.2'
+        classpath 'com.android.tools.build:gradle:3.2.1'
 
         // NOTE: Do not place your application dependencies here; they belong
         // in the individual module build.gradle files
diff --git a/gradle.properties b/gradle.properties
index f285285..44040c8 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -15,3 +15,5 @@
 # This option should only be used with decoupled projects. More details, visit
 # http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects
 # org.gradle.parallel=true
+android.enableJetifier=true
+android.useAndroidX=true
\ No newline at end of file
diff --git a/gradle/wrapper/gradle-wrapper.properties b/gradle/wrapper/gradle-wrapper.properties
index eaed150..7d25f59 100644
--- a/gradle/wrapper/gradle-wrapper.properties
+++ b/gradle/wrapper/gradle-wrapper.properties
@@ -1,6 +1,6 @@
-#Sat May 19 17:47:00 CEST 2018
+#Mon Jan 07 12:15:02 CET 2019
 distributionBase=GRADLE_USER_HOME
 distributionPath=wrapper/dists
 zipStoreBase=GRADLE_USER_HOME
 zipStorePath=wrapper/dists
-distributionUrl=https\://services.gradle.org/distributions/gradle-4.4-all.zip
+distributionUrl=https\://services.gradle.org/distributions/gradle-4.6-all.zip
-- 
2.17.1

