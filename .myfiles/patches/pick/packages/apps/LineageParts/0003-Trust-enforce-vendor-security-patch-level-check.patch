From 0682cd2ef25c8415bedee5a727189f0944aea1a9 Mon Sep 17 00:00:00 2001
From: Joey <joey@lineageos.org>
Date: Sat, 9 Jun 2018 17:02:26 +0200
Subject: [PATCH 3/7] Trust: enforce vendor security patch level check

Change-Id: I3dc2c0760012020200a037875255215656bb82d8
Signed-off-by: Joey <joey@lineageos.org>
---
 .../lineageparts/trust/TrustPreferences.java  | 37 +++++--------------
 1 file changed, 10 insertions(+), 27 deletions(-)

diff --git a/src/org/lineageos/lineageparts/trust/TrustPreferences.java b/src/org/lineageos/lineageparts/trust/TrustPreferences.java
index 086718c..25e73e9 100644
--- a/src/org/lineageos/lineageparts/trust/TrustPreferences.java
+++ b/src/org/lineageos/lineageparts/trust/TrustPreferences.java
@@ -140,39 +140,21 @@ public class TrustPreferences extends SettingsPreferenceFragment {
     private void setupSecurityPatches(int platform, int vendor) {
         int icon;
 
-        // TMP: don't enforce vendor check
-        if (vendor == TrustInterface.ERROR_UNDEFINED) {
-            switch (platform) {
-                case TrustInterface.TRUST_FEATURE_LEVEL_GOOD:
-                    icon = R.drawable.ic_trust_security_patches_good;
-                    break;
-                case TrustInterface.TRUST_FEATURE_LEVEL_POOR:
-                    icon = R.drawable.ic_trust_security_patches_poor;
-                    break;
-                default:
-                    icon = R.drawable.ic_trust_security_patches_bad;
-                    break;
-            }
+        if (platform == TrustInterface.TRUST_FEATURE_LEVEL_GOOD &&
+                vendor ==  TrustInterface.TRUST_FEATURE_LEVEL_GOOD) {
+            icon = R.drawable.ic_trust_security_patches_good;
+        } else if (platform == TrustInterface.TRUST_FEATURE_LEVEL_POOR ||
+                (platform == TrustInterface.TRUST_FEATURE_LEVEL_GOOD &&
+                vendor != TrustInterface.TRUST_FEATURE_LEVEL_GOOD)) {
+            icon = R.drawable.ic_trust_security_patches_poor;
         } else {
-            if (platform == TrustInterface.TRUST_FEATURE_LEVEL_GOOD &&
-                    vendor ==  TrustInterface.TRUST_FEATURE_LEVEL_GOOD) {
-                icon = R.drawable.ic_trust_security_patches_good;
-            } else if (platform == TrustInterface.TRUST_FEATURE_LEVEL_POOR ||
-                    (platform == TrustInterface.TRUST_FEATURE_LEVEL_GOOD &&
-                    vendor != TrustInterface.TRUST_FEATURE_LEVEL_GOOD)) {
-                icon = R.drawable.ic_trust_security_patches_poor;
-            } else {
-                icon = R.drawable.ic_trust_security_patches_bad;
-            }
+            icon = R.drawable.ic_trust_security_patches_bad;
         }
 
         int summaryP = getSummaryForSecurityPatchLevel(platform);
         int summaryV = getSummaryForSecurityPatchLevel(vendor);
         Context context = getContext();
-        // TMP: do not enforce vendor check
-        String summary = summaryV == 0 ?
-            context.getString(summaryP) :
-            context.getString(R.string.trust_feature_security_patches_value_base,
+        String summary = context.getString(R.string.trust_feature_security_patches_value_base,
                 context.getString(summaryP), context.getString(summaryV));
 
         mSecurityPatchesPref.setIcon(icon);
@@ -186,6 +168,7 @@ public class TrustPreferences extends SettingsPreferenceFragment {
             case TrustInterface.TRUST_FEATURE_LEVEL_POOR:
                 return R.string.trust_feature_security_patches_value_medium;
             case TrustInterface.TRUST_FEATURE_LEVEL_BAD:
+            case TrustInterface.ERROR_UNDEFINED:
                 return R.string.trust_feature_security_patches_value_old;
             default:
                 return 0;
-- 
2.17.1

