From b6ac2fa8be77919de6303909a3b2262b0f534a34 Mon Sep 17 00:00:00 2001
From: zhuw <zhuw@codeaurora.org>
Date: Wed, 20 Dec 2017 16:31:43 +0800
Subject: [PATCH 20/67] SnapdragonGallery: Fix FC when init() before
 setContentView

don't run init() before setContentView

Change-Id: I98ebd60bc6b3a5e5590b3d35fadfc5cf77f55d94
CRs-Fixed: 2161808
---
 src/com/android/gallery3d/app/GalleryActivity.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/com/android/gallery3d/app/GalleryActivity.java b/src/com/android/gallery3d/app/GalleryActivity.java
index 16920b942..6768967b5 100755
--- a/src/com/android/gallery3d/app/GalleryActivity.java
+++ b/src/com/android/gallery3d/app/GalleryActivity.java
@@ -100,6 +100,7 @@ public final class GalleryActivity extends AbstractGalleryActivity implements On
 
     private static final int PERMISSION_REQUEST_STORAGE = 1;
     private Bundle mSavedInstanceState;
+    private boolean mIsViewInited = false;
 
 
     @Override
@@ -113,6 +114,7 @@ public final class GalleryActivity extends AbstractGalleryActivity implements On
 
         setContentView(R.layout.gallery_main);
         initView();
+        mIsViewInited = true;
 
         mSavedInstanceState = savedInstanceState;
         if (isPermissionGranted()) {
@@ -131,7 +133,9 @@ public final class GalleryActivity extends AbstractGalleryActivity implements On
 
     @Override
     protected void onGetPermissionsSuccess() {
-        init();
+        if (mIsViewInited) {
+            init();
+        }
     }
 
     @Override
-- 
2.17.1

