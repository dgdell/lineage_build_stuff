From 5d48c002c0f1d5dbec7edd3899f176f4c22af493 Mon Sep 17 00:00:00 2001
From: Al Viro <viro@zeniv.linux.org.uk>
Date: Sun, 10 Jun 2012 15:33:51 -0400
Subject: [PATCH 055/132] nfs_lookup_verify_inode() - nd is *always* non-NULL
 here

Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
Change-Id: I71e0cb3723c8c782543d830844a10c962017ec69
---
 fs/nfs/dir.c | 23 ++++++++++-------------
 1 file changed, 10 insertions(+), 13 deletions(-)

diff --git a/fs/nfs/dir.c b/fs/nfs/dir.c
index 4fd6d0433c1..73e78a870e8 100644
--- a/fs/nfs/dir.c
+++ b/fs/nfs/dir.c
@@ -1046,19 +1046,16 @@ int nfs_lookup_verify_inode(struct inode *inode, struct nameidata *nd)
 
 	if (IS_AUTOMOUNT(inode))
 		return 0;
-	if (nd != NULL) {
-		/* VFS wants an on-the-wire revalidation */
-		if (nd->flags & LOOKUP_REVAL)
-			goto out_force;
-		/* This is an open(2) */
-		if (nfs_lookup_check_intent(nd->flags, LOOKUP_OPEN) != 0 &&
-				!(server->flags & NFS_MOUNT_NOCTO) &&
-				(S_ISREG(inode->i_mode) ||
-				 S_ISDIR(inode->i_mode)))
-			goto out_force;
-		return 0;
-	}
-	return nfs_revalidate_inode(server, inode);
+	/* VFS wants an on-the-wire revalidation */
+	if (nd->flags & LOOKUP_REVAL)
+		goto out_force;
+	/* This is an open(2) */
+	if (nfs_lookup_check_intent(nd->flags, LOOKUP_OPEN) != 0 &&
+			!(server->flags & NFS_MOUNT_NOCTO) &&
+			(S_ISREG(inode->i_mode) ||
+			 S_ISDIR(inode->i_mode)))
+		goto out_force;
+	return 0;
 out_force:
 	return __nfs_revalidate_inode(server, inode);
 }
-- 
2.17.1

