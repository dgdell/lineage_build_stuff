From 7c9d6e6550adbc97a5abefc74b947a1541028b58 Mon Sep 17 00:00:00 2001
From: Han Wang <416810799@qq.com>
Date: Sun, 6 Jan 2019 06:53:03 +0100
Subject: [PATCH 30/30] config: Add Deskclock to power whitelist

 * Seems sometimes alarm cannot ring because of doze.

Change-Id: I3a35d2f02de365ea1d3a99ea75e0db9905d482a3
---
 config/common.mk                               |  4 ++++
 config/permissions/lineage-power-whitelist.xml | 15 +++++++++++++++
 2 files changed, 19 insertions(+)
 create mode 100644 config/permissions/lineage-power-whitelist.xml

diff --git a/config/common.mk b/config/common.mk
index 24ca9e38..583797c5 100644
--- a/config/common.mk
+++ b/config/common.mk
@@ -107,6 +107,10 @@ PRODUCT_COPY_FILES += \
 PRODUCT_COPY_FILES += \
     vendor/lineage/config/permissions/lineage-hiddenapi-package-whitelist.xml:system/etc/permissions/lineage-hiddenapi-package-whitelist.xml
 
+# Power whitelist
+PRODUCT_COPY_FILES += \
+    vendor/lineage/config/permissions/lineage-power-whitelist.xml:system/etc/sysconfig/lineage-power-whitelist.xml
+
 # Include Lineage audio files
 include vendor/lineage/config/lineage_audio.mk
 
diff --git a/config/permissions/lineage-power-whitelist.xml b/config/permissions/lineage-power-whitelist.xml
new file mode 100644
index 00000000..86e0c0a4
--- /dev/null
+++ b/config/permissions/lineage-power-whitelist.xml
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2019 The LineageOS Project
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+          http://www.apache.org/licenses/LICENSE-2.0
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<config>
+    <allow-in-power-save package="com.android.deskclock" />
+</config>
-- 
2.17.1

