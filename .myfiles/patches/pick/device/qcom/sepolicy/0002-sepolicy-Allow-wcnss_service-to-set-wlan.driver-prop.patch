From 361e5b6042748f5ec03098244158302f19f4de3a Mon Sep 17 00:00:00 2001
From: Ethan Chen <intervigil@gmail.com>
Date: Mon, 25 Sep 2017 23:19:30 -0700
Subject: [PATCH 02/12] sepolicy: Allow wcnss_service to set wlan.driver
 properties

Change-Id: I83a6ed71a2281c421aba727dca313dda4eb8bd4f
---
 vendor/common/property.te       | 2 ++
 vendor/common/property_contexts | 3 +++
 vendor/common/wcnss_service.te  | 2 ++
 3 files changed, 7 insertions(+)

diff --git a/vendor/common/property.te b/vendor/common/property.te
index c601c363..2fc860ff 100644
--- a/vendor/common/property.te
+++ b/vendor/common/property.te
@@ -196,3 +196,5 @@ type adsprpc_prop, property_type;
 
 #qvr property
 type qvr_prop, property_type;
+
+type wcnss_prop, property_type;
diff --git a/vendor/common/property_contexts b/vendor/common/property_contexts
index 90b0246d..4d6679d6 100644
--- a/vendor/common/property_contexts
+++ b/vendor/common/property_contexts
@@ -258,3 +258,6 @@ vendor.fastrpc.                  u:object_r:adsprpc_prop:s0
 
 #qvr properties
 vendor.qvr                       u:object_r:qvr_prop:s0
+
+wlan.driver.ath            u:object_r:wcnss_prop:s0
+wlan.driver.config         u:object_r:wcnss_prop:s0
diff --git a/vendor/common/wcnss_service.te b/vendor/common/wcnss_service.te
index bade29f4..c203b89e 100644
--- a/vendor/common/wcnss_service.te
+++ b/vendor/common/wcnss_service.te
@@ -73,3 +73,5 @@ r_dir_file(wcnss_service, sysfs_net);
 
 # set property to vendor.wlan is enable
 set_prop(wcnss_service, vendor_wifi_prop)
+
+set_prop(wcnss_service, wcnss_prop)
-- 
2.17.1

