From da0b60d2a86ba719d609f2a84e63885b862d3c67 Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Fri, 16 Nov 2018 07:25:43 -0700
Subject: [PATCH 02/15] msm8974-common: sepolicy: Label sysfs_iio nodes

Change-Id: If9b3e9efe4f7c6eec3faf973e0b7aebd96d76ef3
---
 sepolicy/common/file.te       | 1 +
 sepolicy/common/file_contexts | 4 ++++
 2 files changed, 5 insertions(+)

diff --git a/sepolicy/common/file.te b/sepolicy/common/file.te
index 2e2036d..2fc0794 100644
--- a/sepolicy/common/file.te
+++ b/sepolicy/common/file.te
@@ -2,6 +2,7 @@ type proc_bt_sleep, fs_type;
 
 type sysfs_camera, fs_type, sysfs_type;
 type sysfs_hal_pwr, fs_type, sysfs_type;
+type sysfs_iio, fs_type, sysfs_type;
 type sysfs_mdnie, fs_type, sysfs_type;
 type sysfs_sec, fs_type, sysfs_type;
 type sysfs_wifi_writeable, fs_type, sysfs_type;
diff --git a/sepolicy/common/file_contexts b/sepolicy/common/file_contexts
index 15b85b0..e97c92b 100644
--- a/sepolicy/common/file_contexts
+++ b/sepolicy/common/file_contexts
@@ -43,5 +43,9 @@
 /sys/devices/virtual/graphics/fb[0-9](/.*)?             u:object_r:sysfs_graphics:s0
 /sys/devices/virtual/lcd/panel(/.*)?                    u:object_r:sysfs_graphics:s0
 
+# sysfs - iio
+/sys/bus/iio/devices(/.*)?                                                          u:object_r:sysfs_iio:s0
+/sys/devices/[a-f0-9]+\.spi/spi_master/spi[0-9]+/spi[0-9]+\.0/iio:device[0-9](/.*)? u:object_r:sysfs_iio:s0
+
 # sysfs - mdnie
 /sys/devices/virtual/mdnie/mdnie(/.*)?                  u:object_r:sysfs_mdnie:s0
-- 
2.17.1

