From 91cae6332b48253ac29e0d5e0a2120dfcdcde48f Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Fri, 16 Nov 2018 07:25:43 -0700
Subject: [PATCH 05/11] msm8974-common: sepolicy: Label sysfs_iio nodes

Change-Id: If9b3e9efe4f7c6eec3faf973e0b7aebd96d76ef3
---
 sepolicy/common/file.te       | 1 +
 sepolicy/common/file_contexts | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/sepolicy/common/file.te b/sepolicy/common/file.te
index 2e2036d..80516b2 100644
--- a/sepolicy/common/file.te
+++ b/sepolicy/common/file.te
@@ -3,6 +3,7 @@ type proc_bt_sleep, fs_type;
 type sysfs_camera, fs_type, sysfs_type;
 type sysfs_hal_pwr, fs_type, sysfs_type;
 type sysfs_mdnie, fs_type, sysfs_type;
+type sysfs_iio, fs_type, sysfs_type;
 type sysfs_sec, fs_type, sysfs_type;
 type sysfs_wifi_writeable, fs_type, sysfs_type;
 
diff --git a/sepolicy/common/file_contexts b/sepolicy/common/file_contexts
index a57714d..a0e1816 100644
--- a/sepolicy/common/file_contexts
+++ b/sepolicy/common/file_contexts
@@ -30,9 +30,12 @@
 /data/cam_socket3                                       u:object_r:camera_socket:s0
 
 # sysfs
+/sys/bus/iio(/.*)?                                               u:object_r:sysfs_iio:s0
 /sys/devices/battery.[0-9]+/power_supply/battery(/.*)?           u:object_r:sysfs_batteryinfo:s0
 /sys/module/dhd/parameters/firmware_path                         u:object_r:sysfs_wifi_writeable:s0
 /sys/module/dhd/parameters/nvram_path                            u:object_r:sysfs_wifi_writeable:s0
+/sys/devices/.*/iio:device[0-9]+(/.*)?                           u:object_r:sysfs_iio:s0
+/sys/devices/mdp\.[0-9]+(/.*)?                                   u:object_r:sysfs_graphics:s0
 /sys/devices/platform/bcm[0-9]+_bluetooth/rfkill/rfkill0/state   u:object_r:sysfs_bluetooth_writable:s0
 /sys/devices/virtual/camera(/.*)?                                u:object_r:sysfs_camera:s0
 /sys/devices/virtual/sec/sec_key/hall_irq_ctrl                   u:object_r:sysfs_sec:s0
-- 
2.17.1

