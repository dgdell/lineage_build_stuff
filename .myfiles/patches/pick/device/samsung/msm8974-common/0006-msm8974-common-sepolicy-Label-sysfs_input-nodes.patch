From de64b72031a767ea2272ee1d4b4352be7c31c006 Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Fri, 16 Nov 2018 07:27:03 -0700
Subject: [PATCH 06/11] msm8974-common: sepolicy: Label sysfs_input nodes

Change-Id: Id46a02a44e773b99ff61f9a8ff18394c74c80f90
---
 sepolicy/common/file.te       | 1 +
 sepolicy/common/file_contexts | 4 ++++
 2 files changed, 5 insertions(+)

diff --git a/sepolicy/common/file.te b/sepolicy/common/file.te
index 80516b2..e9ec635 100644
--- a/sepolicy/common/file.te
+++ b/sepolicy/common/file.te
@@ -4,6 +4,7 @@ type sysfs_camera, fs_type, sysfs_type;
 type sysfs_hal_pwr, fs_type, sysfs_type;
 type sysfs_mdnie, fs_type, sysfs_type;
 type sysfs_iio, fs_type, sysfs_type;
+type sysfs_input, fs_type, sysfs_type;
 type sysfs_sec, fs_type, sysfs_type;
 type sysfs_wifi_writeable, fs_type, sysfs_type;
 
diff --git a/sepolicy/common/file_contexts b/sepolicy/common/file_contexts
index a0e1816..da08cb5 100644
--- a/sepolicy/common/file_contexts
+++ b/sepolicy/common/file_contexts
@@ -38,6 +38,10 @@
 /sys/devices/mdp\.[0-9]+(/.*)?                                   u:object_r:sysfs_graphics:s0
 /sys/devices/platform/bcm[0-9]+_bluetooth/rfkill/rfkill0/state   u:object_r:sysfs_bluetooth_writable:s0
 /sys/devices/virtual/camera(/.*)?                                u:object_r:sysfs_camera:s0
+/sys/devices/virtual/graphics(/.*)?                              u:object_r:sysfs_graphics:s0
+/sys/devices/virtual/input(/.*)?                                 u:object_r:sysfs_input:s0
+/sys/devices/virtual/lcd(/.*)?                                   u:object_r:sysfs_graphics:s0
+/sys/devices/virtual/mdnie(/.*)?                                 u:object_r:sysfs_graphics:s0
 /sys/devices/virtual/sec/sec_key/hall_irq_ctrl                   u:object_r:sysfs_sec:s0
 
 # mdnie sysfs
-- 
2.17.1

