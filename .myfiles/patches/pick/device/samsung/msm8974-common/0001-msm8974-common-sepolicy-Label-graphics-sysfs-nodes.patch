From eb480e5da9ad96936b13c6ad30d13cf14c684b08 Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Sun, 21 Oct 2018 08:21:25 -0600
Subject: [PATCH 01/15] msm8974-common: sepolicy: Label graphics sysfs nodes

* Simplify sysfs_mdnie via regex as well

Change-Id: I8597d7be6217816924a8fee854341e4f2fb18562
---
 sepolicy/common/file_contexts | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/sepolicy/common/file_contexts b/sepolicy/common/file_contexts
index b844035..15b85b0 100644
--- a/sepolicy/common/file_contexts
+++ b/sepolicy/common/file_contexts
@@ -37,9 +37,11 @@
 /sys/module/dhd/parameters/firmware_path                         u:object_r:sysfs_wifi_writeable:s0
 /sys/module/dhd/parameters/nvram_path                            u:object_r:sysfs_wifi_writeable:s0
 
-# mdnie sysfs
-/sys/devices/virtual/lcd/panel/panel/auto_brightness    u:object_r:sysfs_mdnie:s0
-/sys/devices/virtual/mdnie/mdnie/accessibility          u:object_r:sysfs_mdnie:s0
-/sys/devices/virtual/mdnie/mdnie/mode                   u:object_r:sysfs_mdnie:s0
-/sys/devices/virtual/mdnie/mdnie/outdoor                u:object_r:sysfs_mdnie:s0
-/sys/devices/virtual/mdnie/mdnie/scenario               u:object_r:sysfs_mdnie:s0
+# sysfs - graphics/panel
+/sys/class/mhl(/.*)?                                    u:object_r:sysfs_graphics:s0
+/sys/devices/mdp\.[0-9](/.*)?                           u:object_r:sysfs_graphics:s0
+/sys/devices/virtual/graphics/fb[0-9](/.*)?             u:object_r:sysfs_graphics:s0
+/sys/devices/virtual/lcd/panel(/.*)?                    u:object_r:sysfs_graphics:s0
+
+# sysfs - mdnie
+/sys/devices/virtual/mdnie/mdnie(/.*)?                  u:object_r:sysfs_mdnie:s0
-- 
2.17.1

