From ff2bbb150f7b8d7fe7b0b18ed057f88bc5e59d3c Mon Sep 17 00:00:00 2001
From: "Kevin F. Haggerty" <haggertk@lineageos.org>
Date: Thu, 15 Nov 2018 19:55:06 -0700
Subject: [PATCH 12/18] msm8974-common: sepolicy: Broaden
 sysfs_bluetooth_writable, resolve denials

Change-Id: Iff3645e36ece2126f3697bb0389394415be16529
---
 sepolicy/common/file_contexts | 2 +-
 sepolicy/common/init.te       | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/sepolicy/common/file_contexts b/sepolicy/common/file_contexts
index 7c4bc58..f2f9bda 100644
--- a/sepolicy/common/file_contexts
+++ b/sepolicy/common/file_contexts
@@ -32,7 +32,7 @@
 
 # sysfs
 /sys/devices/[a-f0-9]+\.uart(/.*)?                               u:object_r:sysfs_msmuart_file:s0
-/sys/devices/platform/bcm[0-9]+_bluetooth/rfkill/rfkill0/state   u:object_r:sysfs_bluetooth_writable:s0
+/sys/devices/platform/bcm[0-9]+_bluetooth/rfkill/rfkill0(/.*)?   u:object_r:sysfs_bluetooth_writable:s0
 /sys/devices/virtual/camera(/.*)?                                u:object_r:sysfs_camera:s0
 /sys/devices/virtual/input(/.*)?                                 u:object_r:sysfs_input:s0
 /sys/module/dhd/parameters/firmware_path                         u:object_r:sysfs_wifi_writeable:s0
diff --git a/sepolicy/common/init.te b/sepolicy/common/init.te
index 71622f5..37b8139 100644
--- a/sepolicy/common/init.te
+++ b/sepolicy/common/init.te
@@ -13,6 +13,7 @@ allow init {
 
 allow init {
     sysfs_batteryinfo
+    sysfs_bluetooth_writable
     sysfs_graphics
     sysfs_iio
     sysfs_input
-- 
2.17.1

