From c457a47d19c95f5e0cb46c24eb4ec8192a70dd72 Mon Sep 17 00:00:00 2001
From: nx111 <NX111.AimH@gmail.com>
Date: Sat, 1 Dec 2018 01:34:57 +0800
Subject: [PATCH 49/49] Revert "Revert isResolvingImsBinding ITelephony
 interface"

This reverts commit 5f05f1e405526208e59bc6cb5f061783855ae505.

Change-Id: I17dcf2ada019e0f3b3da3343fbabe99e6bf09869
---
 .../android/telephony/TelephonyManager.java     | 17 +++++++++++++++++
 .../android/internal/telephony/ITelephony.aidl  |  6 ++++++
 2 files changed, 23 insertions(+)

diff --git a/telephony/java/android/telephony/TelephonyManager.java b/telephony/java/android/telephony/TelephonyManager.java
index 4d4d8b38eb6..51a30cb4141 100644
--- a/telephony/java/android/telephony/TelephonyManager.java
+++ b/telephony/java/android/telephony/TelephonyManager.java
@@ -5455,6 +5455,23 @@ public class TelephonyManager {
         return null;
     }
 
+    /**
+     * @return true if the IMS resolver is busy resolving a binding and should not be considered
+     * available, false if the IMS resolver is idle.
+     * @hide
+     */
+    public boolean isResolvingImsBinding() {
+        try {
+            ITelephony telephony = getITelephony();
+            if (telephony != null) {
+                return telephony.isResolvingImsBinding();
+            }
+        } catch (RemoteException e) {
+            Rlog.e(TAG, "isResolvingImsBinding, RemoteException: " + e.getMessage());
+        }
+        return false;
+    }
+
     /**
      * Set IMS registration state
      *
diff --git a/telephony/java/com/android/internal/telephony/ITelephony.aidl b/telephony/java/com/android/internal/telephony/ITelephony.aidl
index 60422d18440..639dd74e974 100644
--- a/telephony/java/com/android/internal/telephony/ITelephony.aidl
+++ b/telephony/java/com/android/internal/telephony/ITelephony.aidl
@@ -822,6 +822,12 @@ interface ITelephony {
     */
     IImsConfig getImsConfig(int slotId, int feature);
 
+    /**
+     * @return true if the IMS resolver is busy resolving a binding and should not be considered
+     * available, false if the IMS resolver is idle.
+     */
+    boolean isResolvingImsBinding();
+
     /**
     *  @return true if the ImsService to bind to for the slot id specified was set, false otherwise.
     */
-- 
2.17.1

