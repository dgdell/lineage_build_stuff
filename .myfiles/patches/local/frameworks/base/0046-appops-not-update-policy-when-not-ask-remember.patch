From 61aa12d33cf163c18cb1c08867e4b1527165650a Mon Sep 17 00:00:00 2001
From: nx111 <NX111.AimH@gmail.com>
Date: Wed, 19 Dec 2018 14:51:22 +0800
Subject: [PATCH 46/47] appops: not update policy when not ask remember.

Change-Id: I8886741eddf2eaac44a107a0e665df2904895c8e
---
 services/core/java/com/android/server/AppOpsService.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/services/core/java/com/android/server/AppOpsService.java b/services/core/java/com/android/server/AppOpsService.java
index 3bedf799f9d..b7c45a82dc5 100644
--- a/services/core/java/com/android/server/AppOpsService.java
+++ b/services/core/java/com/android/server/AppOpsService.java
@@ -3951,7 +3951,8 @@ public class AppOpsService extends IAppOpsService.Stub {
             if (uidState != null && uidState.pendingAskOp == code) {
                 if (mode == AppOpsManager.MODE_ALLOWED) {
                     uidState.receivedPendingAskResponse = true;
-                    needsPolicyUpdate = true;
+                    if (remember)
+                        needsPolicyUpdate = true;
                 } else {
                     uidState.pendingAskOp = 0;
                     uidState.receivedPendingAskResponse = false;
-- 
2.17.1

